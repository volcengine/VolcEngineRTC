---
is_dir: False    # True for dir; False for doc
status: 1    # 0 for offline; 1 for online; 2 for whitelist; 4 for online but hidden in TOC
keywords: 实时音视频    # use ',' as separator
---

回调通知分为事件发生前和事件发生后两类：
- 事件发生前：该事件由客户端发起请求，IM 服务端将该请求传给业务服务端，业务服务端可在 `Response` 中对客户端发起请求进行修改。
- 事件发生后：该事件已在客户端完成，IM 服务端将该事件通知给业务服务端，业务服务端无法对该事件进行修改。

<strong>注意：</strong>通过服务端openapi发起的请求不会触发 "事件发生前" 回调，仅会触发 "事件发生后" 的回调。

回调通知服务支持的事件有：
- 事件发生前：
  - 消息发送前：[`BeforeSendMessage`](#beforesendmessage)
  - 创建群聊前：[`BeforeCreateConversation`](#beforecreateconversation)
  - 添加群成员前：[`BeforeAddParticipant`](#beforeaddparticipant)
  - 创建单聊前：[`BeforeCreateSingleConversation`](#beforecreatesingleconversation)
  - 移除群聊用户前：[`BeforeRemoveParticipant`](#beforeremoveparticipant)
  - 更新群聊信息前：[`BeforeUpdateConversation`](#beforeupdateconversation)
  - 修改群成员详情前：[`BeforeUpdateParticipant`](#beforeupdateparticipant)
  - 修改用户对群设置前：[`BeforeUpdateSetting`](#beforeupdatesetting)
  - 群聊解散前:[`BeforeDestroyConversation`](#beforedestroyconversation)
- 事件发生后：
  - 群成员离开会话后：[`AfterRemoveParticipant`](#afterremoveparticipant)
  - 群成员加入会话后：[`AfterAddParticipant`](#afteraddparticipant)
  - 直播群群成员在群状态变化：[`ParticipantStateChange`](#participantstatechange)
  - 成员在线状态变化：[`OnlineStateChange`](#onlinestatechange)
  - 创建会话后：[`AfterCreateConversation`](#aftercreateconversation)
  - 消息在线推送后：[`AfterPush`](#afterpush)
  - 消息发送后：[`AfterSendMessage`](#aftersendmessage)
  - 消息属性修改后：[`AfterSetProperty`](#aftersetproperty)
  - 撤回消息后:[`AfterRecallMessage`](#afterrecallmessage)
  - 用户删除自己的消息后:[`AfterDeleteMessage`](#afterdeletemessage)
  - 修改消息后（修改消息的Content和Ext）:[`AfterModifyMessage`](#aftermodifymessage)
  - 群聊解散后:[`AfterDestroyConversation`](#afterdestroyconversation)

## BeforeSendMessage
### EventType
`BeforeSendMessage`
### 事件详情
消息发送前。
该回调支持单聊、普通群和直播群。
### EventData
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| InboxType | Integer | `0` | 信箱，用于逻辑隔离 |
| ClientMessageId | String | `"ClientMessageId"` | 消息客户端Id，如果端上消息发送失败，会进行重试，可通过此字段进行幂等判断 |
| Header | map-key(string)-value(string) | `{"IP":"xxx.xxx.xxx.xxx"}` | 消息发送方的元信息，目前已有的key为：<ul><li>`IP`：消息发送方的ip地址</li> <li>`DevicePlatform`：消息发送方发送时对应设备的平台类型,目前有`web`,`android`,`ios`</li> <li>`OsVersion`：消息发送方发送时对应设备的操作系统</li> <li>`DeviceType`：消息发送方发送时对应设备的类型，如`iPhone12,1`</li></ul>|
| MessageBody | [MessageBody](#messagebody) | / |消息详情 |
| RefMsgInfo | [RefMsgInfo]( #refmsginfo) |/|  引用消息详情|
| ToId |  Long |  `000010` | 消息接收人Id<ul><li>单聊：另一人 UserId</li><li> 群聊：群聊 Id</li><li> 直播群：群聊 Id</li></ul> |

<span id="messagebody"></span>MessageBody

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| Content | String | `Your_Content` | 消息内容 |
| ConversationShortId | Long | `000001` | 会话 ID |
| ConversationType |Integer | `1` | 会话类型<ul><li>`1`：单聊</li><li>`2`：群聊</li><li>`100`：直播群</li></ul>|
| Ext |map-key(string)-value(string) | `{"key":"value"}` | 消息的扩展字段 |
| MsgType |Integer | `10001` | 消息类型<ul><li>`10001`：文本</li><li>`10003`：图片</li><li>`10004`：视频</li><li>`10005`：文件</li><li>`10006`：音频</li><li>`10012`：自定义消息</li></ul> |
| Sender |Long |  `000010` | 消息发送人 UserId |
| MessageId |Long | `000012` | 消息 ID |
| MentionedUsers | Array of Long | `[10001,10002]` | 此条消息at的用户列表 |
| MessagePriority | Integer | `1` | 消息优先级 <ul><li>`0`：低优先级</li><li>`1`：普通优先级</li><li>`2`：高优先级</li></ul> |

<span id="refmsginfo"></span>RefMsgInfo

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| Content |  String | `Your_Content` | 被引用的消息内容 |
| Hint | String | `[图片]`| 消息引用时展示的文本内容 |
| InvisibleUsers | Array of Long  | `[111111]` | 消息不可见群成员列表|
| VisibleUsers | Array of Long  | `[111111]` | 消息可见群成员列表 |
| ReferenceMessageId |Long | `000013` | 消息 ID |
| ReferenceMessageType | Integer | `10001` | 消息类型<ul><li>`10001`：文本</li><li>`10003`：图片</li><li>`10004`：视频</li><li>`10005`：文件</li><li>`10006`：音频</li><li>`10012`：自定义消息</li></ul> |
| Status | Integer | `0` | 消息状态，取值为`0`，表示消息可见 |

### 参数示例
```json
{
  "AppId": 000000, 
  "InboxType": 0, 
  "MessageBody": {
    "Content": "Your_Content",
    "ConversationShortId": 000001, 
    "ConversationType": 2, 
    "Ext": { 
      "key":"value"
    },
    "MsgType": 10001, 
    "Sender": 000010, 
    "MessageId": 000012,
    "MentionedUsers":[],
    "MessagePriority":1
  },
  "RefMsgInfo": { 
    "Content": "Your_Content", 
    "Hint": "[图片]", 
    "InvisibleUsers": [], 
    "VisibleUsers": [], 
    "ReferenceMessageId": 000013, 
    "ReferenceMessageType": 10001, 
    "Status": 0  
  },
  "ToId": 000011,
  "ClientMessageId":"ClientMessageId",
  "Header":{
    "IP":"xxxxx"
  }
}
```
### Response
此条消息最终会以业务服务端传入的`Ext`，`Content`、`InvisibleUsers` 或 `VisibleUsers` 的值为准，如果不想修改用户传入原始的`Content`等字段，这些值传 `null`或者Response的json中不出现此字段。

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示发送消息失败 |
| CheckMessage | String | /| 消息发送失败原因 |
| MessageBody | [MessageBody](#messagebodyres) | / |消息详情 |

MessageBody <span id="messagebodyres"></span>

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| Ext |map-key(string)-value(string) | `{"key":"value"}` | 消息的扩展字段。若 `EvenData` 与 `Response` 均传入该值，若 `key` 值相同，`最终则以Response` 传入为准。若 `key` 值不同，则最终合并展示 |
| Content | String | `Your_Content` | 消息内容 |
| InvisibleUsers | Array of Long |  `[111111]` | 消息不可见群成员列表|
| MentionedUsers | Array of Long |  `[111111,22222]` | 此条消息at的用户列表 |
| MessagePriority | Integer |  `1` | 消息优先级 <ul><li>`0`：低优先级</li><li>`1`：普通优先级</li><li>`2`：高优先级</li></ul> |
### 参数示例
```json
{
    "CheckCode":0, 
    "CheckMessage":"" 
    "MessageBody":{
        "Ext":null, 
        "Content":null,
        "VisibleUsers":null, 
        "InVisibleUsers":null,
        "MentionedUsers":null,
        "MessagePriority":1
    }
}
```

## BeforeCreateConversation
### EventType
`BeforeCreateConversation`
### 事件详情
创建群聊前。
该回调支持普通群和直播群。
### EventData
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| Description | String | `Your_Description` | 群描述 |
| AvatarUrl | String | `http://xxx.com` | 群头像 url |
| Name | String | `Conversation` | 群名 |
| InboxType | Integer | `0` | 信箱，用于逻辑隔离 |
| ParticipantUserIds| Array of Long| `[10001,10002]` | 群成员 ID,直播群会返回群主 ID |
| OwnerUserId | Long | `100001` | 群主 UserId |
| Ext |map-key(string)-value(string) | `{"key":"value"}` | 会话的扩展字段 |

### 参数示例

```json
{
  "AppId": 000000, 
  "Description": "Your_Description", 
  "AvatarUrl": "http://xxx.com", 
  "Name": "Conversation", 
  "InboxType": 0, 
  "ParticipantUserIds": [
    10001,
    10002
  ],
  "OwnerUserId": 10001,
  "Ext": { 
    "key":"value"
	}
}
```

### Response

若想修改 IM 服务端传入的`ValidParticipantUserIds`，`InValidParticipantUserIds`、`Name` 、`AvatarUrl` 、Description 或 `Ext` 的值，可在 Response 中传入，否则这些值均不传或传 `null`。

`InValidParticipantUserIds` 暂时无意义，但建议设置。
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示创建群聊失败 |
| CheckMessage | String | /| 消息发送失败原因 |
| ValidParticipantUserIds | Array of Long|`[10001,10002]`|合法群成员 ID|
| InValidParticipantUserIds | Array of Long|`[10003,10004]`|不合法群成员 ID|
| Name |String | `Conversation` | 群名 |
| AvatarUrl | String | `http://xxx.com` | 群头像 url |
| Description |String | `Your_Description` | 群描述 |
| Ext |map-key(string)-value(string) | `{"key":"value"}` | 会话的扩展字段。若 `EvenData` 与 `Response` 均传入该值，若 `key` 值相同，`最终则以Response` 传入为准。若 `key` 值不同，则最终合并展示 |

### 参数示例
```json
{
    "CheckCode": 0,
    "CheckMessage": "",
    "ValidParticipantUserIds":[10001,10002,10004], 
    "InValidParticipantUserIds":[10003],
    "Name":"Newconversation",
    "AvatarUrl":"http://xxx.xxx.com",
    "Description":"new_Description",
    "Ext": { 
      "key":"value"
    }
}
```

## BeforeAddParticipant
### EventType
`BeforeAddParticipant`
### 事件详情
添加群成员前。
该回调仅支持普通群。
### EventData
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| ConversationShortId | Long | `000001` | 会话 ID |
| InboxType | Integer | `0` | 信箱，用于逻辑隔离 |
| ParticipantUserIds| Array of Long| `[10001,10002]` | 群成员 ID |
| Operator | Long | `100001` | 操作人 UserId |
### 参数示例


```json
{
  "AppId": 000000, 
  "ConversationShortId": 000001, 
  "InboxType": 0, 
  "ParticipantUserIds": [ 
    10009
  ],
  "Operator": 100001 
}
```
### Response

若想修改 IM 服务端传入的`ValidParticipantUserIds` 或 `InValidParticipantUserIds`的值，可在 Response 中传入，否则这些值均不传或传 `null`。


`InValidParticipantUserIds` 暂时无意义，但建议设置。
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示添加群成员失败 |
| CheckMessage | String | /| 操作失败原因 |
| ValidParticipantUserIds | Array of Long|`[10001,10002]`|合法群成员 ID|
| InValidParticipantUserIds | Array of Long|`[10003,10004]`|不合法群成员 ID|

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": "",
    "ValidParticipantUserIds":[10010], 
    "InValidParticipantUserIds":[10003] 
```
## BeforeCreateSingleConversation
### EventType
`BeforeCreateSingleConversation`
### 事件详情
创建单聊前。
该回调仅支持单聊。
### EventData
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| OwnerUserId | Long | `10001` | 发起群聊 UserId |
| InboxType | Integer | `0` | 信箱，用于逻辑隔离 |
| ParticipantUserIds| Array of Long| `[10001,10002]` | 群成员 ID |
| Ext |map-key(string)-value(string) | `{"key":"value"}` | 会话的扩展字段


### 参数示例


```json
{
  "AppId": 000000, 
  "OwnerUserId": 10001, 
  "ParticipantUserIds": [ 
    10001，
    10002
  ]
  "Ext": { 
    "key":"value"
	} 
}
```
### Response

若想修改 IM 服务端传入的`Ext` 的值，可在 Response 中传入，否则这些值均不传或传 `null`。

`InValidParticipantUserIds` 暂时无意义，但建议设置。
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示创建单聊失败 |
| CheckMessage | String | /| 操作失败原因 |
| Ext |map-key(string)-value(string) | `{"key":"value"}` | 会话的扩展字段。若 `EvenData` 与 `Response` 均传入该值，若 `key` 值相同，`最终则以Response` 传入为准。若 `key` 值不同，则最终合并展示 |

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": "",
    "Ext": { 
      "key":"value"
    }
```

## BeforeRemoveParticipant
### EventType
`BeforeRemoveParticipant`
### 事件详情
移除群聊用户前。
该回调仅支持普通群。
### EventData
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| ConversationShortId | Long | `000001` | 会话 ID |
| ParticipantUserIds| Array of Long| `[10002]` | 移除群聊用户 UserId |
| Operator | Long | `100001` | 操作人 UserId |

### 参数示例

```json
{
  "AppId": 000000,
  "ConversationShortId": 000001, 
  "ParticipantIds": [ 
    10002
  ],
  "Operator": 100001 
}
```

### Response

若想修改 IM 服务端传入的`ValidParticipantUserIds` 或 `InValidParticipantUserIds`的值，可在 Response 中传入，否则这些值均不传或传 `null`。
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示移除群聊用户失败 |
| CheckMessage | String | /| 操作失败原因 |
| ValidParticipantUserIds | Array of Long|`[10002]`|移除群聊用户 UserId |
| InValidParticipantUserIds | Array of Long|`[10003,10004]`|不合法群成员 ID。暂时无意义，但推荐设置|

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": "",
    "ValidParticipantUserIds":[10002],
    "InValidParticipantUserIds":[10003]
}
```

## BeforeUpdateConversation
### EventType
`BeforeUpdateConversation`
### 事件详情
更新群聊信息前。
该回调支持单聊、普通群和直播群。
### EventData
> 若某个字段并没有修改，则 `EventData` 中并不会出现该字段。

| 参数名 | 类型 | 示例值 | 描述 |
| --- | --- | --- | --- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| ConversationShortId | Long | `000001` | 会话 ID |
| ConversationType | Integer | `1` | 会话类型<ul><li>`1`：单聊</li><li> `2`：群聊</li><li>`100`：直播群</li></ul>|
| Description | String | `Your_Description` | 群描述 |
| AvatarUrl | String | `http://xxx.com` | 群头像 url |
| Name | String | `Conversation` | 群名 |
| Notice | String | `Your_Notice` | 群公告 |
| Ext | map-key(string)-value(string) | `{"key":"value"}` | 消息的扩展字段 |
| Operator | Long | `100001` | 操作人 UserId |

### 参数示例

```json
{
  "AppId": 000000,
  "ConversationShortId": 000001, 
  "ConversationType": 2,   
  "Description": "000001",
  "AvatarUrl": "http://xxx.com",
  "Name": "Conversation",
  "Notice": "Your_Notice",
	"Ext": { 
	  "key":"value"
	}
  "Operator":100001
}
```


### Response
若想修改 IM 服务端传入的`Name`、`Description`、`AvatarUrl`、`Notice` 或 `Ext`的值，可在 Response 中传入，否则这些值均不传或传 `null`。
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示更新群聊信息失败 |
| CheckMessage | String | /| 操作失败原因 |
| Name | String | `Conversation` | 群名 |
| Description | String | `Your_Description` | 群描述 |
| AvatarUrl | String | `http://xxx.com` | 群头像 url |
| Notice | String | `Your_Notice` | 群公告 |
| Ext | map-key(string)-value(string) | `{"key":"value"}` | 消息的扩展字段。若客户端与服务端均传入该值，若 `key` 值相同，则以服务端为准。若 `key` 值不同，则合并展示|

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": "",
    "Name":"New_Conversation",
    "Description":"New_Description",
    "AvatarUrl":"http://xxx.xxx.com",
    "Notice":"New_Notice",
	  "Ext": { 
	    "key":"value"
		}
}
```

## BeforeUpdateParticipant
### EventType
`BeforeUpdateParticipant`
### 事件详情
修改群成员详情前。
该回调仅支持普通群和直播群。
### EventData

> 若某个字段并没有修改，则 `EventData` 中并不会出现该字段。

| 参数名 | 类型 | 示例值 | 描述 |
| --- | --- | --- | --- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| ConversationShortId | Long | `000001` | 会话 ID |
| ConversationType | Integer | `2` | 会话类型 <ul><li> `2`：群聊</li><li>`100`：直播群</ul> |
| Operator | Long | `100001` | 操作人 UserId |
| UpdateParticipants| Array of [UpdateParticipant](#updateparticipant)|/|群成员修改详情|

UpdateParticipant <span id="updateparticipant"></span>

| 参数名 | 类型 | 示例值 | 描述 |
| --- | --- | --- | --- |
| ParticipantUserId| Long| `10001` | 修改群成员 UserId |
| Role | Integer | `0` | 群成员身份<ul><li>`0`：普通成员</li><li>`1`: 群主</li> <li>`2`：群管理员</li></ul> |
| NickName | String | `Your_NickName` | 群成员昵称|
| AvatarUrl | String | `http://xxx.com` | 群成员头像 url |
| MarkTypes | Array of String | `["mark1","mark2"]` | 群成员标记，仅直播群在线成员返回|



### 参数示例

```json
{
  "AppId": 000000,
  "ConversationShortId": 000001,
  "ConversationType": 2,
  "Operator": 10002, 
  "UpdateParticipants":[{
      "ParticipantUserId":10006,
      "Role": 2, 
      "NickName":"Your_NickName", 
      "AvatarUrl":"http://xxx.com",
      "MarkTypes":["mark1","mark2"] 
  }]
}
```

### Response
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示修改群成员详情失败 |
| CheckMessage | String | /| 操作失败原因 |


### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": ""
}
```


## BeforeUpdateSetting
### EventType
`BeforeUpdateSetting`
### 事件详情
修改用户对群设置前。
该回调支持单聊和普通群。
### EventData
> 若某个字段并没有修改，则 `EventData` 中并不会出现该字段。 

| 参数名 | 类型 | 示例值 | 描述 |
| --- | --- | --- | --- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| ConversationShortId | Long | `000001` | 会话 ID |
| ConversationType | Integer | `1` | 会话类型<ul><li>`1`：单聊</li><li> `2`：群聊</li></ul> |
| IsMute | Bool | `true` |是否免打扰|
| IsSetTop | Bool | `true` |是否置顶|
| IsSetFavorite | Bool | `true` |是否收藏|
| Ext | map-key(string)-value(string) | `{"key":"value"}` | 会话的扩展字段 |
| UserId | Long| `10001` | 修改用户 UserId |


### 参数示例

```json
{
  "AppId": 000000,
  "ConversationShortId": 000001,
  "ConversationType": 2,
  "IsMute": true,
  "IsSetTop":true,
  "IsSetFavorite" : true,
  "Ext": { 
    "key":"value"
	},
  "ParticipantUserId": 10001
}
```

### Response

若想修改 IM 服务端传入的`Ext`的值，可在 Response 中传入，否则这些值均不传或传 `null`。
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示修改用户对群设置失败 |
| CheckMessage | String | /| 操作失败原因 |
| Ext | map-key(string)-value(string) | `{"key":"value"}` | 会话的扩展字段。若 `EvenData` 与 `Response` 均传入该值，若 `key` 值相同，`最终则以Response` 传入为准。若 `key` 值不同，则最终合并展示 |

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": "",
    "Ext": { 
      "key":"value"
    }
}
```

## AfterRemoveParticipant
### EventType
`AfterRemoveParticipant`
### 事件详情
群成员离开会话后，包括主动离开会话和被移除会话。
该回调支持普通群和直播群。
### EventData

| 参数名 | 类型 | 示例值 | 描述 |
| --- | --- | --- | --- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| ConversationShortId | Long | `000001` | 会话 ID |
| ConversationType | Integer | `2` | 会话类型<ul><li> `2`：群聊</li><li>`100`：直播群</ul> |
| InboxType | Integer | `0` | 信箱，用于逻辑隔离 |
| ParticipantUserIds| Array of Long| `[10001]` | 群成员 ID |
| Operator | Long | `100001` | 操作人 UserId |

### 参数示例

```json
{
    "AppId":000000, 
    "ConversationShortId":000001, 
    "ConversationType":100,
    "InboxType":0, 
    "ParticipantUserIds":[ 
        10001
    ],
    "Operator":100001 
}
```
### Response
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示处理失败 |
| CheckMessage | String | /| 错误详细信息 |

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": ""
}
```


## AfterAddParticipant
### EventType
`AfterAddParticipant`
### 事件详情
群成员加入会话后。
该回调支持普通群和直播群。
### EventData

| 参数名 | 类型 | 示例值 | 描述 |
| --- | --- | --- | --- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| ConversationShortId | Long | `000001` | 会话 ID |
| ConversationType | Integer | `2` | 会话类型<ul><li> `2`：群聊</li><li>`100`：直播群</ul> |
| InboxType | Integer | `0` | 信箱，用于逻辑隔离 |
| Operator | Long | `100001` | 操作人 UserId |
| ParticipantUserIds| Array of Long| `[10001]` | 群成员 ID |
| Participants| Array of [Participant](#participant)|/|进群成员详情|

<span id="participant"> Participant 

| 参数名 | 类型 | 示例值 | 描述 |
| --- | --- | --- | --- |
| ParticipantUserId| Long| `10001` | 进群成员 UserId |
| Level | Integer | `0` | 成员等级。直播群不会返回该参数|
| NickName | String | `Your_NickName` | 成员昵称。直播群不会返回该参数 |
| Role| Integer | `0` | 成员身份<ul><li>`0`：普通成员</li><li>`1`: 群主</li> <li>`2`：群管理员 </li><li>`3`：游客（直播群独有）</li></ul> |
| Ext | map-key(string)-value(string) | `{"key":"value"}` | 成员的扩展字段 |
### 参数示例

```json
{
    "AppId":000000, 
    "ConversationShortId":000001, 
    "ConversationType":2,
    "InboxType":0, 
    "Operator":10001, 
    "Participants":[
        {
            "ParticipantUserId":10001, 
            "Level":0, 
            "NickName":"Your_NickName", 
            "Role":1, 
            "Ext":{"key":"value"} 
        }
    ]
}
```

### Response
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示处理失败 |
| CheckMessage | String | /| 错误详细信息 |

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": ""
}
```

## ParticipantStateChange
### EventType
`ParticipantStateChange`
### 事件详情
直播群成员在群状态发生变化。
该回调仅支持直播群。
该回调只会在以下两种情况下触发：
- 用户进入直播群之后，未正常退群，并且网络中断超过 120s。
- 用户进入直播群之后，未正常退群，网络中断超过 120s 后，重新上线。

若同一个登录用户使用多台设备同时加入到同一个直播间时，只有当所有设备同时掉线才会触发掉线事件。当任一设备恢复上线时会触发该回调，后续其他设备登录不会触发该回调。
### EventData

| 参数名 | 类型 | 示例值 | 描述 |
| --- | --- | --- | --- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| ConversationShortId | Long | `000001` | 会话 ID |
| ConversationType | Integer | `100` | 会话类型 `100`：直播群 |
| InboxType | Integer | `0` | 信箱，用于逻辑隔离 |
| ParticipantUserIds| Array of Long| `[10001]` | 群成员 ID |
| StateChangeType| Integer |`1`| 状态更改类型<ul><li> `1`：重新上线</li><li> `2`：掉线</li></ul>|

### 参数示例

```json
{
    "AppId":000000, 
    "ConversationShortId":000001, 
    "ConversationType":100, 
    "InboxType":0, 
    "ParticipantUserIds":[ 
        10003
    ],
    "StateChangeType":2 
}
```

### Response
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示处理失败 |
| CheckMessage | String | /| 错误详细信息 |

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": ""
}
```

## OnlineStateChange
### EventType
`OnlineStateChange`
### 事件详情
用户状态发生变化。
该回调与会话无关，为用户自身在应用中状态。
### EventData

| 参数名 | 类型 | 示例值 | 描述 |
| --- | --- | --- | --- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| Events |Array of [Event](#event)|/| 事件详情 |

<span id="event">Event

| 参数名 | 类型 | 示例值 | 描述 |
| --- | --- | --- | --- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| UserId | Long| `10001` | 用户 UserId |
| EventTime | Long  |`1683357800192`|上下线事件发生的时间戳，单位为毫秒|
| EventType |Integer |`1`| 用户状态：`0`：上线 `1`：下线|
| ConnId | String |`Your_ConnId` |连接的唯一标识 |
| DeviceId | Long |`10002` |设备 ID |
| Header | map-key(string)-value(string) | `{"IP":"xxx.xxx.xxx.xxx"}` | 消息发送方的元信息（通过OpenAPI发送的消息元信息的各字段均为空），目前已有的key为：<ul><li>`IP`：消息发送方的ip地址</li> <li>`DevicePlatform`：消息发送方发送时对应设备的平台类型,目前有`web`,`android`,`iPhone`</li></ul>|
### 参数示例

```json
{
    "AppId":000000,
    "Events":[
        {
            "AppId":000000, 
            "UserId":10001, 
            "EventTime":1683357800192, 
            "EventType":1, 
            "ConnId":"Your_ConnId", 
            "DeviceId":10002,
            "Header":{
              "IP": "180.184.92.210",
              "DevicePlatform": "android"
            }
        }
    ]
}
```

### Response

 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示处理失败 |
| CheckMessage | String | /| 错误详细信息 |

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": ""
}
```

## AfterCreateConversation
### EventType
`AfterCreateConversation`
### 事件详情
会话创建后。
该回调支持单聊、普通群和直播群。
### EventData

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| ConversationShortId | Long | `000001` | 会话 ID |
| ConversationType |Integer | `1` | 会话类型<ul><li>`1`：单聊</li><li>`2`：群聊</li><li>`100`：直播群</li></ul>|
| InboxType | Integer | `0` | 信箱，用于逻辑隔离 |
| Description | String | `Your_Description` | 群描述 |
| AvatarUrl | String | `http://xxx.com` | 群头像 url |
| Name | String | `Conversation` | 群名 |
| CreateTime| Long | `1666598278` |群聊创建时间戳，单位为秒|
| Ext |map-key(string)-value(string) | `{"key":"value"}` | 会话的扩展字段 |
| OwnerUserId | Long | `100001` | 群主 UserId |
| ToUserId| Long| `100002` | <ul><li>单聊时：另一个成员的 UserId</li><li>群聊：会话 ID</li><li>直播群：会话 ID|


### 参数示例

```json
{
    "AppId":000000, 
    "ConversationShortId":000001, 
    "ConversationType":100, 
    "InboxType":0, 
    "Description": "Your_Description", 
    "AvatarUrl": "http://xxx.com", 
    "Name": "Conversation", 
    "CreateTime": 1666598278, 
    "Ext": { 
      "key":"value"
    },
    "OwnerUserId": 10001,
    "ToUserId": 000001
}
```

### Response

 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示处理失败 |
| CheckMessage | String | /| 错误详细信息 |

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": ""
}
```


## AfterPush
### EventType
`AfterPush`
### 事件详情
将客户端发送的消息在线推送后。
该回调支持单聊和普通群。
普通群中，消息在线推送给所有群成员，每个群成员均会触发一次回调。
### EventData

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| ToId | Long | `100002` | 消息接收人UserId |
| InboxType | Integer | `0` | 信箱，用于逻辑隔离 |
| MessageBody | [MessageBody](#messagebody2) | / |消息详情 |
| RefMsgInfo | [RefMsgInfo]( #refmsginfo2) |/|  引用消息详情|
| SuccessPushResult |[SuccessPushResult](#successpushresult)|/| 推送成功平台，仅在推送成功时有值 |
| IsPushSuccess | Bool |`false`|消息推送是否成功<ul><li> `true`：成功</li><li> `false`：失败</li></ul>|
| IsMute | Bool |`false`|接受方是否开启了免打扰<ul><li> `true`：开启</li><li> `false`：关闭</li></ul>|


<span id="messagebody2"></span>MessageBody

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| ConversationType | Integer | `1` | 会话类型<ul><li>`1`：单聊</li><li>`2`：群聊</li></ul>|
| Content | String | `Your_Content` | 消息内容 |
| ConversationShortId | Long | `000001` | 会话 ID |
| MsgType | Integer | `10001` | 消息类型<ul><li>`10001`：文本</li><li>`10003`：图片</li><li>`10004`：视频</li><li>`10005`：文件</li><li>`10006`：音频</li><li>`10012`：自定义消息</li></ul> |
| Sender | Long |  `000010` | 消息发送人 UserId |
| Ext | map-key(string)-value(string) | `{"key":"value"}` | 消息的扩展字段 |
| MessageId | Long | `000012` | 消息 ID |

<span id="refmsginfo2"></span>RefMsgInfo

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| ReferenceMessageId |Long | `000013` | 消息 ID |
| Hint | String | `[图片]`| 消息引用时展示的文本内容 |
| ReferenceMessageType | Integer | `10001` | 消息类型<ul><li>`10001`：文本</li><li>`10003`：图片</li><li>`10004`：视频</li><li>`10005`：文件</li><li>`10006`：音频</li><li>`10012`：自定义消息</li></ul> |
| Status | Integer | `0` | 消息状态。枚举值为 `{0,3,4}`<ul><li>0：消息可见</li><li>3：已撤回</li><li>4：消息不可见（消息已被删除或已过期） |

<span id="successpushresult"></span>SuccessPushResult

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| Platform | String | `Platform_Android` | 消息推送平台<ul><li>`Platform_Android`：Android </li><li>`Platform_IOS`：iOS </li><li>`Platform_Web`： Web</li></ul>|
| ConnId | String | `Your_ConnId` |连接的唯一标识 |


### 参数示例

```json
{
    "AppId":000000, 
    "ToId":100002, 
    "InboxType":0, 
    "MessageBody":{
        "ConversationType":2, 
        "Content":"Your_Content", 
        "ConversationShortId":000001, 
        "MsgType":10001, 
        "Sender":000010, 
        "Ext":{ 
            "key":"value"
        },
        "MessageId":000012
    },
    "RefMsgInfo":{
        "ReferenceMessageId":000013, 
        "Hint":"[图片]", 
        "ReferenceMessageType":10001, 
        "Status":0 
    },
    "SuccessPushResult":[ 
        {
            "Platform":"Platform_IOS",
            "ConnId":"ConnId_1" 
        },
        {
            "Platform":"Platform_Web",
            "ConnId":"ConnId_2"
        }
    ],
    "IsPushSuccess":false, 
    "IsMute":false 
}
```



### Response
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示处理失败 |
| CheckMessage | String | /| 错误详细信息 |

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": ""
}
```


## AfterSendMessage
### EventType
`AfterSendMessage`
### 事件详情
消息发送成功且存入数据库后

该回调支持单聊、普通群和直播群

### EventData

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| FromId | Long | `100002` | 发送方 UserId |
| InboxType | Integer | `0` | 信箱，用于逻辑隔离 |
| MessageBody | [MessageBody](#messagebody3) | / |消息详情 |
| RefMsgInfo | [RefMsgInfo]( #refmsginfo3) |/|  引用消息详情|
| ToId | Long | `000010` | 消息接收人Id<ul><li>单聊：另一个人的 UserId</li><li>普通群：群聊 ID</li><li>直播群：群聊 ID</li></ul> |
| Header | map-key(string)-value(string) | `{"IP":"xxx.xxx.xxx.xxx"}` | 消息发送方的元信息（通过OpenAPI发送的消息元信息的各字段均为空），目前已有的key为：<ul><li>`IP`：消息发送方的ip地址</li> <li>`DevicePlatform`：消息发送方发送时对应设备的平台类型,目前有`web`,`android`,`iPhone`</li> <li>`OsVersion`：消息发送方发送时对应设备的操作系统</li> <li>`DeviceType`：消息发送方发送时对应设备的类型，如`iPhone12,1`</li></ul>|


<span id="messagebody3"></span>MessageBody

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| Content | String | `Your_Content` | 消息内容 |
| ConversationShortId | Long | `000001` | 会话 ID |
| ConversationType | Integer | `1` | 会话类型<ul><li>`1`：单聊</li><li> `2`：群聊</li><li>`100`：直播群</li></ul>|
| Ext | map-key(string)-value(string) | `{"key":"value"}` | 消息的扩展字段 |
| MsgType | Integer | `10001` | 消息类型<ul><li>`10001`：文本</li><li>`10003`：图片</li><li>`10004`：视频</li><li>`10005`：文件</li><li>`10006`：音频</li><li>`10012`：自定义消息</li></ul> |
| Sender | Long |  `000010` | 消息发送人 UserId |
| MessageId | Long | `0000111` | 消息 ID |
| IndexInConversation | Long | `1111111222` | 消息在会话中的位置 |

<span id="refmsginfo3"></span>RefMsgInfo

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| Hint | String | `1`| 消息引用时展示的文本内容 |
| ReferenceMessageId |Long | `0000122` | 引用消息的消息 ID |
| ReferenceMessageType | Integer | `10001` | 引用消息的消息类型<ul><li>`10001`：文本</li><li>`10003`：图片</li><li>`10004`：视频</li><li>`10005`：文件</li><li>`10006`：音频</li><li>`10012`：自定义消息</li></ul> |
| Status | Integer | `0` | 引用消息的消息状态。枚举值为 `{0,3,4}`<ul><li>0：消息可见</li><li>3：已撤回</li><li>4：消息不可见（消息已被删除或已过期） |



### 参数示例

```json
{
  "AppId": 000000, 
  "FromId": 100002, 
  "InboxType": 0, 
  "MessageBody": {
    "Content": "Your_Content",
    "ConversationShortId": 000001, 
    "ConversationType": 1, 
    "Ext": { 
      "key":"value"
    },
    "MsgType": 10001, 
    "Sender": 000010, 
    "MessageId": 0000111, 
    "IndexInConversation": 1111111222 
  },
  "RefMsgInfo": { 
    "Hint": "1", 
    "ReferenceMessageId": 0000122, 
    "ReferenceMessageType": 10001, 
    "Status": 0 
  },
  "ToId": 000010,
  "Header":{
    "IP": "180.184.92.210",
    "DevicePlatform": "android",
    "OsVersion": "10",
    "DeviceType": "ANA-AN00"
  }
}
```



### Response
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示处理失败 |
| CheckMessage | String | /| 错误详细信息 |

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": ""
}
```

## AfterSetProperty
### EventType
`AfterSetProperty`
### 事件详情
消息属性修改后。

该回调支持单聊和群聊。

### EventData

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| InboxType | Integer | `0` | 信箱，用于逻辑隔离 |
| ConversationShortId| Long | `000001` | 会话 ID |
| ConversationType | Integer | `1` | 会话类型<ul><li>`1`：单聊</li><li> `2`：群聊</li></ul>|
| MessageBody | [MessageBody](#messagebody4) | / | 修改后的消息详情|
| ModifyProperties | Array of [ModifyProperty](#modifyproperty)|/ | 本次修改内容详情|
| Operator | Long | `100001` | 操作人 UserId |

<span id="messagebody4"></span>MessageBody

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| ConversationType | Integer | `1` | 会话类型<ul><li>`1`：单聊</li><li> `2`：群聊</li></ul>|
| Content | String | `Your_Content` | 消息内容 |
| ConversationShortId | Long | `000001` | 会话 ID |
| MsgType | Integer | `10001` | 消息类型<ul><li>`10001`：文本</li><li>`10003`：图片</li><li>`10004`：视频</li><li>`10005`：文件</li><li>`10006`：音频</li><li>`10012`：自定义消息</li></ul> |
| Sender | Long |  `000010` | 消息发送人 UserId |
| Ext | map-key(string)-value(string) | `{"key":"value"}` | 消息的扩展字段 |
| MessageId | Long | `0000111` | 消息 ID |
| IndexInConversation | Long | `1111111222` | 消息在会话中的位置 |
| Property | map-key(string)-value([][PropertyItem](#propertyitem))|/|修改后的消息属性|


<span id="propertyitem"></span>

PropertyItem

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| Operator | Long | `100001` | 操作人 UserId |
| CreateTime| Long | `1666598278` |操作时间，单位为秒| 
| IdempotentId |String| `Your_IdempotentId` |PropertyItem 唯一标识|
| Value |String| `Your_Value` | PropertyItem 内容|

<span id="modifyproperty"></span>

ModifyProperty

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| Key | String | `Your_key`   | 修改消息属性对应的 Key 值|
| Op | Integer |  `0`  |消息属性修改操作<ul><li> 0:追加消息属性</li><li> 1:移除消息属性</li><li> 2:覆盖消息属性</li><li> 3:清空消息属性</li> |
| Value |String | `Your_value`  |key 中数组中内其中一项的 value |
| IdempotentId |String| `Your_IdempotentId` |PropertyItem 唯一标识|

### 参数示例

```json
{
    "AppId":000000, 
    "InboxType":0, 
    "ConversationShortId":000001, 
    "ConversationType":2, 
    "MessageBody":{
        "ConversationType":2, 
        "Content":"", 
        "ConversationShortId":000001, 
        "MsgType":10001, 
        "Sender":000010, 
        "Ext":{ 
            "key":"value"
        },
        "MessageId":0000111,
        "IndexInConversation":1111111222,
        "Property":{ 
            "[可爱]":[
                {
                    "Operator":10002, 
                    "CreateTime":1703058396, 
                    "IdempotentId":"[可爱]10002[可爱]",
                    "Value":"[可爱]" 
                }
            ]
        }
    },
    "ModifyProperties":[ 
        {
            "Key":"[可爱]", 
            "Op":0, 
            "Value":"[可爱]", 
            "IdempotentId":"[可爱]10002[可爱]" 
        }
    ],
    "Operator":10002 
}
```



### Response
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示处理失败 |
| CheckMessage | String | /| 错误详细信息 |

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": ""
}
```

## AfterRecallMessage
### EventType
`AfterRecallMessage`
### 事件详情
消息撤回之后。

该回调支持单聊和群聊。
### EventData

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| InboxType | Integer | `0` | 信箱，用于逻辑隔离 |
| Operator| Long | `0` | 触发撤回消息的UserId |
| RecallRole| Integer | `0` | 发起这次撤回的User对应在群中的角色 0:普通成员 1:群主 2:管理员  |
| ConversationType | Integer | `1` | 会话类型<ul><li>`1`：单聊</li><li> `2`：群聊</li></ul>|
| MessageBody | [MessageBody](#messagebody5) | / | 修改后的消息详情|

<span id="messagebody5"></span>MessageBody

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| ConversationType | Integer | `1` | 会话类型<ul><li>`1`：单聊</li><li> `2`：群聊</li></ul>|
| Content | String | `Your_Content` | 消息内容 |
| ConversationShortId | Long | `000001` | 会话 ID |
| MsgType | Integer | `10001` | 消息类型<ul><li>`10001`：文本</li><li>`10003`：图片</li><li>`10004`：视频</li><li>`10005`：文件</li><li>`10006`：音频</li><li>`10012`：自定义消息</li></ul> |
| Sender | Long |  `000010` | 消息发送人 UserId |
| Ext | map-key(string)-value(string) | `{"key":"value"}` | 消息的扩展字段 |
| MessageId | Long | `0000111` | 消息 ID |
| IndexInConversation | Long | `1111111222` | 消息在会话中的位置 |
| Property | map-key(string)-value([][PropertyItem](#propertyitem1))|/|消息属性|


<span id="propertyitem1"></span>

PropertyItem

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| Operator | Long | `100001` | 操作人 UserId |
| CreateTime| Long | `1666598278` |操作时间，单位为秒| 
| IdempotentId |String| `Your_IdempotentId` |PropertyItem 唯一标识|
| Value |String| `Your_Value` | PropertyItem 内容|


### 参数示例

```json
{
	"AppId": 123,
	"Operator": 10001,
	"RecallRole": 0,
	"InboxType": 0,
	"MessageBody": {
		"ConversationType": 2,
		"Content": "", 
		"ConversationShortId": 7241451238695518526,
		"MsgType": 10001,
		"Sender": 10001,
		"Ext": {
			"s:message_priority": "1",
			"s:is_recalled": "true",
			"s:stime": "1711684178787.0586",
			"s:recall_uid": "10001",
			"a:send_os": "web",
			"s:biz_aid": "123",
			"s:client_message_id": "e8d8c062-eb67-4535-86c2-2a148d883567",
			"s:server_message_id": "7351623324038119717",
			"s:server_message_create_time": "1711684196294",
			"s:recall_role": "0"
		},
		"MessageId": 7351623324038119717,
    "Property":{ 
            "[可爱]":[
                {
                    "Operator":10002, 
                    "CreateTime":1703058396, 
                    "IdempotentId":"[可爱]10002[可爱]",
                    "Value":"[可爱]" 
                }
            ]
    },
    "IndexInConversation":"3213213"
	}
}
```
### Response
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示处理失败 |
| CheckMessage | String | /| 错误详细信息 |

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": ""
}
```

## AfterDeleteMessage
### EventType
`AfterDeleteMessage`
### 事件详情
用户删除消息之后。

该回调支持单聊和群聊。
### EventData

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| InboxType | Integer | `0` | 信箱，用于逻辑隔离 |
| Operator| Long | `0` | 触发删除消息的UserId |
| ConversationType | Integer | `1` | 会话类型<ul><li>`1`：单聊</li><li> `2`：群聊</li></ul>|
| MessageBody | [MessageBody](#messagebody6) | / | 修改后的消息详情|

<span id="messagebody6"></span>MessageBody

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| ConversationType | Integer | `1` | 会话类型<ul><li>`1`：单聊</li><li> `2`：群聊</li></ul>|
| Content | String | `Your_Content` | 消息内容 |
| ConversationShortId | Long | `000001` | 会话 ID |
| MsgType | Integer | `10001` | 消息类型<ul><li>`10001`：文本</li><li>`10003`：图片</li><li>`10004`：视频</li><li>`10005`：文件</li><li>`10006`：音频</li><li>`10012`：自定义消息</li></ul> |
| Sender | Long |  `000010` | 消息发送人 UserId |
| Ext | map-key(string)-value(string) | `{"key":"value"}` | 消息的扩展字段 |
| MessageId | Long | `0000111` | 消息 ID |
| IndexInConversation | Long | `1111111222` | 消息在会话中的位置|
| Property | map-key(string)-value([][PropertyItem](#propertyitem2))|/|消息属性|


<span id="propertyitem2"></span>

PropertyItem

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| Operator | Long | `100001` | 操作人 UserId |
| CreateTime| Long | `1666598278` |操作时间，单位为秒| 
| IdempotentId |String| `Your_IdempotentId` |PropertyItem 唯一标识|
| Value |String| `Your_Value` | PropertyItem 内容|



### 参数示例

```json
{
	"AppId": 123,
	"Operator": 10001,
	"InboxType": 0,
	"MessageBody": {
		"ConversationType": 2,
		"Content": "", 
		"ConversationShortId": 7241451238695518526,
		"MsgType": 10001,
		"Sender": 10001,
		"Ext": {
			"s:message_priority": "1",
			"s:is_recalled": "true",
			"s:stime": "1711684178787.0586",
			"s:recall_uid": "10001",
			"a:send_os": "web",
			"s:biz_aid": "123",
			"s:client_message_id": "e8d8c062-eb67-4535-86c2-2a148d883567",
			"s:server_message_id": "7351623324038119717",
			"s:server_message_create_time": "1711684196294",
			"s:recall_role": "0"
		},
		"MessageId": 7351623324038119717,
    "Property":{ 
            "[可爱]":[
                {
                    "Operator":10002, 
                    "CreateTime":1703058396, 
                    "IdempotentId":"[可爱]10002[可爱]",
                    "Value":"[可爱]" 
                }
            ]
    },
    "IndexInConversation":"3213213"
	}
}
```
### Response
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示处理失败 |
| CheckMessage | String | /| 错误详细信息 |

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": ""
}
```

## AfterModifyMessage
### EventType
`AfterModifyMessage`
### 事件详情
修改消息之后（修改Content和Ext）的回调。

该回调支持单聊和群聊。
### EventData

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| InboxType | Integer | `0` | 信箱，用于逻辑隔离 |
| Operator| Long | `0` | 修改消息的UserId |
| ConversationType | Integer | `1` | 会话类型<ul><li>`1`：单聊</li><li> `2`：群聊</li></ul>|
| ModifyExt| map-key(string)-value(string) | `{"test":"test"}` | 本次修改的Ext详情 |
| ModifyContent| String | `""` | 本次修改的Content内容 |
| MessageBody | [MessageBody](#messagebody7) | / | 修改后的消息详情|

<span id="messagebody7"></span>MessageBody

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| ConversationType | Integer | `1` | 会话类型<ul><li>`1`：单聊</li><li> `2`：群聊</li></ul>|
| Content | String | `Your_Content` | 消息内容 |
| ConversationShortId | Long | `000001` | 会话 ID |
| MsgType | Integer | `10001` | 消息类型<ul><li>`10001`：文本</li><li>`10003`：图片</li><li>`10004`：视频</li><li>`10005`：文件</li><li>`10006`：音频</li><li>`10012`：自定义消息</li></ul> |
| Sender | Long |  `000010` | 消息发送人 UserId |
| Ext | map-key(string)-value(string) | `{"key":"value"}` | 消息的扩展字段 |
| MessageId | Long | `0000111` | 消息 ID |
| IndexInConversation | Long | `1111111222` | 消息在会话中的位置 |
| Property | map-key(string)-value([][PropertyItem](#propertyitem3))|/|消息属性|


<span id="propertyitem3"></span>

PropertyItem

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| Operator | Long | `100001` | 操作人 UserId |
| CreateTime| Long | `1666598278` |操作时间，单位为秒| 
| IdempotentId |String| `Your_IdempotentId` |PropertyItem 唯一标识|
| Value |String| `Your_Value` | PropertyItem 内容|


### 参数示例

```json
{
    "AppId": 123,
    "Operator": 10001,
    "InboxType": 0,
    "ModifyContent": "{\"text\":\"修改8\"}",
    "ModifyExt": {
        "s:edit_info": "{\"content_is_edited\":true,\"content_editor\":10001,\"content_edit_time\":1712047315296}",
        "a:test": "测试修改ext2",
        "s:edit_history": "10001:1712044224293:修改5,10001:1712044913843:修改6,10001:1712047315296:修改7",
        "s:edit_count": "7"
    },
    "MessageBody": {
        "ConversationType": 2,
        "Content": "{\"text\":\"修改8\"}",
        "ConversationShortId": 7241451238695518526,
        "MsgType": 10001,
        "Sender": 10001,
        "Ext": {
            "a:send_os": "web",
            "s:message_priority": "1",
            "s:edit_info": "{\"content_is_edited\":true,\"content_editor\":10001,\"content_edit_time\":1712047315296}",
            "": "",
            "a:test": "测试修改ext2",
            "s:stime": "1711978001601.5605",
            "s:server_message_create_time": "1711978001647",
            "s:edit_history": "10001:1712044224293:修改5,10001:1712044913843:修改6,10001:1712047315296:修改7",
            "s:client_message_id": "6bbe2e6b-d097-4015-9c67-ae90f5d3977f",
            "s:edit_count": "7",
            "s:biz_aid": "666675",
            "s:edit_history_len": "27,27,27"
        },
        "MessageId": 7352782532896735526,
        "IndexInConversation": 1711978001655893
    }
}
```
### Response
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Int | `0` | 若非 0，表示处理失败 |
| CheckMessage | String | /| 错误详细信息 |

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": ""
}
```

## BeforeDestroyConversation
### EventType
`BeforeDestroyConversation`
### 事件详情
群聊解散之前的回调

该回调支持群聊。
### EventData

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| ConversationShortId | Long | `000001` | 会话 ID |
| ConversationType |Integer | `1` | 会话类型<ul><li>`1`：单聊</li><li>`2`：群聊</li><li>`100`：直播群</li></ul>|
| InboxType | Integer | `0` | 信箱，用于逻辑隔离 |
| Description | String | `Your_Description` | 群描述 |
| AvatarUrl | String | `http://xxx.com` | 群头像 url |
| Name | String | `Conversation` | 群名 |
| CreateTime| Long | `1666598278` |群聊创建时间戳，单位为秒|
| Ext |map-key(string)-value(string) | `{"key":"value"}` | 会话的扩展字段 |
| OwnerUserId | Long | `100001` | 群主 UserId |
| Operator| Long| `100002` | 群聊解散的操作人|


### 参数示例

```json
{
  "AppId": 123,
  "ConversationShortId": 123,
  "ConversationType": 2,  
  "InboxType":0,
  "Name":"123",
  "AvatarUrl":"https://xxxxx",
  "Notice":"群公告",
  "Description":"群描述",
  "OwnerUserId": 123, 
  "CreateTime":12333333 , 
  "Ext":"群扩展字段",
  "Operator":123
}
```
### Response
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示处理失败（群聊解散失败） |
| CheckMessage | String | /| 错误详细信息 |

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": ""
}
```

## AfterDestroyConversation
### EventType
`AfterDestroyConversation`
### 事件详情
群聊解散之后的回调，仅用于通知。

该回调支持群聊。
### EventData

| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| AppId | Integer | `000000` | 应用的唯一标志 |
| ConversationShortId | Long | `000001` | 会话 ID |
| ConversationType |Integer | `1` | 会话类型<ul><li>`1`：单聊</li><li>`2`：群聊</li><li>`100`：直播群</li></ul>|
| InboxType | Integer | `0` | 信箱，用于逻辑隔离 |
| Description | String | `Your_Description` | 群描述 |
| AvatarUrl | String | `http://xxx.com` | 群头像 url |
| Name | String | `Conversation` | 群名 |
| CreateTime| Long | `1666598278` |群聊创建时间戳，单位为秒|
| Ext |map-key(string)-value(string) | `{"key":"value"}` | 会话的扩展字段 |
| OwnerUserId | Long | `100001` | 群主 UserId |
| Operator| Long| `100002` | 群聊解散的操作人|


### 参数示例

```json
{
  "AppId": 123,
  "ConversationShortId": 123,
  "ConversationType": 2,  
  "InboxType":0,
  "Name":"123",
  "AvatarUrl":"https://xxxxx",
  "Notice":"群公告",
  "Description":"群描述",
  "OwnerUserId": 123, 
  "CreateTime":12333333 , 
  "Ext":"群扩展字段",
  "Operator":123
}
```
### Response
 
| 参数名 |类型  |示例值 |描述  |
| --- | --- | --- |--- |
| CheckCode |  Integer | `0` | 若非 0，表示处理失败（该回调仅用于通知，不会影响群聊解散的结果） |
| CheckMessage | String | /| 错误详细信息 |

### 参数示例

```json
{
    "CheckCode": 0,
    "CheckMessage": ""
}
```
