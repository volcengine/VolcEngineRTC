---
is_dir: False    # True for dir; False for doc
status: 1    # 0 for offline; 1 for online; 2 for whitelist; 4 for online but hidden in TOC
useHub: 1    # 0 by default for using Doc Repo; 1 for using APIHub / SDKHub.
keywords: 实时音视频    # use ',' as separator
---

如果你已启用云端录制，并进行了自定义布局的合流录制，你可以更新录制的配置参数。你可以使用 `UpdateRecord` 这个 OpenAPI 实现这一功能。

关于如何启用云端录制，参看[开始云端录制 StartRecord](69844)。
## 使用说明
### 接口行为

你可以调用 `UpdateRecord` 接口，覆盖此前在 `StartRecord` 或 `UpdateRecord` 中设定的以下参数：

- `TargetStreams`
- `Layout.CustomLayout.Canvas.Background` 和 `Layout.CustomLayout.Canvas.BackgroundImage`
- `Layout.CustomLayout.Regions`

### 前置条件

在开始录制前，你必须已经启用云端录制，并启用了合流录制。参看[开始云端录制 StartRecord](https://www.volcengine.com/docs/6348/69844)。
并且，仅在启动云端录制的配置中 `RecordMode=0` 且 `Layout.LayoutMode=2` 时，才可以调用此接口，即只有合流录制的自定义布局模式下，才可以更新任务参数。


## 注意事项
请求频率：QPS 不得超过 60。
## 请求说明
- 请求方式：**POST**
- 请求地址：**https://rtc.volcengineapi.com?Action=UpdateRecord&Version=2020-12-01**
## 调试

<APILink link="https://api.volcengine.com/api-explorer/debug?action=UpdateRecord&serviceCode=rtc&version=2020-12-01&groupName=云端录制" />

## 请求参数
下表仅列出该接口特有的请求参数和部分公共参数。更多信息请见[公共参数](1178321)。
### Query
```mixin-react
const columns = [
  {
    "title": "参数",
    "dataIndex": "name",
    "width": "15%"
  },
  {
    "title": "类型",
    "dataIndex": "type",
    "width": "15%"
  },
  {
    "title": "是否必选",
    "dataIndex": "required",
    "width": "10%"
  },
  {
    "title": "示例值",
    "dataIndex": "example",
    "width": "20%",
    "render": (val) => <span dangerouslySetInnerHTML={{ __html: val }} />
  },
  {
    "title": "描述",
    "dataIndex": "description",
    "width": "40%",
    "render": (val) => <span dangerouslySetInnerHTML={{ __html: val }} />
  }
];
    
const data = [
  {
    "name": "Action",
    "type": "String",
    "required": "是",
    "example": "<code>UpdateRecord</code>",
    "description": "接口名称。当前 API 的名称为 <code>UpdateRecord</code>。",
    "key": "Action"
  },
  {
    "name": "Version",
    "type": "String",
    "required": "是",
    "example": "<code>2020-12-01</code>",
    "description": "接口版本。当前 API 的版本为 <code>2020-12-01</code>。",
    "key": "Version"
  }
];

return (<Table
  defaultExpandAllRows={true}
  columns={columns}
  data={data}
  border={{ cell: true, wrapper: true }}
  pagination={false}
/>);
```
### Body
```mixin-react
const columns = [
  {
    "title": "参数",
    "dataIndex": "name",
    "width": "25%"
  },
  {
    "title": "类型",
    "dataIndex": "type",
    "width": "10%",
    "render": (val) => <span dangerouslySetInnerHTML={{ __html: val }} />
  },
  {
    "title": "是否必选",
    "dataIndex": "required",
    "width": "10%"
  },
  {
    "title": "示例值",
    "dataIndex": "example",
    "width": "15%",
    "render": (val) => <span dangerouslySetInnerHTML={{ __html: val }} />
  },
  {
    "title": "描述",
    "dataIndex": "title",
    "render": (val) => <span dangerouslySetInnerHTML={{ __html: val }} />
  }
];
    
const data = [
  {
    "name": "AppId",
    "key": "0-0",
    "title": "你的音视频应用的唯一标志",
    "example": "<code>You****pId</code>",
    "required": "是",
    "type": "String"
  },
  {
    "name": "BusinessId",
    "key": "0-1",
    "title": "业务标识",
    "example": "<code>Your_B**inessId</code>",
    "required": "否",
    "type": "String"
  },
  {
    "name": "RoomId",
    "key": "0-2",
    "title": "房间的 ID，是房间的唯一标志",
    "example": "<code>Your_RoomId</code>",
    "required": "是",
    "type": "String"
  },
  {
    "name": "TaskId",
    "key": "0-3",
    "title": "<p>云端录制任务 ID。你必须对每个云端录制任务设定 TaskId，且在进行任务更新时也须使用该 TaskId。</p>\n<p><code>TaskId</code> 是任务的标识，在一个 <code>AppId</code> 的 <code>RoomId</code> 下 <code>taskId</code> 是唯一的，不同 <code>AppId</code> 或者不同 <code>RoomId</code> 下 <code>TaskId</code> 可以重复，因此 <code>AppId</code> + <code>RoomId</code> + <code>TaskId</code> 是任务的唯一标识，可以用来标识指定 <code>AppId</code> 下某个房间内正在运行的任务，从而能在此任务运行中进行更新或者停止此任务。</p>\n关于 TaskId 及以上 Id 字段的命名规则符合正则表达式：<code>[a-zA-Z0-9_@\\-\\.]{1,128}</code>",
    "example": "<code>Your_TaskId</code>",
    "required": "是",
    "type": "String"
  },
  {
    "name": "TargetStreams",
    "key": "0-4",
    "title": "你可以通过本参数设定需要录制的音视频流。单流录制模式下，如果参数为空，默认录制对房间内所有人进行单流录制。最多17人。",
    "example": "<code>-</code>",
    "required": "否",
    "type": "Object",
    "children": [
      {
        "name": "StreamList",
        "key": "0-4-0",
        "title": "由 <code>Stream</code> 组成的列表，可以为空。为空时，表示订阅房间内所有流。在一个 <code>StreamList</code> 中，<code>Stream.Index</code> 不能重复。",
        "example": "<code>-</code>",
        "required": "否",
        "type": "Object[]",
        "children": [
          {
            "name": "Index",
            "key": "0-4-0-0",
            "title": "在自定义布局中，使用 <code>Index</code> 对流进行标志。后续在 <code>Layout.regions.StreamIndex</code> 中，你需要使用 <code>Index</code> 指定对应流的布局设置。",
            "example": "<code>0</code>",
            "required": "否",
            "type": "Integer"
          },
          {
            "name": "UserId",
            "key": "0-4-0-1",
            "title": "用户Id，表示这个流所属的用户。",
            "example": "<code>Your_UserId</code>",
            "required": "是",
            "type": "String"
          },
          {
            "name": "StreamType",
            "key": "0-4-0-2",
            "title": "流的类型，值可以取<code>0</code>或<code>1</code>，默认值为<code>0</code>。<code>0</code>表示普通音视频流，<code>1</code>表示屏幕流。",
            "example": "<code>0</code>",
            "required": "否",
            "type": "Integer"
          }
        ]
      }
    ]
  },
  {
    "name": "Layout",
    "key": "0-5",
    "title": "布局参数。",
    "example": "<code>-</code>",
    "required": "否",
    "type": "Object",
    "children": [
      {
        "name": "LayoutMode",
        "key": "0-5-0",
        "title": "<p>布局模式。默认值为 <code>0</code>，值的范围为 <code>{0, 1, 2, 3}</code>。</p>\n<ul>\n<li><code>0</code> 为自适应布局模式。参看<a href=\"1167930#adapt\">自适应布局</a>。</li>\n<li><code>1</code> 为垂直布局模式。参看<a href=\"1167930#vertical\">垂直布局</a>。</li>\n<li><code>2</code> 为自定义布局模式。</li>\n<li><code>3</code> 为并排布局模式。参看<a href=\"1167930#horizontal\">并排布局</a></li>\n</ul>",
        "example": "<code>0</code>",
        "required": "否",
        "type": "Integer"
      },
      {
        "name": "MainVideoStream",
        "key": "0-5-1",
        "title": "在垂直布局模式下生效，指定主画面流的属性。垂直布局时，<code>MainVideoStream</code> 和 <code>MainVideoStreamIndex</code> 必须填写其中一个。",
        "example": "<code>-</code>",
        "required": "否",
        "type": "Object",
        "children": [
          {
            "name": "Index",
            "key": "0-5-1-0",
            "title": "在自定义布局中，使用 <code>Index</code> 对流进行标志。后续在 <code>Layout.regions.StreamIndex</code> 中，你需要使用 <code>Index</code> 指定对应流的布局设置。",
            "example": "<code>0</code>",
            "required": "否",
            "type": "Integer"
          },
          {
            "name": "UserId",
            "key": "0-5-1-1",
            "title": "用户Id，表示这个流所属的用户。",
            "example": "<code>Your_UserId</code>",
            "required": "是",
            "type": "String"
          },
          {
            "name": "StreamType",
            "key": "0-5-1-2",
            "title": "流的类型，值可以取<code>0</code>或<code>1</code>，默认值为<code>0</code>。<code>0</code>表示普通音视频流，<code>1</code>表示屏幕流。",
            "example": "<code>0</code>",
            "required": "否",
            "type": "Integer"
          }
        ]
      },
      {
        "name": "MainVideoStreamIndex",
        "key": "0-5-2",
        "title": "在垂直布局模式下生效，指定主画面流的属性。如果此参数为空，则主画面为随机的一路流。该参数已废弃，当前版本 <code>MainVideoStreamIndex</code> 依然可用，但我们强烈建议你使用 <code>MainVideoStream</code> 参数。如果你同时指定了 <code>MainVideoStream</code> 和 <code>MainVideoStreamIndex</code> 的值，此时只有 <code>MainVideoStream</code> 生效。",
        "example": "<code>-</code>",
        "required": "否",
        "type": "Integer"
      },
      {
        "name": "CustomLayout",
        "key": "0-5-3",
        "title": "使用自定义布局模式时，使用此参数进行具体设置。",
        "example": "<code>-</code>",
        "required": "否",
        "type": "Object",
        "children": [
          {
            "name": "Canvas",
            "key": "0-5-3-0",
            "title": "整体屏幕（画布）的宽高以及背景色。",
            "example": "<code>-</code>",
            "required": "否",
            "type": "Object",
            "children": [
              {
                "name": "Width",
                "key": "0-5-3-0-0",
                "title": "整体屏幕（画布）的宽度，单位为像素，范围为 <code>[2, 1920]</code>，必须是偶数。默认值为 <code>640</code>。值不合法时，自动调整为默认值。",
                "example": "<code>640</code>",
                "required": "否",
                "type": "Integer"
              },
              {
                "name": "Height",
                "key": "0-5-3-0-1",
                "title": "整体屏幕（画布）的高度，单位为像素，范围为 <code>[2, 1920]</code>，必须是偶数。默认值为 <code>480</code>。值不合法时，自动调整为默认值。",
                "example": "<code>480</code>",
                "required": "否",
                "type": "Integer"
              },
              {
                "name": "Background",
                "key": "0-5-3-0-2",
                "title": "整体屏幕（画布）的背景色，用十六进制颜色码（HEX）表示。例如，<code>#FFFFFF</code> 表示纯白，<code>#000000</code> 表示纯黑。默认值为 <code>#000000</code>。值不合法时，自动调整为默认值。",
                "example": "<code>#000000</code>",
                "required": "否",
                "type": "String"
              },
              {
                "name": "BackgroundImage",
                "key": "0-5-3-0-3",
                "title": "背景图片的 URL。长度最大为 1024 byte。可以传入的图片的格式包括：JPG, JPEG, PNG。如果背景图片的宽高和整体屏幕的宽高不一致，背景图片会缩放到铺满屏幕。<br>\n如果你设置了背景图片，背景图片会覆盖背景色。",
                "example": "<code>无</code>",
                "required": "否",
                "type": "String"
              }
            ]
          },
          {
            "name": "Regions",
            "key": "0-5-3-1",
            "title": "<p>在自定义布局模式下，你可以使用 <code>Regions</code> 对每一路视频流进行画面布局设置。其中，每个 <code>Region</code> 对一路视频流进行画面布局设置。<br>\n自定义布局模式下，对于 <code>StreamList</code> 中的每个 <code>Stream</code>，<code>Regions</code> 中都需要给出对应的布局信息，否则会返回请求不合法的错误。即 <code>Regions.Region.StreamIndex</code> 要与 <code>TargetStreams.StreamList.Stream.Index</code> 的值一一对应，否则自定义布局设置失败，返回 <code>InvalidParameter</code> 错误码。</p>\n<blockquote>\n<p>当传入的必填参数值不合法时，返回错误码 InvalidParameter 。<br>\n当传入的选填参数值不合法时，自动调整为默认值。</p>\n</blockquote>",
            "example": "<code>-</code>",
            "required": "否",
            "type": "Object[]",
            "children": [
              {
                "name": "StreamIndex",
                "key": "0-5-3-1-0",
                "title": "流的标识。这个标志应和 <code>TargetStreams.StreamList.Stream.Index</code> 对应。",
                "example": "<code>0</code>",
                "required": "是",
                "type": "Integer"
              },
              {
                "name": "LocationX",
                "key": "0-5-3-1-1",
                "title": "<p>视频流对应区域左上角的横坐标相对整体画面的比例，取值的范围为 <code>[0.0, Canvas.Width)</code>。默认值为 <code>0</code>。若传入该参数，服务端会对该参数进行校验，若不合法会返回错误码 <code>InvalidParameter</code>。</p>\n视频流对应区域左上角的实际坐标是通过画面尺寸和相对位置比例相乘，并四舍五入取整得到的。假如，画布尺寸为<code>1920</code>, 视频流对应区域左上角的横坐标相对整体画面的比例为 <code>0.33</code>，那么该画布左上角的横坐标为 <code>634</code>（1920*0.33=633.6，四舍五入取整）。",
                "example": "<code>0</code>",
                "required": "否",
                "type": "Float"
              },
              {
                "name": "LocationY",
                "key": "0-5-3-1-2",
                "title": "视频流对应区域左上角的横坐标相对整体画面左上角原点的纵向位移，取值的范围为 <code>[0.0, Canvas.Height)</code>。默认值为 <code>0</code>。若传入该参数，服务端会对该参数进行校验，若不合法会返回错误码 <code>InvalidParameter</code>。",
                "example": "<code>0</code>",
                "required": "否",
                "type": "Float"
              },
              {
                "name": "WidthProportion",
                "key": "0-5-3-1-3",
                "title": "视频流对应区域宽度相对整体画面的比例，取值的范围为 <code>(0.0, 1.0]</code>。",
                "example": "<code>0.5</code>",
                "required": "是",
                "type": "Float"
              },
              {
                "name": "HeightProportion",
                "key": "0-5-3-1-4",
                "title": "视频流对应区域高度相对整体画面的比例，取值的范围为 <code>(0.0, 1.0]</code>。",
                "example": "<code>0.5</code>",
                "required": "是",
                "type": "Float"
              },
              {
                "name": "ZOrder",
                "key": "0-5-3-1-5",
                "title": "当多个流的画面有重叠时，使用此参数设置指定画面的图层顺序。取值范围为 <code>[0, 100]</code>：<code>0</code> 表示该区域图像位于最下层，<code>100</code> 表示该区域图像位于最上层, 默认值为 <code>0</code>。值不合法时，自动调整为默认值。",
                "example": "<code>0</code>",
                "required": "否",
                "type": "Integer"
              },
              {
                "name": "Alpha",
                "key": "0-5-3-1-6",
                "title": "画面的透明度，取值范围为 <code>(0.0, 1.0]</code>。<code>0.0</code> 表示完全透明，<code>1.0</code> 表示完全不透明，默认值为 <code>1.0</code>。值不合法时，自动调整为默认值。",
                "example": "<code>1</code>",
                "required": "否",
                "type": "Float"
              },
              {
                "name": "RenderMode",
                "key": "0-5-3-1-7",
                "title": "<p>画面的渲染模式，值的范围为 <code>{0, 1, 2，3}</code>, 默认值为 <code>0</code>：</p>\n<ul>\n<li><code>0</code> 表示按照指定的宽高直接缩放。如果原始画面宽高比与指定的宽高比不同，就会导致画面变形</li>\n<li><code>1</code> 表示按照显示区域的长宽比裁减视频，然后等比拉伸或缩小视频，占满显示区域。</li>\n<li><code>2</code> 表示按照原始画面的宽高比缩放视频，在显示区域居中显示。如果原始画面宽高比与指定的宽高比不同，就会导致画面有空缺，空缺区域为填充的背景色值。</li>\n<li><code>3</code> 表示按照指定的宽高直接缩放。如果原始画面宽高比与指定的宽高比不同，就会导致画面变形</li>\n</ul>\n值不合法时，自动调整为默认值。<br><br>\n目前 <code>0</code> 和 <code>3</code> 均为按照指定的宽高直接缩放，但我们推荐你使用 <code>3</code> 以便与客户端实现相同逻辑。<br><br>\n不同渲染模式下，效果如下：<img src=\"https://portal.volccdn.com/obj/volcfe/cloud-universal-doc/upload_5e4ddbcdbefe2a108f6f9810bfa0b030.png\" alt=\"alt\" width=\"100%\">",
                "example": "<code>0</code>",
                "required": "否",
                "type": "Integer"
              },
              {
                "name": "SourceCrop",
                "key": "0-5-3-1-8",
                "title": "源流剪切功能，可以在源视频帧渲染之前进行裁剪，即预处理一次再渲染。转推直播和云端录制下， <code>SourceCrop</code> 对 <code>AlternateImage</code> 也生效。",
                "example": "<code>-</code>",
                "required": "否",
                "type": "Object",
                "children": [
                  {
                    "name": "LocationX",
                    "key": "0-5-3-1-8-0",
                    "title": "裁剪后得到的视频帧左上角的横坐标相对裁剪前整体画面的比例，取值的范围为 <code>[0.0, 1.0)</code>。默认值为 <code>0.0</code>。值不合法时，自动调整为默认值。",
                    "example": "<code>0</code>",
                    "required": "否",
                    "type": "Float"
                  },
                  {
                    "name": "LocationY",
                    "key": "0-5-3-1-8-1",
                    "title": "裁剪后得到的视频帧左上角的纵坐标相对裁剪前整体画面的比例，取值的范围为 <code>[0.0, 1.0)</code>。默认值为 <code>0.0</code>。值不合法时，自动调整为默认值。",
                    "example": "<code>0</code>",
                    "required": "否",
                    "type": "Float"
                  },
                  {
                    "name": "WidthProportion",
                    "key": "0-5-3-1-8-2",
                    "title": "裁剪后得到的视频帧宽度相对裁剪前整体画面宽度的比例，取值范围为 <code>(0.0, 1.0]</code>。默认值为 <code>1.0</code>。值不合法时，自动调整为默认值。",
                    "example": "<code>0.5</code>",
                    "required": "否",
                    "type": "Float"
                  },
                  {
                    "name": "HeightProportion",
                    "key": "0-5-3-1-8-3",
                    "title": "裁剪后得到的视频帧高度相对裁剪前整体画面宽度的比例，取值范围为 <code>(0.0, 1.0]</code>。默认值为 <code>1.0</code>。值不合法时，自动调整为默认值。",
                    "example": "<code>0.5</code>",
                    "required": "否",
                    "type": "Float"
                  }
                ]
              },
              {
                "name": "AlternateImage",
                "key": "0-5-3-1-9",
                "title": "<p>补位图片的 url。长度不超过 1024 个字符串。</p>\n<ul>\n<li>在 <code>Region.StreamIndex</code> 对应的视频流没有发布，或被暂停采集时，<code>AlternateImage</code> 对应的图片会填充 <code>Region</code> 对应的画布空间。当视频流被采集并发布时，<code>AlternateImage</code> 不造成任何影响。</li>\n<li>可以传入的图片的格式包括：JPG, JPEG, PNG。</li>\n<li>当图片和画布尺寸不一致时，图片根据 <code>RenderMode</code> 的设置，在画布中进行渲染。</li>\n</ul>",
                "example": "<code>-</code>",
                "required": "否",
                "type": "String"
              },
              {
                "name": "ApplySpatialAudio",
                "key": "0-5-3-1-10",
                "title": "<p>该路流对应的用户是否开启空间音频效果。</p>\n<ul>\n<li><code>true</code>：开启空间音频效果。</li>\n<li><code>false</code>：关闭空间音频效果。</li>\n</ul>\n默认值为 <code>true</code>",
                "example": "<code>-</code>",
                "required": "否",
                "type": "Boolean"
              },
              {
                "name": "SpatialPosition",
                "key": "0-5-3-1-11",
                "title": "空间音频下，房间内指定用户所在位置的三维坐标，默认值为<code>[0,0,0]</code>。数组长度为<code>3</code>，三个值依次对应<code>X</code>,<code>Y</code>,<code>Z</code>，每个值的取值范围为<code>[-100,100]</code>。",
                "example": "<code>[0,0,0]</code>",
                "required": "否",
                "type": "Integer[]",
                "children": []
              },
              {
                "name": "CornerRadius",
                "key": "0-5-3-1-12",
                "title": "转推直播下边框圆角半径与画布宽度的比例值，取值范围为 <code>(0,1]</code>。圆角半径的像素位不能超过 Region 宽高最小值的一半，否则不会出现圆角效果。",
                "example": "<code>0.1</code>",
                "required": "否",
                "type": "Float"
              },
              {
                "name": "MediaType",
                "key": "0-5-3-1-13",
                "title": "<p>该路流参与混流的媒体类型。</p>\n<ul>\n<li><code>0</code>：音视频</li>\n<li><code>1</code>：纯音频</li>\n<li><code>2</code>：纯视频</li>\n</ul>\n默认值为 <code>0</code>。值不合法时，自动调整为默认值。<br><br>\n假如该路流为音视频流，<code>MediaType</code>设为<code>1</code>，则只混入音频内容。",
                "example": "<code>0</code>",
                "required": "否",
                "type": "Integer"
              },
              {
                "name": "AlternateImageFillMode",
                "key": "0-5-3-1-14",
                "title": "<p>画面的渲染模式。</p>\n<ul>\n<li><code>0</code>：按照用户原始视频帧比例进行缩放</li>\n<li><code>1</code>：保持图片原有比例</li>\n</ul>\n默认值为 <code>0</code>。值不合法时，自动调整为默认值。",
                "example": "<code>0</code>",
                "required": "否",
                "type": "Integer"
              }
            ]
          }
        ]
      }
    ]
  }
];

return (<Table
  defaultExpandAllRows={true}
  columns={columns}
  data={data}
  border={{ cell: true, wrapper: true }}
  pagination={false}
/>);
```
## 返回参数
本接口无特有的返回参数。公共返回参数请见[返回结构](1178322)。
其中返回值 `Result` 仅在请求成功时返回 `ok`,失败时为空。
## 请求示例
```json
POST https://rtc.volcengineapi.com?Action=UpdateRecord&Version=2020-12-01
{
    "AppId": "You****pId",
    "BusinessId": "Your_B**inessId",
    "RoomId": "Your_RoomId",
    "TaskId": "Your_TaskId",
    "TargetStreams": {
        "StreamList": [
            {
                "Index": 0,
                "UserId": "Your_UserId_1",
                "StreamType": 1
            },
            {
                "Index": 1,
                "UserId": "Your_UserId_2"
            }
        ]
    },
    "Layout": {
        "LayoutMode": 2,
        "CustomLayout": {
            "Canvas": {
                "Width": 860,
                "Height": 340,
                "Background": "#303342"
            },
            "Regions": [
                {
                    "StreamIndex": 0,
                    "LocationX": 0,
                    "LocationY": 0,
                    "WidthProportion": 0.5,
                    "HeightProportion": 1,
                    "ZOrder": 0,
                    "Alpha": 1,
                    "RenderMode": 0
                },
                {
                    "StreamIndex": 1,
                    "LocationX": 0.5,
                    "LocationY": 0,
                    "WidthProportion": 0.5,
                    "HeightProportion": 1,
                    "ZOrder": 1,
                    "Alpha": 1,
                    "RenderMode": 1
                }
            ]
        }
    }
}
```
## 返回示例
```json
{
    "Result": "ok",
    "ResponseMetadata": {
        "RequestId": "Your_****estId",
        "Action": "UpdateRecord",
        "Version": "2020-12-01",
        "Service": "rtc",
        "Region": "cn-north-1"
    }
}
```

## 错误码
您可访问[公共错误码](https://www.volcengine.com/docs/6348/70426)，获取更多错误码信息。
<div data-source="api-doc-hub" style="display: none"></div>
