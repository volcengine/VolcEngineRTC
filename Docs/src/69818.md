在教育、互娱、医疗、金融等领域中，你可能需要对某个音视频房间内的音频、视频进行录音或录像，你可以使用云端录制功能，将生成的文件存储在[火山引擎视频点播](https://www.volcengine.com/product/vod)、[火山引擎对象存储TOS](https://www.volcengine.com/product/tos) 或支持 S3 协议的第三方存储平台。

在使用云端录制功能前，你必须在[RTC 控制台](https://console.volcengine.com/rtc/cloudRTC)开启云端录制功能，并在调用接口时指定你需要存储的存储平台中。


## 适用场景

你可能在多种行业的多种场景下使用到云端录制功能：

|  **行业**  |  **场景**  |
| --- | --- |
| 在线教育 | 一对一、小班课、大班课等场景下，录制课程回看、课堂精彩片段。 |
| 社交直播 | 直播回放、内容审核。 |
| 客服中心 | 录制服务记录，用于客服质量评估、后期用户调研。 |
| 金融行业 | 办理视频面签，远程见证等业务时，存档备查。 |
| 远程医疗 | 进行远程问诊、在线咨询时，录制咨询过程，方便复诊参考。 |


## 功能说明
### 录制模式
支持单流录制和合流录制：
	
- 单流录制：针对房间内每个单独用户的音视频内容进行录制，即每个用户生成一个独立的音视频录制文件。录制过程中，可能会出现分辨率的变化，如进行屏幕共享，最后输出文件分辨率为录制过程中最大分辨率。小分辨率视频会按原始画面的高宽比缩放视频，在显示区域居中显示，空缺区域填充背景色。
- 合流录制：针对房间内所有或者指定用户的音视频内容进行混合录制，生成一个音视频录制文件。

### 存储位置

#### [2020-12-01](69844)
使用 OpenAPI 2020-12-01 版本时，你可以将录制结果存储到[火山引擎视频点播 VOD](https://www.volcengine.com/product/vod)平台。
> 点播平台播放地址有生效时间限制，默认为 60 分钟，详情请参看[时间戳防盗链](https://www.volcengine.com/docs/4/24#%E9%85%8D%E7%BD%AE%E6%97%B6%E9%97%B4%E6%88%B3%E9%98%B2%E7%9B%97%E9%93%BE)

#### [2022-06-01](115526)
使用 OpenAPI 2022-06-01 版本时，你可以将录制结果存储在多种存储平台中。目前支持的存储平台包括：[火山引擎视频点播 VOD](https://www.volcengine.com/product/vod)、[火山引擎对象存储 TOS](https://www.volcengine.com/product/tos)、[Amazon S3](https://docs.aws.amazon.com/zh_cn/general/latest/gr/Welcome.html)、[阿里云对象存储 OSS](https://help.aliyun.com/document_detail/2391478.html?spm=a2c4g.31837.0.0.5bb82245uuajtV)、[华为云 OBS](https://www.huaweicloud.com/product/obs.html)、[腾讯云 COS](https://cloud.tencent.com/document/product/436/6222)、[七牛云 Kodo](https://developer.qiniu.com/kodo/1277/product-introduction)。

### 设置音视频属性

- 在合流录制模式下，你可以设置录制文件的视频属性，包括分辨率和帧率等。
- 在单流录制模式下，录制文件的视频属性沿用房间内的视频发布参数。

### 设置合流布局
在合流录制模式下，你可以设置合流布局，及屏幕（画布）的背景颜色。

### 设置空闲超时

请结合你的实际业务需求合理设置空闲超时时间。在空闲超时范围内，即使录制异常中断，录制仍会持续进行，并产生计费。

> 录制时默认设置空闲超时为 180s，可以自定义配置。

<span id="rule"></span>
 ### 录制切片规则

每当录制时长超过 4 小时左右时，便会创建一个新的录制文件。多个录制文件会按照序号进行排列。
若生成多个录制文件，且你已配置云端录制相关回调事件，你可以在 `RecordStopped.RecordFileList` 回调中查看所有录制文件的相关信息。

单流录制下，若视频流中断：

- 中断一小时内，录制服务会补充相应时长的黑帧存储到文件中。
- 中断一小时以上，录制服务不会补黑帧，会将中断前的内容生成录制文件。在视频流恢复后，会创建一个新的录制文件。
## 录制管理

### 录制事件通知
你可以开通消息通知服务，获得录制开始、结束和录制上传状态的通知。要开通此服务，参看[开通消息通知服务](75110)。
 
在你开启了通知服务，并在[RTC 控制台](https://console.volcengine.com/rtc/cloudRTC)添加了**录制开始与结束** 和 **录制上传状态**事件，配置了回调地址，在录制开始、结束和任务上传状态发生变化时，你会收到 RTC 推送的关于录制文件的消息。

你可以根据成功上传的回调来获取文件在火山引擎视频点播平台的 Vid 或在TOS/第三方存储平台的完整路径，关于回调的详细示例可参看[RecordStopped](https://www.volcengine.com/docs/6348/75125#recordstopped-2020-12-01)。
录制上传状态
### 查找处理录制文件
若你选择在火山引擎视频点播平台存储文件，你可以按以下步骤进行查找、处理录制文件：

关于查找点播录制文件，可参看[查找录制文件](https://www.volcengine.com/docs/4/181541#%E6%9F%A5%E6%89%BE%E5%BD%95%E5%88%B6%E6%96%87%E4%BB%B6)。

关于处理点播录制文件，可参看[处理录制文件](https://www.volcengine.com/docs/4/181541#%E5%A4%84%E7%90%86%E5%BD%95%E5%88%B6%E6%96%87%E4%BB%B6)。

### 自动录制

在启动录制后，你可以选择添加自动录制功能，对房间内的用户进行自动录制。关于自动录制，详情参看[自动录制](73625)

>- 若设置了业务标识，在自动录制功能开启，满足配置条件的用户进入房间，发送音视频时，录制会自动开启，对该用户进行单流录制。若房间内有多个满足配置条件的用户发送音视频，会分别触发自动录制任务，进行单流录制。录制生成的文件会存储到[视频点播控制台](https://console.volcengine.com/home)左侧导航栏**媒资管理**>**视频管理**中。
>- 若未设置业务标识，在自动录制功能开启后，默认对房间内所有发送的音视频的用户进行单流录制。录制生成的文件会存储到[视频点播控制台](https://console.volcengine.com/home)左侧导航栏**媒资管理**>**视频管理**中。

## 操作流程
你必须按照以下步骤进行录制：

1. 在控制台上开通录制服务，参看[在控制台开启/关闭云端录制功能](69819)。
2. （可选）获取录制相关任务状态的消息通知，参看[开通消息通知服务](75110)。
3. （可选）在控制台上添加自动录制，参看[自动录制](73625)。
4. 开始录制任务，参看[开始云端录制](69844)。
5. 更新录制配置，参看[更新云端录制](69845)。
6. 结束录制任务，参看[结束云端录制](69846)。

## 常见问题
Q：为什么自适应布局下，屏幕流录制效果不够清晰？
A：自适应布局下，服务端默认不会设置超高码率。如果订阅屏幕流，为保证清晰度，建议自行设置高码率。不同场景下设置码率等视频发布参数,请参考[设置视频发布参数](70122.md#videoprofiles)。