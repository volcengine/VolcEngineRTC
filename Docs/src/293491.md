## BytedIM <span id="bytedim"></span>

类型: `class`

IM 类，所有 API 交互都通过该类的实例来操作，实例化支持的参数参见 [IMOption](293494.md#imoption)。

- **API**

| 方法 | 描述 |
| :-- | :-- |
| [init](#bytedim-init) | 初始化 SDK。<br>初始化时会完成与服务端的消息游标同步和历史信息同步。 |
| [getMessagesByUser](#bytedim-getmessagesbyuser) | 拉取用户混链消息。<br>通常无需业务调用，SDK 内部会轮询。 |
| [createCustomMessage](#bytedim-createcustommessage) | 创建自定义消息。 |
| [createTextMessage](#bytedim-createtextmessage) | 创建文本消息。 |
| [sendMessage](#bytedim-sendmessage) | 发送消息。 |
| [deleteMessage](#bytedim-deletemessage) | 删除消息。 |
| [recallMessage](#bytedim-recallmessage) | 删除消息。 |
| [getMessageByServerId](#bytedim-getmessagebyserverid) | 获取消息的实时信息。 |
| [getMessageReferenceList](#bytedim-getmessagereferencelist) | 获取引用消息链。<br>若消息 B 引用了消息 A，消息 C 引用了消息 B，那么 A -> B -> C 就是一条引用消息链。通过 A、B、C 任意一条消息都可以获取这条消息链。 |
| [modifyMessageProperty](#bytedim-modifymessageproperty) | 设置消息属性。<br>常见使用场景：给某条消息点赞、加急等。 |
| [getConversation](#bytedim-getconversation) | 获取指定单个本地会话。 |
| [getConversationOnline](#bytedim-getconversationonline) | 请求服务端更新本地会话后，获取指定单个会话。 |
| [getConversationList](#bytedim-getconversationlist) | 获取本地会话列表。 |
| [getConversationListOnline](#bytedim-getconversationlistonline) | 请求服务端更新本地会话后，获取会话列表。直播群列表请使用 [getLiveConversationListOnline](#getliveconversationlistonline)。 |
| [getMessagesByConversation](#bytedim-getmessagesbyconversation) | 请求服务器获取会话内的消息列表。（直播群不可用） |
| [getUserConversationList](#bytedim-getuserconversationlist) | 请求服务器获取用户的会话列表。 |
| [createConversation](#bytedim-createconversation) | 创建群聊。 |
| [leaveConversation](#bytedim-leaveconversation) | 离开群组。 |
| [deleteConversation](#bytedim-deleteconversation) | 删除会话。 |
| [dissolveConversation](#bytedim-dissolveconversation) | 解散群聊。 |
| [setConversationSettingInfo](#bytedim-setconversationsettinginfo) | 设置会话附加信息，如置顶、免打扰、收藏等。 |
| [setConversationWeakMuteConfig](#bytedim-setconversationweakmuteconfig) | 配置会话低打扰模式。 |
| [upsertConversationSettingExtInfo](#bytedim-upsertconversationsettingextinfo) | 更新 Setting ext 拓展信息。 |
| [setConversationCoreInfo](#bytedim-setconversationcoreinfo) | 设置群聊信息。 |
| [upsertConversationCoreExtInfo](#bytedim-upsertconversationcoreextinfo) | 更新 Core ext 拓展信息。 |
| [getConversationListByTop](#bytedim-getconversationlistbytop) | 获取顶置会话。 |
| [getConversationListByFavorite](#bytedim-getconversationlistbyfavorite) | 获取收藏会话。 |
| [markConversationRead](#bytedim-markconversationread) | 标记会话已读。 |
| [addParticipants](#bytedim-addparticipants) | 添加群成员。 |
| [removeParticipants](#bytedim-removeparticipants) | 移除群成员/离开直播群/移除直播群成员，v1.1.0 新增直播群功能。 |
| [updateParticipant](#bytedim-updateparticipant) | 更新群成员信息。 |
| [getParticipants](#bytedim-getparticipants) | 获取 SDK 本地维护的群成员列表。 |
| [getParticipantsOnline](#bytedim-getparticipantsonline) | 获取群成员列表。<br>此方法会在 SDK 内部循环调用分页接口，直至没有更多数据，然后把所有群成员数据一次返回。当群成员较多时，此方法耗时较久。 |
| [setConversationMute](#bytedim-setconversationmute) | 设置群禁言（会话维度）。 |
| [setParticipantMuteTime](#bytedim-setparticipantmutetime) | 设置群禁言（成员维度）。 |
| [dispose](#bytedim-dispose) | 手动卸载 SDK。 |


### init <span id="bytedim-init"></span> 

初始化 SDK。
初始化时会完成与服务端的消息游标同步和历史信息同步。

- **类型**

  ```ts
  (params?: { convLimit?: number; msgLimit?: number; convTotal?: number;}) => Promise<InitResult>
  ```

- **注意**

  可设置 [IMOption.disableInitPull](293494.md#imoption-disableinitpull) 关闭历史信息同步。

- **参数**

  - **params**

    类型: <code>{ convLimit?: number | undefined; msgLimit?: number | undefined; convTotal?: number | undefined; } | undefined</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | convLimit | `number | undefined` | 每次调用初始化拉取接口时，会话数量限制。 |
      | msgLimit | `number | undefined` | 每次调用初始化拉取接口时，每个对话返回的消息数量限制。 |
      | convTotal | `number | undefined` | 初始化拉取的会话总数量限制。该值非 0 时，当本地会话数量大于等于该值时停止拉取。 |


- **返回值**

  类型: <code>Promise<[InitResult](293494.md#initresult)\></code>

  初始化结果。

### getMessagesByUser <span id="bytedim-getmessagesbyuser"></span> 

拉取用户混链消息。
通常无需业务调用，SDK 内部会轮询。

- **类型**

  ```ts
  (params?: { cursor?: Long | string | number | Date; limit?: number; inboxType?: number;}) => Promise<void>
  ```

- **参数**

  - **params**

    类型: <code>{ cursor?: string | number | Date | Long | undefined; limit?: number | undefined; inboxType?: number | undefined; }</code>

    默认值: `' {}'`

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | cursor | `string | number | Date | Long | undefined` | 拉取消息位置游标。 |
      | limit | `number | undefined` | 单次拉取消息数量。 |
      | inboxType | `number | undefined` | 信箱类型。 |


### createCustomMessage <span id="bytedim-createcustommessage"></span> 

创建自定义消息。

- **类型**

  ```ts
  (params: { conversation: Conversation; content: string; clientId?: string | undefined; ext?: { [k: string]: string; } | undefined; mentionedUsers?: string[] | undefined; insert?: boolean | undefined; referenceMessage?: Message | undefined; referenceHint?: string | undefined; }) => Promise<Message>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); content: string; clientId?: string | undefined; ext?: { [k: string]: string; } | undefined; mentionedUsers?: string[] | undefined; insert?: boolean | undefined; referenceMessage?: [Message](293494.md#message) | undefined; referenceHint?: string | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 当前发送消息的会话。 |
      | content | `string` | 消息体。 |
      | clientId | `string | undefined` | 客户端 ID。 |
      | ext | `{ [k: string]: string; } | undefined` | 消息拓展属性。 |
      | mentionedUsers | `string[] | undefined` | 需要 @ 的用户列表。 |
      | insert | `boolean | undefined` | 消息创建后是否 process 处理（新消息处理流程）。 |
      | referenceMessage | `Message | undefined` | 引用的消息。 |
      | referenceHint | `string | undefined` | 业务透传的引用信息，传入自定义引用线索。 |


- **返回值**

  创建的消息，参看 [Message](293494.md#message)。

### createTextMessage <span id="bytedim-createtextmessage"></span> 

创建文本消息。

- **类型**

  ```ts
  (params: { conversation: Conversation; content: string; clientId?: string | undefined; ext?: { [k: string]: string; } | undefined; mentionedUsers?: string[] | undefined; insert?: boolean | undefined; referenceMessage?: Message | undefined; referenceHint?: string | undefined; }) => Promise<Message>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); content: string; clientId?: string | undefined; ext?: { [k: string]: string; } | undefined; mentionedUsers?: string[] | undefined; insert?: boolean | undefined; referenceMessage?: [Message](293494.md#message) | undefined; referenceHint?: string | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 当前发送消息的会话。 |
      | content | `string` | 消息体。 |
      | clientId | `string | undefined` | 客户端 ID。 |
      | ext | `{ [k: string]: string; } | undefined` | 消息拓展属性。 |
      | mentionedUsers | `string[] | undefined` | 需要 @ 的用户列表。 |
      | insert | `boolean | undefined` | 消息创建后是否 process 处理（新消息处理流程）。 |
      | referenceMessage | `Message | undefined` | 引用的消息。 |
      | referenceHint | `string | undefined` | 业务透传的引用信息，传入自定义引用线索。 |


- **返回值**

  创建的消息，参看 [Message](293494.md#message)。

### sendMessage <span id="bytedim-sendmessage"></span> 

发送消息。

- **类型**

  ```ts
  (params: { message: Message; priority?: im_proto.MessagePriority;}) => Promise<SendMessageResult>
  ```

- **参数**

  - **params**

    类型: <code>{ message: [Message](293494.md#message); priority?: im_proto.[MessagePriority](293494.md#messagepriority) | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | message | `Message` | 要发送的消息，由 `createXxxMessage` 接口创建。 |
      | priority | `im_proto.MessagePriority | undefined` | 消息的优先级（适用于直播群消息） |


- **返回值**

  发送消息结果。

### deleteMessage <span id="bytedim-deletemessage"></span> 

删除消息。

- **类型**

  ```ts
  (params: { message: Message; localOnly?: boolean;}) => Promise<void>
  ```

- **参数**

  - **params**

    类型: <code>{ message: [Message](293494.md#message); localOnly?: boolean | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | message | `Message` | 待删除的消息。 |
      | localOnly | `boolean | undefined` | 是否仅删除本地，不同步到服务端。 |


### recallMessage <span id="bytedim-recallmessage"></span> 

删除消息。

- **类型**

  ```ts
  (params: { message: Message;}) => Promise<void>
  ```

- **参数**

  - **params**

    类型: <code>{ message: [Message](293494.md#message); }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | message | `Message` | 待撤回的消息。 |


### getMessageByServerId <span id="bytedim-getmessagebyserverid"></span> 

获取消息的实时信息。

- **类型**

  ```ts
  (params: { conversation: Conversation; serverMessageId: string;}) => Promise<Message | null>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); serverMessageId: string; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | serverMessageId | `string` | 消息的 serverId。 |


- **返回值**

  参看 [Message](293494.md#message)。

### getMessageReferenceList <span id="bytedim-getmessagereferencelist"></span> 

获取引用消息链。
若消息 B 引用了消息 A，消息 C 引用了消息 B，那么 A -> B -> C 就是一条引用消息链。通过 A、B、C 任意一条消息都可以获取这条消息链。

- **类型**

  ```ts
  (params: { message: Message;}) => Promise<Message[]>
  ```

- **参数**

  - **params**

    类型: <code>{ message: [Message](293494.md#message); }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | message | `Message` | 消息体。 |


- **返回值**

  类型: <code>Promise<[Message](293494.md#message)[]\></code>

  引用消息链。

### modifyMessageProperty <span id="bytedim-modifymessageproperty"></span> 

设置消息属性。
常见使用场景：给某条消息点赞、加急等。

- **类型**

  ```ts
  (params: { message: Message; modifyContent: Array<{ key: string; operation?: im_proto.OPERATION_TYPE; value?: string; idempotentId?: string; }>;}) => Promise<ModifyMessagePropertyResult>
  ```

- **注意**

  消息加急本质上是修改消息属性，在中台侧仅为一个状态变更。加急之后的附加操作（如全局提醒、短信电话提醒等）需要业务方自行处理。

- **参数**

  - **params**

    类型: <code>{ message: [Message](293494.md#message); modifyContent: Array<{ key: string; operation?: im_proto.[OPERATION_TYPE](293494.md#operation_type); value?: string; idempotentId?: string;}\>; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | message | `Message` | 消息体。 |
      | modifyContent | `{ key: string; operation?: im_proto.OPERATION_TYPE | undefined; value?: string | undefined; idempotentId?: string | undefined; }[]` | 消息属性。 |
      | modifyContent.key | `string` | 表情回应消息，例如 OK/点赞/done 等。 |
      | modifyContent.operation | `im_proto.OPERATION_TYPE | undefined` | 操作类型。 |
      | modifyContent.value | `string | undefined` | 对应 content。也可以什么都不存，只代表有这个 key。 |
      | modifyContent.idempotentId | `string | undefined` | 幂等 ID。通常为 user ID，防止对单个点赞动作重复操作。 |


- **返回值**

  类型: <code>Promise<[ModifyMessagePropertyResult](293494.md#modifymessagepropertyresult)\></code>

  设置消息属性结果。

### getConversation <span id="bytedim-getconversation"></span> 

获取指定单个本地会话。

- **类型**

  ```ts
  (params: { conversationId: string;}) => Conversation
  ```

- **参数**

  - **params**

    类型: <code>{ conversationId: string; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversationId | `string` | 会话 ID。 |


- **返回值**

  参看 [Conversation](293494.md#conversation)。

### getConversationOnline <span id="bytedim-getconversationonline"></span> 

请求服务端更新本地会话后，获取指定单个会话。

- **类型**

  ```ts
  (params: { conversationId: string; shortId: string; type: im_proto.ConversationType;}) => Promise<Conversation>
  ```

- **参数**

  - **params**

    类型: <code>{ conversationId: string; shortId: string; type: im_proto.[ConversationType](293494.md#conversationtype); }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversationId | `string` | 会话 ID。 |
      | shortId | `string` | shortId。 |
      | type | `im_proto.ConversationType` | 会话类型。 |


- **返回值**

  参看 [Conversation](293494.md#conversation)。

### getConversationList <span id="bytedim-getconversationlist"></span> 

获取本地会话列表。

- **类型**

  ```ts
  (params?: { filter?: ((c: Conversation) => boolean) | undefined; }) => Conversation[]
  ```

- **参数**

  - **params**

    类型: <code>{ filter?: ((c: [Conversation](293494.md#conversation)) =\> boolean) | undefined; }</code>

    默认值: `' {}'`

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | filter | `((c: Conversation) => boolean) | undefined` | 过滤条件，默认过滤陌生人会话和空会话。 |


### getConversationListOnline <span id="bytedim-getconversationlistonline"></span> 

请求服务端更新本地会话后，获取会话列表。直播群列表请使用 [getLiveConversationListOnline](#getliveconversationlistonline)。

- **类型**

  ```ts
  (params?: { filter?: ((c: Conversation) => boolean) | undefined; }) => Promise<Conversation[]>
  ```

- **参数**

  - **params**

    类型: <code>{ filter?: ((c: [Conversation](293494.md#conversation)) =\> boolean) | undefined; }</code>

    默认值: `' {}'`

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | filter | `((c: Conversation) => boolean) | undefined` | 过滤条件，默认过滤陌生人会话和空会话。 |


### getMessagesByConversation <span id="bytedim-getmessagesbyconversation"></span> 

请求服务器获取会话内的消息列表。（直播群不可用）

- **类型**

  ```ts
  (params: { conversation: Conversation; cursor?: string | Long | Message; direction?: number; limit?: number; limitIndex?: Long;}) => Promise<{ messages: Message[]; hasMore: boolean; cursor: Long; }>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); cursor?: string | Long | [Message](293494.md#message) | undefined; direction?: number | undefined; limit?: number | undefined; limitIndex?: Long | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | cursor | `string | Long | Message | undefined` | 拉取消息位置游标。 |
      | direction | `number | undefined` | 拉取消息方向。 |
      | limit | `number | undefined` | 拉取消息数量。 |
      | limitIndex | `Long | undefined` | 保留参数，无意义。 |


- **返回值**

  会话内的消息列表，其中消息结构参看 [Message](293494.md#message)。

### getUserConversationList <span id="bytedim-getuserconversationlist"></span> 

请求服务器获取用户的会话列表。

- **类型**

  ```ts
  (params: { type: im_proto.ConversationType; inboxType?: number; cursor?: Long | string; limit?: number; sortType?: im_proto.SortType; includeRole?: number; excludeRole?: number; withCold?: boolean;}) => Promise<{ conversation: Conversation[]; hasMore: boolean; cursor: Long; }>
  ```

- **参数**

  - **params**

    类型: <code>{ type: im_proto.[ConversationType](293494.md#conversationtype); inboxType?: number | undefined; cursor?: string | Long | undefined; limit?: number | undefined; sortType?: im_proto.[SortType](293494.md#sorttype) | undefined; includeRole?: number | undefined; excludeRole?: number | undefined; withCold?: boolean | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | type | `im_proto.ConversationType` | 会话类型。 |
      | inboxType | `number | undefined` | 信箱类型。 |
      | cursor | `string | Long | undefined` | 拉取消息位置游标。 |
      | limit | `number | undefined` | 单次拉取消息数量。 |
      | sortType | `im_proto.SortType | undefined` | 排序类型。 |
      | includeRole | `number | undefined` | 查询群聊类型时，包含的群聊角色，参看 [GroupRole](293494.md#grouprole)。 |
      | excludeRole | `number | undefined` | 查询群聊类型时，排除的群聊角色，参看 [GroupRole](293494.md#grouprole)。 |
      | withCold | `boolean | undefined` | 保留参数，无意义。 |


- **返回值**

  用户会话列表，其中会话结构参看 [Conversation](293494.md#conversation)。

### createConversation <span id="bytedim-createconversation"></span> 

创建群聊。

- **类型**

  ```ts
  (params: { participants: string[] | string; bizExt?: { [k: string]: string; } | undefined; inboxType?: number | undefined; type?: im_proto.ConversationType | undefined; persistent?: boolean | undefined; idempotentId?: string | undefined; name?: string | undefined; avatarUrl?: string | undefined; desc?: string | undefined; }) => Promise<CreateConversationResult>
  ```

- **参数**

  - **params**

    类型: <code>{ participants: string[] | string; bizExt?: { [k: string]: string; } | undefined; inboxType?: number | undefined; type?: im_proto.[ConversationType](293494.md#conversationtype) | undefined; persistent?: boolean | undefined; idempotentId?: string | undefined; name?: string | undefined; avatarUrl?: string | undefined; desc?: string | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | participants | `string | string[]` | 会话内的用户 ID。 |
      | bizExt | `{ [k: string]: string; } | undefined` | 业务拓展信息。 |
      | inboxType | `number | undefined` | 信箱类型。 |
      | type | `im_proto.ConversationType | undefined` | 会话类型。 |
      | persistent | `boolean | undefined` | 持久化幂等，默认为 true，不建议修改。 |
      | idempotentId | `string | undefined` | 幂等 ID。由业务方自己生成，以同样的幂等 ID 创建群聊会话时，会返回之前已经创建好的群聊会话。 |
      | name | `string | undefined` | 群名称。 |
      | avatarUrl | `string | undefined` | 群头像的 url 链接。 |
      | desc | `string | undefined` | 群描述。 |


- **返回值**

  类型: <code>Promise<[CreateConversationResult](293494.md#createconversationresult)\></code>

  创建结果。

### leaveConversation <span id="bytedim-leaveconversation"></span> 

离开群组。

- **类型**

  ```ts
  (params: { conversation: Conversation;}) => Promise<void>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |


### deleteConversation <span id="bytedim-deleteconversation"></span> 

删除会话。

- **类型**

  ```ts
  (params: { conversation: Conversation; localOnly?: boolean;}) => Promise<void>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); localOnly?: boolean | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 待删除的会话。 |
      | localOnly | `boolean | undefined` | 是否仅在本地删除，不同步到服务端。<br>默认值为 false，即本地和服务端均删除。 |


### dissolveConversation <span id="bytedim-dissolveconversation"></span> 

解散群聊。

- **类型**

  ```ts
  (params: { conversation: Conversation;}) => Promise<void>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |


### setConversationSettingInfo <span id="bytedim-setconversationsettinginfo"></span> 

设置会话附加信息，如置顶、免打扰、收藏等。

- **类型**

  ```ts
  (params: { conversation: Conversation; stickOnTop?: boolean; mute?: boolean; favorite?: boolean; pushStatus?: PushStatus;}) => Promise<SetConversationSettingInfoResult>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); stickOnTop?: boolean | undefined; mute?: boolean | undefined; favorite?: boolean | undefined; pushStatus?: [PushStatus](293494.md#pushstatus) | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | stickOnTop | `boolean | undefined` | 是否置顶。 |
      | mute | `boolean | undefined` | 是否免打扰。 |
      | favorite | `boolean | undefined` | 是否收藏。 |
      | pushStatus | `PushStatus | undefined` | 消息推送模式。 |


- **返回值**

  类型: <code>Promise<[SetConversationSettingInfoResult](293494.md#setconversationsettinginforesult)\></code>

  设置结果。

### setConversationWeakMuteConfig <span id="bytedim-setconversationweakmuteconfig"></span> 

配置会话低打扰模式。

- **类型**

  ```ts
  (params: { conversation: Conversation; config: ConversationSettingWeakMuteInfo;}) => Promise<{ success: boolean; payload: Conversation; checkCode: Long; checkMsg: string; statusCode: number; statusMsg: string; }>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); config: [ConversationSettingWeakMuteInfo](293494.md#conversationsettingweakmuteinfo); }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | config | `ConversationSettingWeakMuteInfo` | 会话低打扰模式配置。 |


### upsertConversationSettingExtInfo <span id="bytedim-upsertconversationsettingextinfo"></span> 

更新 Setting ext 拓展信息。

- **类型**

  ```ts
  (params: { conversation: Conversation; ext?: { [k: string]: string; } | undefined; }) => Promise<{ success: boolean; payload: Conversation; checkCode: Long; checkMsg: string; statusCode: number; statusMsg: string; }>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); ext?: { [k: string]: string; } | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | ext | `{ [k: string]: string; } | undefined` | 拓展信息。 |


### setConversationCoreInfo <span id="bytedim-setconversationcoreinfo"></span> 

设置群聊信息。

- **类型**

  ```ts
  (params: { conversation: Conversation; name?: string | undefined; desc?: string | undefined; icon?: string | undefined; notice?: string | undefined; isNameSet?: boolean | undefined; isDescSet?: boolean | undefined; isIconSet?: boolean | undefined; isNoticeSet?: boolean | undefined; ext?: { [k: string]: string; } | undefined; bizExt?: { [k: string]: string; } | undefined;})=> Promise<SetConversationSettingInfoResult>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); name?: string | undefined; desc?: string | undefined; icon?: string | undefined; notice?: string | undefined; isNameSet?: boolean | undefined; isDescSet?: boolean | undefined; isIconSet?: boolean | undefined; isNoticeSet?: boolean | undefined; ext?: { [k: string]: string; } | undefined; bizExt?: { [k: string]: string; } | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | name | `string | undefined` | 群名称。 |
      | desc | `string | undefined` | 群描述。 |
      | icon | `string | undefined` | 群头像的 url 链接。 |
      | notice | `string | undefined` | 群公告。 |
      | isNameSet | `boolean | undefined` | 是否设置群名称。 |
      | isDescSet | `boolean | undefined` | 是否设置群描述。 |
      | isIconSet | `boolean | undefined` | 是否设置群头像。 |
      | isNoticeSet | `boolean | undefined` | 是否设置群公告。 |
      | ext | `{ [k: string]: string; } | undefined` | 拓展信息。 |
      | bizExt | `{ [k: string]: string; } | undefined` | 业务拓展信息。 |


- **返回值**

  类型: <code>Promise<[SetConversationSettingInfoResult](293494.md#setconversationsettinginforesult)\></code>

  群聊信息设置结果。

### upsertConversationCoreExtInfo <span id="bytedim-upsertconversationcoreextinfo"></span> 

更新 Core ext 拓展信息。

- **类型**

  ```ts
  (params: { conversation: Conversation; ext?: { [k: string]: string; } | undefined; }) => Promise<{ success: boolean; payload: Conversation; checkCode: Long; checkMsg: string; statusCode: number; statusMsg: string; }>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); ext?: { [k: string]: string; } | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | ext | `{ [k: string]: string; } | undefined` | 拓展信息。 |


- **返回值**

  更新结果。

### getConversationListByTop <span id="bytedim-getconversationlistbytop"></span> 

获取顶置会话。

- **类型**

  ```ts
  (params?: { cursor?: string | Long; limit?: number; inboxType?: number;}) => Promise<{ conversation: Conversation[]; hasMore: boolean; cursor: Long; }>
  ```

- **参数**

  - **params**

    类型: <code>{ cursor?: string | Long | undefined; limit?: number | undefined; inboxType?: number | undefined; }</code>

    默认值: `' {}'`

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | cursor | `string | Long | undefined` | 拉取消息位置游标，默认值为 0。 |
      | limit | `number | undefined` | 拉取消息数量。 |
      | inboxType | `number | undefined` | 信箱类型。 |


- **返回值**

  获取到的会话，其中会话结构参看 [Conversation](293494.md#conversation)。

### getConversationListByFavorite <span id="bytedim-getconversationlistbyfavorite"></span> 

获取收藏会话。

- **类型**

  ```ts
  (params?: { cursor?: string | Long; limit?: number; inboxType?: number;}) => Promise<{ conversation: Conversation[]; hasMore: boolean; cursor: Long; }>
  ```

- **参数**

  - **params**

    类型: <code>{ cursor?: string | Long | undefined; limit?: number | undefined; inboxType?: number | undefined; }</code>

    默认值: `' {}'`

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | cursor | `string | Long | undefined` | 拉取消息位置游标，默认值为 0。 |
      | limit | `number | undefined` | 拉取消息数量。 |
      | inboxType | `number | undefined` | 信箱类型。 |


- **返回值**

  获取到的会话，其中会话结构参看 [Conversation](293494.md#conversation)。

### markConversationRead <span id="bytedim-markconversationread"></span> 

标记会话已读。

- **类型**

  ```ts
  (params: { conversation: Conversation; readIndex?: string | Long | Message; convUnreadCount?: number; totalUnreadCount?: number;}) => Promise<void>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); readIndex?: string | Long | [Message](293494.md#message) | undefined; convUnreadCount?: number | undefined; totalUnreadCount?: number | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | readIndex | `string | Long | Message | undefined` | 消息的 indexInConversation。默认为会话的 lastMessageIndex（最后一条消息的 index）。 |
      | convUnreadCount | `number | undefined` | 会话中未读消息数。 |
      | totalUnreadCount | `number | undefined` | 总未读消息数。 |


### addParticipants <span id="bytedim-addparticipants"></span> 

添加群成员。

- **类型**

  ```ts
  (params: { conversation: Conversation; participant: Participant | Participant[] | string[] | string; bizExt?: { [k: string]: string; } | undefined; isDropReconnect?: boolean | undefined; }) => Promise<AddParticipantResult>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); participant: [Participant](293494.md#participant) | [Participant](293494.md#participant)[] | string[] | string; bizExt?: { [k: string]: string; } | undefined; isDropReconnect?: boolean | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | participant | `string | string[] | Participant | Participant[]` | 待添加的群成员 ID 列表。 |
      | bizExt | `{ [k: string]: string; } | undefined` | 业务拓展信息。 |
      | isDropReconnect | `boolean | undefined` | 是否是掉线重连。若用户因网络波动等原因掉线，SDK 会在网络恢复后自动重连。 |


- **返回值**

  类型: <code>Promise<[AddParticipantResult](293494.md#addparticipantresult)\></code>

  添加成员结果。

### removeParticipants <span id="bytedim-removeparticipants"></span> 

移除群成员/离开直播群/移除直播群成员，v1.1.0 新增直播群功能。

- **类型**

  ```ts
  (params: { conversation: Conversation; participant: Participant | Participant[] | string | string[]; bizExt?: { [k: string]: string; } | undefined; }) => Promise<RemoveParticipantResult>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); participant: [Participant](293494.md#participant) | [Participant](293494.md#participant)[] | string | string[]; bizExt?: { [k: string]: string; } | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | participant | `string | string[] | Participant | Participant[]` | 待移除的群成员 ID 列表。 |
      | bizExt | `{ [k: string]: string; } | undefined` | 业务拓展信息。 |


- **返回值**

  类型: <code>Promise<[RemoveParticipantResult](293494.md#removeparticipantresult)\></code>

  移除成员结果。

### updateParticipant <span id="bytedim-updateparticipant"></span> 

更新群成员信息。

- **类型**

  ```ts
  (params: { conversation: Conversation; userId: string; role?: number | undefined; alias?: string | undefined; bizExt?: { [k: string]: string; } | undefined; }) => Promise<UpdateParticipantResult>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); userId: string; role?: number | undefined; alias?: string | undefined; bizExt?: { [k: string]: string; } | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | userId | `string` | 成员的用户 ID。 |
      | role | `number | undefined` | 成员角色。<br>0 为普通成员，1 为群主。 |
      | alias | `string | undefined` | 成员群昵称。 |
      | bizExt | `{ [k: string]: string; } | undefined` | 业务拓展信息。 |


- **返回值**

  类型: <code>Promise<[UpdateParticipantResult](293494.md#updateparticipantresult)\></code>

  更新结果。

### getParticipants <span id="bytedim-getparticipants"></span> 

获取 SDK 本地维护的群成员列表。

- **类型**

  ```ts
  (params: { conversation: Conversation;}) => Participant[]
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |


### getParticipantsOnline <span id="bytedim-getparticipantsonline"></span> 

获取群成员列表。
此方法会在 SDK 内部循环调用分页接口，直至没有更多数据，然后把所有群成员数据一次返回。当群成员较多时，此方法耗时较久。

- **类型**

  ```ts
  (params: { conversation: Conversation; limit?: number; cursor?: Long;}) => Promise<{ participants: Participant[]; hasMore: boolean; cursor: Long; }>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); limit?: number | undefined; cursor?: Long | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | limit | `number | undefined` | 单页拉取消息数量。 |
      | cursor | `Long | undefined` | 下一页拉取消息位置游标。 |


- **返回值**

  群成员列表，其中成员结构参看 [Participant](293494.md#participant)。

### setConversationMute <span id="bytedim-setconversationmute"></span> 

设置群禁言（会话维度）。

- **类型**

  ```ts
  (params: { conversation: Conversation; block: boolean; normalOnly?: boolean;}) => Promise<Conversation>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); block: boolean; normalOnly?: boolean | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | block | `boolean` | 是否禁言。 |
      | normalOnly | `boolean | undefined` | 是否只禁言普通群成员。 |


- **返回值**

  参看 [Conversation](293494.md#conversation)。

### setParticipantMuteTime <span id="bytedim-setparticipantmutetime"></span> 

设置群禁言（成员维度）。

- **类型**

  ```ts
  (params: { conversation: Conversation; block: boolean; blockDuration: { [k: string]: string | number | Long; }; bizExt?: { [k: string]: string; } | undefined; }) => Promise<Conversation>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); block: boolean; blockDuration: { [k: string]: string | number | Long; }; bizExt?: { [k: string]: string; } | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | block | `boolean` | 是否禁言。 |
      | blockDuration | `{ [k: string]: string | number | Long; }` | 禁言用户和时间。key 是用户 ID；value 是禁言时间，单位为秒。{111: 1000} 表示把用户 111 禁言 1000 秒。 |
      | bizExt | `{ [k: string]: string; } | undefined` | 业务拓展信息。 |


- **返回值**

  参看 [Conversation](293494.md#conversation)。

### dispose <span id="bytedim-dispose"></span> 

手动卸载 SDK。

- **类型**

  ```ts
  () => void
  ```


## MultimediaPlugin <span id="multimediaplugin"></span>

类型: `class`

多媒体消息插件，在 IM 实例化时传入后，IM 实例增加发送媒体消息的方法。

- **API**

| 方法 | 描述 |
| :-- | :-- |
| [createImageMessage](#multimediaplugin-createimagemessage) | 创建图片消息。 |
| [createAudioMessage](#multimediaplugin-createaudiomessage) | 创建音频消息。 |
| [createVideoMessage](#multimediaplugin-createvideomessage) | 创建视频消息。 |
| [createFileMessage](#multimediaplugin-createfilemessage) | 创建文件消息。 |
| [refreshFileUrl](#multimediaplugin-refreshfileurl) | 根据消息内容刷新文件 URL。 |
| [validateFileUrl](#multimediaplugin-validatefileurl) | 校验文件 URL 是否在有效期。 |
| [getImageResizeUrls](#multimediaplugin-getimageresizeurls) | 获取图片 URL（缩放、转码）。 |


### createImageMessage <span id="multimediaplugin-createimagemessage"></span> 

创建图片消息。

- **类型**

  ```ts
  (params: { conversation: Conversation; fileInfo: FileInfo; clientId?: string | undefined; ext?: { [k: string]: string; } | undefined; mentionedUsers?: string[] | undefined; insert?: boolean | undefined; referenceMessage?: Message | undefined; referenceHint?: string | undefined; }) => Promise<Message>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); fileInfo: [FileInfo](293494.md#fileinfo); clientId?: string | undefined; ext?: { [k: string]: string; } | undefined; mentionedUsers?: string[] | undefined; insert?: boolean | undefined; referenceMessage?: [Message](293494.md#message) | undefined; referenceHint?: string | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | fileInfo | `FileInfo` | 文件信息。 |
      | clientId | `string | undefined` | 客户端 ID。 |
      | ext | `{ [k: string]: string; } | undefined` | 消息拓展属性。 |
      | mentionedUsers | `string[] | undefined` | 需要 @ 的用户列表。 |
      | insert | `boolean | undefined` | 消息创建后是否 process 处理（新消息处理流程）。 |
      | referenceMessage | `Message | undefined` | 引用的消息。 |
      | referenceHint | `string | undefined` | 业务透传的引用信息，传入自定义引用线索。 |


- **返回值**

  创建的消息，参看 [Message](293494.md#message)。

### createAudioMessage <span id="multimediaplugin-createaudiomessage"></span> 

创建音频消息。

- **类型**

  ```ts
  (params: { conversation: Conversation; fileInfo: FileInfo; clientId?: string | undefined; ext?: { [k: string]: string; } | undefined; mentionedUsers?: string[] | undefined; insert?: boolean | undefined; referenceMessage?: Message | undefined; referenceHint?: string | undefined; }) => Promise<Message>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); fileInfo: [FileInfo](293494.md#fileinfo); clientId?: string | undefined; ext?: { [k: string]: string; } | undefined; mentionedUsers?: string[] | undefined; insert?: boolean | undefined; referenceMessage?: [Message](293494.md#message) | undefined; referenceHint?: string | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | fileInfo | `FileInfo` | 文件信息。 |
      | clientId | `string | undefined` | 客户端 ID。 |
      | ext | `{ [k: string]: string; } | undefined` | 消息拓展属性。 |
      | mentionedUsers | `string[] | undefined` | 需要 @ 的用户列表。 |
      | insert | `boolean | undefined` | 消息创建后是否 process 处理（新消息处理流程）。 |
      | referenceMessage | `Message | undefined` | 引用的消息。 |
      | referenceHint | `string | undefined` | 业务透传的引用信息，传入自定义引用线索。 |


- **返回值**

  创建的消息，参看 [Message](293494.md#message)。

### createVideoMessage <span id="multimediaplugin-createvideomessage"></span> 

创建视频消息。

- **类型**

  ```ts
  (params: { conversation: Conversation; fileInfo: FileInfo; clientId?: string | undefined; ext?: { [k: string]: string; } | undefined; mentionedUsers?: string[] | undefined; insert?: boolean | undefined; referenceMessage?: Message | undefined; referenceHint?: string | undefined; }) => Promise<Message>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); fileInfo: [FileInfo](293494.md#fileinfo); clientId?: string | undefined; ext?: { [k: string]: string; } | undefined; mentionedUsers?: string[] | undefined; insert?: boolean | undefined; referenceMessage?: [Message](293494.md#message) | undefined; referenceHint?: string | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | fileInfo | `FileInfo` | 文件信息。 |
      | clientId | `string | undefined` | 客户端 ID。 |
      | ext | `{ [k: string]: string; } | undefined` | 消息拓展属性。 |
      | mentionedUsers | `string[] | undefined` | 需要 @ 的用户列表。 |
      | insert | `boolean | undefined` | 消息创建后是否 process 处理（新消息处理流程）。 |
      | referenceMessage | `Message | undefined` | 引用的消息。 |
      | referenceHint | `string | undefined` | 业务透传的引用信息，传入自定义引用线索。 |


- **返回值**

  创建的消息，参看 [Message](293494.md#message)。

### createFileMessage <span id="multimediaplugin-createfilemessage"></span> 

创建文件消息。

- **类型**

  ```ts
  (params: { conversation: Conversation; fileInfo: FileInfo; clientId?: string | undefined; ext?: { [k: string]: string; } | undefined; mentionedUsers?: string[] | undefined; insert?: boolean | undefined; referenceMessage?: Message | undefined; referenceHint?: string | undefined; }) => Promise<Message>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); fileInfo: [FileInfo](293494.md#fileinfo); clientId?: string | undefined; ext?: { [k: string]: string; } | undefined; mentionedUsers?: string[] | undefined; insert?: boolean | undefined; referenceMessage?: [Message](293494.md#message) | undefined; referenceHint?: string | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | fileInfo | `FileInfo` | 文件信息。 |
      | clientId | `string | undefined` | 客户端 ID。 |
      | ext | `{ [k: string]: string; } | undefined` | 消息拓展属性。 |
      | mentionedUsers | `string[] | undefined` | 需要 @ 的用户列表。 |
      | insert | `boolean | undefined` | 消息创建后是否 process 处理（新消息处理流程）。 |
      | referenceMessage | `Message | undefined` | 引用的消息。 |
      | referenceHint | `string | undefined` | 业务透传的引用信息，传入自定义引用线索。 |


- **返回值**

  创建的消息，参看 [Message](293494.md#message)。

### refreshFileUrl <span id="multimediaplugin-refreshfileurl"></span> 

根据消息内容刷新文件 URL。

- **类型**

  ```ts
  (params: { message: Message; ignoreCache?: boolean;}) => Promise<Message>
  ```

- **参数**

  - **params**

    类型: <code>{ message: [Message](293494.md#message); ignoreCache?: boolean | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | message | `Message` | 消息内容。 |
      | ignoreCache | `boolean | undefined` | 是否忽略缓存。 |


- **返回值**

  参看 [Message](293494.md#message)。

### validateFileUrl <span id="multimediaplugin-validatefileurl"></span> 

校验文件 URL 是否在有效期。

- **类型**

  ```ts
  (params: { message: Message; delta?: number;}) => boolean
  ```

- **参数**

  - **params**

    类型: <code>{ message: [Message](293494.md#message); delta?: number | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | message | `Message` | 消息内容 |
      | delta | `number | undefined` | 有效期偏移量，单位秒，默认提前30s认定过期 |


- **返回值**

  类型: <code>boolean</code>

### getImageResizeUrls <span id="multimediaplugin-getimageresizeurls"></span> 

获取图片 URL（缩放、转码）。

- **类型**

  ```ts
  (params: { uri: string; format?: string; width: number; height: number;}) => Promise<string[]>
  ```

- **参数**

  - **params**

    类型: <code>{ uri: string; format?: string | undefined; width: number; height: number; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | uri | `string` | 图片 URI。 |
      | format | `string | undefined` | 图片格式，目前支持 jpeg, png, webp, gif。 |
      | width | `number` | 图片宽度。 |
      | height | `number` | 图片高度。 |


- **返回值**

  类型: <code>Promise<string[]\></code>

  图片 URL。


## LivePlugin <span id="liveplugin"></span>

类型: `class`

直播群插件，在 IM 实例化时传入后，IM 实例增加直播群相关的方法。v1.1.0 新增。

- **API**

| 方法 | 描述 |
| :-- | :-- |
| [joinLiveGroup](#liveplugin-joinlivegroup) | 加入直播群，加入成功时会启动直播 ping 和断线恢复重进（接口基于 addParticipants） |
| [leaveLiveGroup](#liveplugin-leavelivegroup) | 离开直播群，并且会停止直播 ping（接口基于 removeParticipants） |
| [setParticipantBlockTime](#liveplugin-setparticipantblocktime) | 拉黑直播群成员。 |
| [getMuteParticipantsOnline](#liveplugin-getmuteparticipantsonline) | 获取直播群禁言成员列表。 |
| [getBlockParticipantsOnline](#liveplugin-getblockparticipantsonline) | 获取直播群被拉黑成员列表。 |
| [getLiveParticipantMuteWhiteListOnline](#liveplugin-getliveparticipantmutewhitelistonline) | 获取直播群禁言白名单。 |
| [addLiveParticipantMuteWhiteList](#liveplugin-addliveparticipantmutewhitelist) | 添加指定成员到直播群禁言白名单。 |
| [removeLiveParticipantMuteWhiteList](#liveplugin-removeliveparticipantmutewhitelist) | 从直播群禁言白名单移除指定成员。 |
| [getLiveConversationListOnline](#liveplugin-getliveconversationlistonline) | 获取直播群列表。 |
| [getLiveParticipantsOnline](#liveplugin-getliveparticipantsonline) | 获取直播群在线成员列表。 |
| [getLiveParticipantCountOnline](#liveplugin-getliveparticipantcountonline) | 获取直播群在线人数 |
| [getLiveParticipantInfoOnline](#liveplugin-getliveparticipantinfoonline) | 获取直播群指定成员信息（例如是否在线），v1.1.2 新增。 |
| [getLiveGroupHistoryMessageListOnline](#liveplugin-getlivegrouphistorymessagelistonline) | 获取直播群历史消息 |


### joinLiveGroup <span id="liveplugin-joinlivegroup"></span> 

加入直播群，加入成功时会启动直播 ping 和断线恢复重进（接口基于 addParticipants）

- **类型**

  ```ts
  (params: { conversation: Conversation; bizExt?: { [key: string]: string; } | undefined; }) => Promise<AddParticipantResult>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); bizExt?: { [key: string]: string; } | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 直播群 |
      | bizExt | `{ [key: string]: string; } | undefined` | 业务拓展信息 |


- **返回值**

  添加成员结果。

### leaveLiveGroup <span id="liveplugin-leavelivegroup"></span> 

离开直播群，并且会停止直播 ping（接口基于 removeParticipants）

- **类型**

  ```ts
  (params: { conversation: Conversation; bizExt?: { [key: string]: string; } | undefined; }) => Promise<RemoveParticipantResult>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); bizExt?: { [key: string]: string; } | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 直播群 |
      | bizExt | `{ [key: string]: string; } | undefined` | 业务拓展信息 |


### setParticipantBlockTime <span id="liveplugin-setparticipantblocktime"></span> 

拉黑直播群成员。

- **类型**

  ```ts
  (params: { conversation: Conversation; block: boolean; blockDuration: { [k: string]: string | number | Long; }; bizExt?: { [k: string]: string; } | undefined; }) => Promise<im_proto.IBlockMembersResponseBody | null | undefined>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); block: boolean; blockDuration: { [k: string]: string | number | Long; }; bizExt?: { [k: string]: string; } | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 会话信息。 |
      | block | `boolean` | 是否拉黑。 |
      | blockDuration | `{ [k: string]: string | number | Long; }` | 用户ID/拉黑时长。 |
      | bizExt | `{ [k: string]: string; } | undefined` |  |


- **返回值**

  拉黑的消息。

### getMuteParticipantsOnline <span id="liveplugin-getmuteparticipantsonline"></span> 

获取直播群禁言成员列表。

- **类型**

  ```ts
  (params: { conversation: Conversation; limit?: number; cursor?: Long;}) => Promise<{ participants: any; hasMore: any; cursor: any; }>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); limit?: number | undefined; cursor?: Long | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 直播群信息。 |
      | limit | `number | undefined` | 每页多少条，默认20条。 |
      | cursor | `Long | undefined` | 游标。 |


- **返回值**

  成员列表信息。

### getBlockParticipantsOnline <span id="liveplugin-getblockparticipantsonline"></span> 

获取直播群被拉黑成员列表。

- **类型**

  ```ts
  (params: { conversation: Conversation; limit?: number; cursor?: Long;}) => Promise<{ participants: any; hasMore: any; cursor: any; }>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); limit?: number | undefined; cursor?: Long | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 直播群信息。 |
      | limit | `number | undefined` | 每页多少条，默认20条。 |
      | cursor | `Long | undefined` | 游标。 |


- **返回值**

  成员列表信息。

### getLiveParticipantMuteWhiteListOnline <span id="liveplugin-getliveparticipantmutewhitelistonline"></span> 

获取直播群禁言白名单。

- **类型**

  ```ts
  (params: { conversation: Conversation; cursor?: Long; limit?: number;}) => Promise<{ participants: any; hasMore: any; cursor: any; }>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); cursor?: Long | undefined; limit?: number | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 需要获取的直播群 |
      | cursor | `Long | undefined` | 游标。 |
      | limit | `number | undefined` | 每页多少条，默认20条。 |


- **返回值**

  直播群禁言白名单。

### addLiveParticipantMuteWhiteList <span id="liveplugin-addliveparticipantmutewhitelist"></span> 

添加指定成员到直播群禁言白名单。

- **类型**

  ```ts
  (params: { conversation: Conversation; participantIds: string[];}) => Promise<{ failedParticipantIds: string[]; }>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); participantIds: string[]; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 直播群 |
      | participantIds | `string[]` | 成员 ID |


- **返回值**

  添加失败的成员 ID。

### removeLiveParticipantMuteWhiteList <span id="liveplugin-removeliveparticipantmutewhitelist"></span> 

从直播群禁言白名单移除指定成员。

- **类型**

  ```ts
  (params: { conversation: Conversation; participantIds: string[];}) => Promise<{ failedParticipantIds: string[]; }>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); participantIds: string[]; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 直播群 |
      | participantIds | `string[]` | 成员 ID |


- **返回值**

  移除失败的成员 ID。

### getLiveConversationListOnline <span id="liveplugin-getliveconversationlistonline"></span> 

获取直播群列表。

- **类型**

  ```ts
  (params: { cursor?: Long; policy?: number; limit?: number;}) => Promise<{ conversation: any; hasMore: any; cursor: any; }>
  ```

- **参数**

  - **params**

    类型: <code>{ cursor?: Long | undefined; policy?: number | undefined; limit?: number | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | cursor | `Long | undefined` | 游标。 |
      | policy | `number | undefined` | 过滤条件 1: 所有的群 3: 自己是群主的群。默认返回所有群。 |
      | limit | `number | undefined` | 每页多少条，默认20条。 |


- **返回值**

  直播群列表信息。

### getLiveParticipantsOnline <span id="liveplugin-getliveparticipantsonline"></span> 

获取直播群在线成员列表。

- **类型**

  ```ts
  (params: { conversation: Conversation; limit?: number; cursor?: Long;}) => Promise<{ participants: any; hasMore: any; cursor: any; }>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); limit?: number | undefined; cursor?: Long | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 直播群信息。 |
      | limit | `number | undefined` | 每页多少条，默认20条。 |
      | cursor | `Long | undefined` | 游标。 |


- **返回值**

  在线成员列表信息。

### getLiveParticipantCountOnline <span id="liveplugin-getliveparticipantcountonline"></span> 

获取直播群在线人数

- **类型**

  ```ts
  (params: { conversation: Conversation;}) => Promise<{ count: number; }>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 直播群信息。 |


- **返回值**

  在线人数

### getLiveParticipantInfoOnline <span id="liveplugin-getliveparticipantinfoonline"></span> 

获取直播群指定成员信息（例如是否在线），v1.1.2 新增。

- **类型**

  ```ts
  (params: { conversation: Conversation; participantIds: string[];}) => Promise<Record<string, im_proto.IMemberInfo | undefined>>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); participantIds: string[]; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 直播群 |
      | participantIds | `string[]` | 要查询的用户 ID |


- **返回值**

  类型: <code>Promise<Record<string, im_proto.[IMemberInfo](293494.md#imemberinfo) | undefined\>\></code>

  直播群指定成员信息。

### getLiveGroupHistoryMessageListOnline <span id="liveplugin-getlivegrouphistorymessagelistonline"></span> 

获取直播群历史消息

- **类型**

  ```ts
  (params: { conversation: Conversation; limit?: number; fromIndex?: Long; direction?: im_proto.MessageDirection;}) => Promise<{ messages: Message[]; hasMore: boolean; nextIndex: Long; }>
  ```

- **参数**

  - **params**

    类型: <code>{ conversation: [Conversation](293494.md#conversation); limit?: number | undefined; fromIndex?: Long | undefined; direction?: im_proto.[MessageDirection](293494.md#messagedirection) | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | conversation | `Conversation` | 直播群信息。 |
      | limit | `number | undefined` | 每页多少条，默认 20 条。 |
      | fromIndex | `Long | undefined` | 查询起始下标，默认为 Long.MAX_VALUE（配合查询方向） |


- **返回值**

  对应区间消息列表和下一页起始下标


## ContactPlugin <span id="contactplugin"></span>

类型: `class`

联系人插件，提供好友关系等能力；在 IM 实例化时传入后，IM 实例增加联系人相关的方法。v1.2.0 新增。

- **API**

| 方法 | 描述 |
| :-- | :-- |
| [getFriendReceiveApplyListOnline](#contactplugin-getfriendreceiveapplylistonline) | 获取好友申请列表。 |
| [getFriendListOnline](#contactplugin-getfriendlistonline) | 获取好友列表。 |
| [applyFriend](#contactplugin-applyfriend) | 申请添加好友。 |
| [deleteFriend](#contactplugin-deletefriend) | 删除好友。 |
| [replyFriendApply](#contactplugin-replyfriendapply) | 回应好友申请。 |
| [markFriendReceiveApplyAsRead](#contactplugin-markfriendreceiveapplyasread) | 标记好友申请已读。（用于同步申请未读数等场景） |


### getFriendReceiveApplyListOnline <span id="contactplugin-getfriendreceiveapplylistonline"></span> 

获取好友申请列表。

- **类型**

  ```ts
  (params: { cursor?: Long; limit?: number; direction?: im_proto.MessageDirection;}) => Promise<{ list: FriendApply[]; totalCount: number; cursor: Long | null | undefined; hasMore: boolean | null | undefined; unreadCount: number; }>
  ```

- **参数**

  - **params**

    类型: <code>{ cursor?: Long | undefined; limit?: number | undefined; direction?: im_proto.[MessageDirection](293494.md#messagedirection) | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | cursor | `Long | undefined` | 分页游标，首页拉取可使用 0。 |
      | limit | `number | undefined` | 查询条数，默认 20 条。 |
      | direction | `im_proto.MessageDirection | undefined` | 拉取方向，默认从新到旧。 |


- **返回值**

  好友申请列表与分页信息，其中好友申请列表参看 [FriendApply](293494.md#friendapply)。

### getFriendListOnline <span id="contactplugin-getfriendlistonline"></span> 

获取好友列表。

- **类型**

  ```ts
  (params: { cursor?: Long; limit?: number;}) => Promise<{ list: Friend[]; totalCount: number; cursor: Long | null | undefined; hasMore: boolean | null | undefined; }>
  ```

- **参数**

  - **params**

    类型: <code>{ cursor?: Long | undefined; limit?: number | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | cursor | `Long | undefined` | 分页游标，首页拉取可使用 0。 |
      | limit | `number | undefined` | 查询条数，默认 20 条。 |


- **返回值**

  好友列表与分页信息，其中好友信息参看 [Friend](293494.md#friend)。

### applyFriend <span id="contactplugin-applyfriend"></span> 

申请添加好友。

- **类型**

  ```ts
  ({ userId, ext }: { userId: string; ext?: { [key: string]: string; } | undefined; }) => Promise<{ status: number | null | undefined; checkCode: Long | null | undefined; checkMessage: string | null | undefined; index: Long | null | undefined; applyId: string | null | undefined; }>
  ```

- **参数**

  - **{ userId, ext }**

    类型: <code>{ userId: string; ext?: { [key: string]: string; } | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | userId | `string` | 接收方用户 ID。 |
      | ext | `{ [key: string]: string; } | undefined` | 业务扩展字段。 |


- **返回值**

  申请添加好友结果。

### deleteFriend <span id="contactplugin-deletefriend"></span> 

删除好友。

- **类型**

  ```ts
  ({ userIds }: { userIds: string[];}) => Promise<{ failedInfos: { failedReason: string; failedCode: im_proto.StatusCode; failedUserId: string; }[]; }>
  ```

- **参数**

  - **{userIds}**

    类型: <code>{ userIds: string[]; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | userIds | `string[]` | 需要删除的用户 ID。 |


- **返回值**

  删除失败列表。

### replyFriendApply <span id="contactplugin-replyfriendapply"></span> 

回应好友申请。

- **类型**

  ```ts
  (params: { userId: string; attitude: ReplyFriendAttitude; ext?: { [key: string]: string; } | undefined; }) => Promise<{ failedInfos: { failedReason: string; failedCode: im_proto.StatusCode; failedUserId: string; }[]; }>
  ```

- **参数**

  - **params**

    类型: <code>{ userId: string; attitude: [ReplyFriendAttitude](293494.md#replyfriendattitude); ext?: { [key: string]: string; } | undefined; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | userId | `string` | 回复的申请用户 ID。 |
      | attitude | `ReplyFriendAttitude` | 好友申请回应状态。 |
      | ext | `{ [key: string]: string; } | undefined` | 业务扩展字段。 |


- **返回值**

  回复失败列表。

### markFriendReceiveApplyAsRead <span id="contactplugin-markfriendreceiveapplyasread"></span> 

标记好友申请已读。（用于同步申请未读数等场景）

- **类型**

  ```ts
  ({ readIndex }: { readIndex: Long;}) => Promise<void>
  ```

- **参数**

  - **{readIndex}**

    类型: <code>{ readIndex: Long; }</code>

    - **成员**

      | 名称 | 类型 | 描述 |
      | :-- | :-- | :-- |
      | readIndex | `Long` | 已读取的申请下标。 |



## EventBus <span id="eventbus"></span>

类型: `class`

- **API**

| 方法 | 描述 |
| :-- | :-- |
| [subscribe](#eventbus-subscribe) | 创建一个事件订阅 |
| [unsubscribe](#eventbus-unsubscribe) | 取消一个事件订阅 |


### subscribe <span id="eventbus-subscribe"></span> 

创建一个事件订阅

- **类型**

  ```ts
  <T extends keyof IMEventTypeMap>(event: T, func: EventHandler<IMEventTypeMap[T]>) => Subscription<IMEventTypeMap[T]>
  ```

- **参数**

  - **event**

    类型: <code>T</code>

    事件类型，参看 [IMEvent](293492.md#imevent)。

  - **func**

    类型: <code>[EventHandler](293494#eventhandler)<[IMEventTypeMap](293492.md#imeventtypemap)[T]\></code>

    事件回调函数。

- **返回值**

  类型: <code>Subscription<[IMEventTypeMap](293492.md#imeventtypemap)[T]\></code>

  回调函数 Index

### unsubscribe <span id="eventbus-unsubscribe"></span> 

取消一个事件订阅

- **类型**

  ```ts
  (event: IMEvent, handler: Subscription<any>) => void
  ```

- **参数**

  - **event**

    类型: <code>[IMEvent](293492.md#imevent)</code>

    事件类型

  - **handler**

    类型: <code>[Subscription](293494.md#subscription)<any\></code>

    回调函数 Index