如果你希望从此前版本的 Android 客户端 SDK 升级到最新的客户端 SDK，请在工程文件中，替换最新的客户端 SDK 文件，并参考本文完成 API，回调，参数类型等的替换。

> 升级过程中，你可能需要参考[老版本 API 文档归档](70068)。
## 3.52
### 方法变更

| 变更详情 | 功能模块 | 变动前方法 | 变动后方法 | 说明 |
| --- | --- | --- | --- | --- |
| 参数变更 | 引擎管理 | [`feedback`](70080.md#RTCVideo-feedback) || 参数数据类型变更 |
| 行为变更 | 高级功能 | [`startAudioRecording`](70080.md#RTCVideo-startaudiorecording) || 在此前版本中，此接口仅支持进房后调用。 |\
||||| 自此版本后，此接口在进房前后均可调用。进房前调用，退房之后录制任务不会自动停止；进房后调用，退房之后录制任务会自动停止。 |
| 合并 | 高级功能 | - `updatePosition` | [`updateSelfPosition`](70080.md#ISpatialAudio-updateselfposition) | 新接口支持本地用户同时设置自己的发声位置和发声朝向。 |\
||| - `updateSelfOrientation` |
| ^^ | ^^ | - `updateListenerPosition` | [`updateRemotePosition`](70080.md#ISpatialAudio-updateremoteposition) | 新接口支持本地用户设置远端用户的发声位置和发声朝向。 |\
||| - `updateListenerOrientation` |
| 废弃 | CDN 推流 | `public abstract int startLiveTranscoding(String taskId, LiveTranscoding liveTranscode, ILiveTranscodingObserver observer);startLiveTranscoding` | [`public abstract int startPushMixedStreamToCDN(String taskId, MixedStreamConfig mixedConfig, IMixedStreamObserver observer);`](70080.md#RTCVideo-startpushmixedstreamtocdn) | 合流转推直播接口/参数类型重命名，行为逻辑无变化，新旧版本类名对应关系参看该版本中的“类型变更” |
| ^^ | ^^ | `public abstract int stopLiveTranscoding(String taskId);` | [`public abstract int stopPushStreamToCDN(String taskId);`](70080.md#RTCVideo-stoppushstreamtocdn) | ^^ |
| ^^ | ^^ | `public abstract int updateLiveTranscoding(String taskId, LiveTranscoding transcoding);` | [`public abstract int updatePushMixedStreamToCDN(String taskId, MixedStreamConfig mixedConfig);`](70080.md#RTCVideo-updatepushmixedstreamtocdn) | ^^ |


### 回调变更

| **变更详情** | **功能模块** | **变动前回调** | **变动后回调** |
| --- | --- | --- | --- |
| 参数变更、拆分 | 音视频传输 | `onPublicStreamSEIMessageReceived` | 参数 `sourceType` 的类型由 `SEIMessageSourceType` 变更为 `DataMessageSourceType` |  |\
|||| 拆分为： |\
|||||\
|||| - [`onPublicStreamSEIMessageReceived`](70081.md#IRTCVideoEventHandler-onpublicstreamseimessagereceived)：接收客户端插入的 SEI 消息。 |\
|||| - [`onPublicStreamDataMessageReceived`](70081.md#IRTCVideoEventHandler-onpublicstreamdatamessagereceived)：接收服务端插入的 SEI 消息和其他数据信息，例如音量信息。 |


### 类型变更

| 变更详情 | 类型 | 变更前 | 变更后 | 说明 |
| --- | --- | --- | --- | --- |
| 重命名 | 转推直播一级结构体 | `LiveTranscoding` | [`MixedStreamConfig`](70083.md#mixedstreamconfig) | 结构体中变量名称/方法名称均有变更，请至对应的类型详情中查看 |
| ^^ | 转推直播 Observer | `ILiveTranscodingObserver` | [`IMixedStreamObserver`](70081.md#imixedstreamobserver) | 升级该版本你需要 import com.ss.bytertc.engine.video.VideoFrame 类替代 org.webrtc.VideoFrame 类 |
| ^^ | 转推直播二级结构体 | `VideoConfig` | [`MixedStreamVideoConfig`](70083.md#mixedstreamvideoconfig) | 结构体中变量名称/方法名称均有变更，请至对应的类型详情中查看 |
| ^^ | ^^ | `AudioConfig` | [`MixedStreamAudioConfig`](70083.md#mixedstreamaudioconfig) | ^^ |
| ^^ | ^^ | `SpatialConfig` | [`MixedStreamSpatialConfig`](70083.md#mixedstreamspatialconfig) | ^^ |
| ^^ | ^^ | `ClientMixParam` | [`MixedStreamClientMixConfig`](70083.md#mixedstreamclientMixconfig) | ^^ |
| ^^ | ^^ | `Region` | [`MixedStreamLayoutRegionConfig`](70083.md#mixedstreamlayoutregionconfig) | ^^ |
| ^^ | ^^ | `Layout` | [`MixedStreamLayoutConfig`](70083.md#mixedstreamlayoutconfig) | ^^ |
| ^^ | 转推直播相关枚举类型 | `TranscoderClientMixVideoFormat` | [`MixedStreamClientMixVideoFormat`](70083.md#mixedstreamclientmixvideoformat) | 各枚举类中的枚举值名称均有变更，请至对应的类型详情中查看 |
| ^^ | ^^ | `TranscoderContentControlType` | [`MixedStreamMediaType`](70083.md#mixedstreammediatype) | ^^ |
| ^^ | ^^ | `TranscoderRenderMode` | [`MixedStreamRenderMode`](70083.md#mixedstreamrendermode) | ^^ |
| ^^ | ^^ | `TranscoderLayoutRegionType` | [`MixedStreamLayoutRegionType`](70083.md#mixedstreamlayoutregiontype) | ^^ |
| ^^ | ^^ | `AACProfile` | [`MixedStreamAudioProfile`](70083.md#mixedstreamaudioprofile) | ^^ |
| ^^ | ^^ | `VideoCodecType` | [`MixedStreamVideoCodecType`](70083.md#mixedstreamvideocodectype) | ^^ |
| ^^ | ^^ | `AudioCodecType` | [`MixedStreamAudioCodecType`](70083.md#mixedstreamaudiocodectype) | ^^ |
| ^^ | ^^ | `ByteRTCStreamMixingType` | [`MixedStreamType`](70083.md#mixedstreamtype) | ^^ |


### 错误码变更

| **变更详情** | **错误码** | **说明** |
| --- | --- | --- |
| 枚举值变更 | [`PublicStreamErrorCode`](70082.md#publicstreamerrorcode) | 新增枚举值： |\
||||\
||| - `ERROR_CODE_PULL_NO_PUSH_STREAM(1300)` |\
||||\
||| 名称变更： |\
||||\
||| - `ERROR_CODE_PARAM_ERROR(1191)` 更新为 `ERROR_CODE_PUSH_PARAM_ERROR(1191)` |\
||| 	 |\
||| - `ERROR_CODE_STATE_ERROR(1192)` 更新为 `ERROR_CODE_PUSH_STATE_ERROR(1192)` |\
||| 	 |\
||| - `ERROR_CODE_INTERNAL_ERROR(1193)` 更新为 `ERROR_CODE_PUSH_INTERNAL_ERROR(1193)` |
| ^^ | [`ErrorCode`](70082.md#errorcode) | 新增枚举值： |\
||| `ERROR_CODE_JOIN_ROOM_ROOM_FORBIDDEN=-1025` 和 `ERROR_CODE_JOIN_ROOM_USER_FORBIDDEN=-1026`。 |\
||| 当服务端在指定房间封禁指定用户，而此用户加入房间失败，或从房间中被踢出时收到。 |
| ^^ | ^^ | 废弃枚举值 `ERROR_CODE_OVER_SCREEN_PUBLISH_LIMIT=-1081`，用 `ERROR_CODE_OVER_STREAM_PUBLISH_LIMIT=-1080` 替代。 |



## 3.50
### 产物变更
该版本 SDK 产物新增 apm_insight_crash_lite 依赖库，若以**离线**方式集成 SDK，需手动添加该依赖库，具体添加方式参看[添加依赖](70134.md#depencency)。

### 方法变更

| **变更详情** | **功能模块** | **变动前方法** | **变动后方法** | **备注** |
| --- | --- | --- | --- | --- |
| 拆分 | 视频管理 | `public abstract int registerFaceDetectionObserver(IFaceDetectionObserver observer, int interval);` | <ul><li>[`public abstract int enableFaceDetection( IFaceDetectionObserver observer, int interval_ms, String face_model_path);`](70080.md#IVideoEffect-enablefacedetection)</li><li>[`public abstract int disableFaceDetection();`](70080.md#IVideoEffect-disablefacedetection)</li></ul> | 解除人脸识别与视频特效之间的耦合，提升接口易用性。 |
| 参数类型变更 | 屏幕共享 | `public abstract int setScreenVideoEncoderConfig(VideoEncoderConfig screen_solution);` | [`public abstract int setScreenVideoEncoderConfig(ScreenVideoEncoderConfig screen_solution);`](70080.md#RTCVideo-setscreenvideoencoderconfig) | 参数类型变更为新增的 `ScreenVideoEncoderConfig` |
| 行为变更 | 屏幕共享 | <ul><li>`setVideoSourceType`: 屏幕流默认为外部源</li><li>`setScreenAudioSourceType`: 当前设置为内部源时，且已开启了采集，调用该接口切换为外部源时，**不会**停止内部采集</li><li>`startScreenCapture`: 当前为外部源时，调用本接口将自动切换为内部源，并开启采集</li><li>`stopScreenCapture`: 当前为外部源时，调用本接口将关闭外部采集</li></ul> | <ul><li>[`setVideoSourceType`](70080#RTCVideo-setvideosourcetype)：屏幕流默认为内部源</li><li>[`setScreenAudioSourceType`](70080#RTCVideo-setscreenaudiosourcetype)：当前设置为内部源时，且已开启了采集，调用该接口切换为外部源时，**自动**停止内部采集</li><li>[`startScreenCapture`](70080#RTCVideo-startscreencapture)：当前为外部源时，调用本接口失败，并触发 [`onAudioDeviceWarning`](70081.md#IRTCVideoEventHandler-onaudiodevicewarning) 或 [`onVideoDeviceWarning`](70081.md#IRTCVideoEventHandler-onvideodevicewarning)</li><li>[`stopScreenCapture`](70080#RTCVideo-stopscreencapture)：当前为外部源时，调用本接口失败，并触发 [`onAudioDeviceWarning`](70081.md#IRTCVideoEventHandler-onaudiodevicewarning) 或 [`onVideoDeviceWarning`](70081.md#IRTCVideoEventHandler-onvideodevicewarning) | 优化屏幕共享接口的行为 |
| 废弃 | 自定义流处理 | `registerVideoFrameObserver` | 用 [`setLocalVideoSink`](70080.md#RTCVideo-setlocalvideosink) 代替 |  |
| 所属类型变更、名称变更、参数变更 | 音视频处理 | <ul><li>`public abstract int checkVideoEffectLicense(Context context , String licenseFile);`</li><li>`public abstract void setVideoEffectAlgoModelPath(String modelPath);` | [`public abstract int initCVResource(String license_file, String algo_model_dir);`](70080.md#IVideoEffect-initcvresource) | <ul><li>统一从 RTCVideo 类下调整到 IVideoEffect 类下</li><li>统一返回值 |
| ^^ | ^^ | `public abstract int enableVideoEffect(boolean enable);` | - [`public abstract int enableVideoEffect();`](70080.md#IVideoEffect-enablevideoeffect) | ^^ |\
|||| - [`public abstract int disableVideoEffect();`](70080.md#IVideoEffect-disablevideoeffect) |
| ^^ | ^^ | `public abstract int setVideoEffectNodes(List<String> effectNodes);` | [`public abstract int setEffectNodes(List<String> effect_nodes);`](70080.md#IVideoEffect-seteffectnodes) | ^^ |
| ^^ | ^^ | `public abstract int updateVideoEffectNode(String effectNode, String key, float value);` | [`public abstract int updateEffectNode(String effect_node, String key, float value);`](70080.md#IVideoEffect-updateeffectnode) | ^^ |
| ^^ | ^^ | `public abstract int setBackgroundSticker(String modelPath, VirtualBackgroundSource source);` | - [`public abstract int enableVirtualBackground(String bg_sticker_res, VirtualBackgroundSource source);`](70080.md#IVideoEffect-enablevirtualbackground) | ^^ |\
|||| - [`public abstract int disableVirtualBackground();`](70080.md#IVideoEffect-disablevirtualbackground) |
| ^^ | ^^ | `public abstract int setVideoEffectColorFilter(String resFile);` | [`public abstract int setColorFilter(String filter_res);`](70080.md#IVideoEffect-setcolorfilter) | ^^ |
| ^^ | ^^ | `public abstract int setVideoEffectColorFilterIntensity(float intensity);` | [`public abstract int setColorFilterIntensity(float intensity);`](70080.md#IVideoEffect-setcolorfilterintensity) | ^^ |
| 参数变更 | 消息 | `public abstract int sendSEIMessage(StreamIndex streamIndex, byte[] message, int repeatCount);` | [`public abstract int sendSEIMessage(StreamIndex streamIndex, byte[] message, int repeatCount, SEICountPerFrame mode);`](70080.md#RTCVideo-sendseimessage) | 支持 SEI 多发模式，即在 1 帧间隔内多次发送 SEI 数据时，多个 SEI 随下个视频帧同时发送。 |
| ^^ | 多个模块 | 返回值类型变化，例如： ||  |\
||||\
||| - 旧方法——`public abstract void updateToken(String token);` |\
||| 	 |\
||| - 新方法——`public abstract int updateToken(String token);` |\
||| 	 |\
||||\
||| ++以下接口返回值类型由 void 变为 int，具体 int 值含义参考新增数据结构++ ++[`ReturnStatus`](70083.md#returnstatus)++++：++  |\
||||\
||| updateToken |\
||||\
||| setRemoteVideoConfig |\
||||\
||| subscribeStream |\
||||\
||| unsubscribeStream |\
||||\
||| subscribeScreen |\
||||\
||| unsubscribeScreen |\
||||\
||| setVoiceChangerType |\
||||\
||| setRemoteAudioPlaybackVolume |\
||||\
||| setPublicStreamVideoSink |\
||||\
||| ++以下接口返回值类型由 boolean 变为 int，具体 int 值含义参考新增数据结构++ ++[`ReturnStatus`](70083.md#returnstatus)++++：++  |\
||||\
||| setVoiceReverbType |\
||||\
||| pushExternalVideoFrame |\
||||\
||| pushExternalEncodedVideoFrame |\
||||\
||| ++以下接口返回值类型由 int 变为 void：++  |\
||||\
||| setMultiDeviceAVSync |\
||||\
||| setLocalVideoMirrorType |\
||||\
||| setVideoRotationMode |\
||||\
||| setAudioRoute |\
||||\
||| registerAudioFrameObserver |\
||||\
||| registerAudioProcessor |\
||||\
||| enableSimulcastMode |\
||||\
||| setPublishFallbackOption |\
||||\
||| setSubscribeFallbackOption |\
||||\
||| updateLocalVideoCanvas |\
||||\
||| setRemoteVideoCanvas |
| ^^ | 视频管理 | `public abstract void updateRemoteStreamVideoCanvas(String roomId, String userId, StreamIndex streamIndex, int renderMode, int background_color);` | [`public abstract void updateRemoteStreamVideoCanvas(RemoteStreamKey stream_key, int renderMode, int background_color);`](70080.md#RTCVideo-updateremotestreamvideocanvas) | 通过 `stream_key` 传入 `roomId`、`userId` 和 `streamIndex`。 |
| ^^ | ^^ | `public abstract int setRemoteVideoCanvas(String userId, StreamIndex streamIndex, VideoCanvas videoCanvas);` | [`public abstract void setRemoteVideoCanvas(RemoteStreamKey stream_key, VideoCanvas videoCanvas);`](70080.md#RTCVideo-setremotevideocanvas) | 通过 `stream_key` 传入 `userId` 和 `streamIndex`。 |
| 名称变更 | 引擎管理 | `getSdkVersion` | [`getSDKVersion`](70080.md#RTCVideo-getsdkversion) | 修正大小写。 |
| 名称和参数变更 | 屏幕分享 | `public abstract boolean pushScreenFrame(VideoFrame videoFrame);` | [`public abstract int pushScreenVideoFrame(VideoFrame videoFrame);`](70080.md#RTCVideo-pushscreenvideoframe) | - 返回参数由 boolean 变更为 int。 |\
||||| - 方法名称由 `pushScreenFrame` 变更为 `pushScreenVideoFrame`。 |


### 回调变更

| **变更详情** | **功能模块** | **变动前方法** | **变动后方法** | **备注** |
| --- | --- | --- | --- | --- |
| 废弃 | 音频管理 | `onLocalAudioStateChanged` 和 `onLocalVideoStateChanged` | 用 [`onAudioDeviceStateChanged`](70081.md#IRTCVideoEventHandler-onaudiodevicestatechanged) 和 [`onVideoDeviceStateChanged`](70081.md#IRTCVideoEventHandler-onvideodevicestatechanged) 代替 |  |
| 行为变更 | 自定义流处理 | [`onProcessRecordAudioFrame`](70081.md#IAudioFrameProcessor-onprocessrecordaudioframe) || 在此前版本中，修改通过此回调返回的音频帧，会影响发送到远端的音频数据和本地软件耳返中的音频数据。 |\
||||| 自此版本后，修改此回调中返回的音频帧，仅影响发送到远端的音频数据；如果你希望修改本地软件耳返中音频数据，参看 `onProcessEarMonitorAudioFrame`。 |
| 参数变更 | CDN 推流 | `void onMixingAudioFrame(String taskId, byte[] audioFrame, int frameNum);` | [`void onMixingAudioFrame(String taskId, byte[] audioFrame, int frameNum, long timeStampMs);`](70081.md#ILiveTranscodingObserver-onmixingaudioframe) | 新增参数 `timeStampMs` |\
|||
| ^^ | 消息 | `public void onPublicStreamSEIMessageReceived(String publicStreamId, ByteBuffer message) {}` | [`public void onPublicStreamSEIMessageReceived(String publicStreamId, ByteBuffer message, SEIMessageSourceType sourceType) {}`](70081.md#IRTCVideoEventHandler-onpublicstreamseimessagereceived) | 新增参数 `sourceType` |
| 名称变更 | 自定义流处理 | `OnStart` | [`onStart`](70081.md#IExternalVideoEncoderEventHandler-onstart) | 大驼峰变更为小驼峰 |\
||||||
| ^^ | ^^ | `OnStop` | [`onStop`](70081.md#IExternalVideoEncoderEventHandler-onstop) | ^^ |
| ^^ | ^^ | `OnRateUpdate` | [`onRateUpdate`](70081.md#IExternalVideoEncoderEventHandler-onrateupdate) | ^^ |
| ^^ | ^^ | `OnRequestKeyFrame` | [`onRequestKeyFrame`](70081.md#IExternalVideoEncoderEventHandler-onrequestkeyframe) | ^^ |
| ^^ | ^^ | `OnRemoteEncodedVideoFrame` | [`onRemoteEncodedVideoFrame`](70081.md#IRemoteEncodedVideoFrameObserver-onremoteencodedvideoframe) | ^^ |
| ^^ | CDN 推流 | `onDataFrame` | [`onMixingDataFrame`](70081.md#ILiveTranscodingObserver-onmixingdataframe) |  |
| 删除回调类 | 范围语音 | [`IRangeAudioObserver`](70081.md#irangeaudioobserver) 类和相关的接口 || 此前，在手动订阅的场景下，如果你希望使用范围语音功能，你必须根据此回调获取的衰减系数，设定音量。 |\
||||| 自此版本起，无论是手动订阅还是自动订阅，衰减效果都由 SDK 实现，无需使用此接口。 |


### 类型变更

| **变更详情** | **数据类型** | **备注** |
| --- | --- | --- |
| 取值范围拓展 | [`Livetranscoding.Region.size`](70083.md#Region-size) 中，`width` 和 `height` | 取值范围由 `(0.0, 1.0]` 拓展为 `[0.0, 1.0]`。 |
| 枚举值变化 | [`AudioRoute`](70083.md#audioroute) | `AUDIO_ROUTE_UNKNOWN`\->`AUDIO_ROUTE_DEFAULT` |
| 音频路由和发布订阅状态到音量类型的映射关系改变 | [`AudioScenarioType`](70083.md#audioscenariotype) | 最新的映射关系查看数据结构的文档。 |
| 成员变量变更 | [`FaceDetectionResult`](70083.md#facedetectionresult) | 新增成员变量：`frameTimestampUs` |
| ^^ | [`VideoCanvas`](70083.md#videocanvas) | - 删除以下变量： |\
||| 	 |\
||||\
||| roomId |\
||| uid |\
||| streamId |\
||| isScreen |\
||||\
||| - RENDER\_MODE\_Fill 变更为 RENDER\_MODE\_FILL |
| 枚举值增删 | [`AudioProcessorMethod`](70083.md#audioprocessormethod) | 新增枚举值：`AUDIO_FRAME_PROCESSOR_EAR_MONITOR(3)` |\
||
| 变量类型变更 | 空间音频功能中表示空间坐标的 [`position`](70083.md#position-2) 的 变量 `x`, `y`, `z` 类型由 `int` 更改为 `float`。 | 提升球面立体声渲染效果。 |
| 配置变更 | [`ChannelProfile`](70083.md#channelprofile) | 房间属性的默认值 `CHANNEL_PROFILE_COMMUNICATION(0)`，对应的由 `CHANNEL_PROFILE_CHAT_ROOM(6)` 变更为 `CHANNEL_PROFIEL_MEETING(16)`。 |
| 成员变量增减 | [`LiveTranscoding`](70083.md#livetranscoding) | 新增成员变量：`ClientMixParam` |


### 错误码变更

| **变更详情** | **错误码** | **说明** |
| --- | --- | --- |
| 枚举值增删 | [`ErrorCode`](70082.md#errorcode) | 新增枚举值：`ERROR_CODE_USER_ID_DIFFERENT = -1014` |
| ^^ | [`UserMessageSendResult`](70082.md#usermessagesendresult) | 新增枚举值：`USER_MESSAGE_SEND_RESULT_EXCEED_QPS = 5` |
| ^^ | [`RoomMessageSendResult`](70082.md#roommessagesendresult) | 新增枚举值：`ROOM_MESSAGE_SEND_RESULT_EXCEED_QPS = 5` |
| 枚举类增删 | [`PublicStreamErrorCode`](70082#publicstreamerrorcode) | [`onPushPublicStreamResult`](70081.md#IRTCVideoEventHandler-onpushpublicstreamresult) 和 [`onPlayPublicStreamResult`](70081.md#IRTCVideoEventHandler-onplaypublicstreamresult) 中的 `errorCode` 参数类型由 int 改为 `PublicStreamErrorCode` |\
|||


## 3.45.6
### 类型变更

以下表格中的类型发生了变化，你需要在工程文件中找到该类型，并根据变化调整相关处理逻辑：

| 变更详情 | 数据类型  | 备注 |
| --- | --- | --- |
| 枚举值增删 |[`AudioProcessorMethod`](70083.md#audioprocessormethod) | 新增屏幕共享音频的枚举值：`AUDIO_FRAME_PROCESSOR_SCREEN(4)` |

## 3.45.4

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 |  <div style="width: 220pt">方法</div>| <div style="width: 150pt">备注</div> |
| --- | --- | --- | --- | --- |
| 参数数据结构改动 | 音频管理 |[`public abstract void enableAudioPropertiesReport(AudioPropertiesConfig config);`](70080#RTCVideo-enableaudiopropertiesreport) | 数据结构中，新增参数：<li>[`AudioPropertiesMode`](70083.md#audiopropertiesmode)</li><li>[`AudioReportMode`](70083.md#audioreportmode)</li> |
| 方法行为变更| 高级功能 |[`public abstract void setEarMonitorMode(EarMonitorMode mode);`](70080.md#RTCVideo-setearmonitormode) |自适应启用硬件耳返|


### 类型变更

以下表格中的类型发生了变化，你需要在工程文件中找到该类型，并根据变化调整相关处理逻辑：

| 变更详情 | 数据类型  | 备注 |
| --- | --- | --- |
|成员变量增删 |[`AudioScenarioType`](70083.md#audioscenariotype) |新增高音质畅聊模式：`AUDIO_SCENARIO_HIGHQUALITY_CHAT` |
|枚举值增删 |[`AudioProcessorMethod`](70083.md#audioprocessormethod) |新增获取软件耳返音频：`AUDIO_FRAME_PROCESSOR_EAR_MONITOR(3)` |


## 3.45.2

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 |  <div style="width: 220pt">变动前方法</div> | <div style="width: 220pt">变动后方法</div> | <div style="width: 150pt">备注</div> |
| --- | --- | --- | --- | --- |
| 废弃原方法 | 音频处理 | `public abstract void muteAudioPlayback(MuteState muteState);` | [`public abstract void setPlaybackVolume(int volume);`](70080.md#RTCVideo-setplaybackvolume) | 设置远端用户音量为 0 即可停止播放本地收到的音频流 |


## 3.44

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 |  <div style="width: 210pt">变动前方法</div> | <div style="width: 210pt">变动后方法</div> | 备注 |
|---|---|---|---|---|

|合并、名称和参数变更 |音视频处理 |- `public abstract int initVirtualBackground(Context context, String licenseFile, String modelFile);`|[`public abstract int setBackgroundSticker(String modelPath, VirtualBackgroundSource source);`](70080.md#RTCVideo-setbackgroundsticker) | \
|||- `public abstract int enableVirtualBackground(VirtualBackgroundSource source);`\

|||- `public abstract int disableVirtualBackground();` |


## 3.43

该版本部分头文件名称发生变化，请参照下表在工程文件中进行调整：

|**平台** |**3.42** |**3.43** |
|---|---|---|---|
|Android |../IRTCRoom.java |../RTCRoom.java |
|^^|../RTCEngine.java |../RTCVideo.java |
|^^|../IRTCEngineEventHandler.java |../IRTCVideoEventHandler.java |


### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | <div style="width: 90pt">功能模块</div> | 变动前方法 | 变动后方法 | 备注 |
|---|---|---|---|---|
|基础类名变更 |所有模块 |public abstract class **RTCEngine** |public abstract class **RTCVideo** | |
|名称和参数变更 |多房间|`public abstract IRTCRoom createRoom(String roomId);` |[`public abstract RTCRoom createRTCRoom(String roomId);`](70080.md#RTCVideo-creatertcroom) |
|^^|引擎管理 |`public static synchronized RTCEngine createEngine(Context context, String appId, IRTCEngineEventHandler handler, Object eglContext, JSONObject parameters)` |[`public static synchronized RTCVideo createRTCVideo(Context context, String appId, IRTCVideoEventHandler handler, Object eglContext, JSONObject parameters)`](70080.md#RTCVideo-creatertcvideo) |
|^^|^^|`public static synchronized void destroyEngine(RTCEngine engine)` |[`public static synchronized void destroyRTCVideo(RTCVideo engine)`](70080.md#RTCVideo-destroyrtcvideo) |
|位置迁移，所属类型变更 |<span style="width:100"><li>房间管理</li><li>消息</li><li>屏幕共享</li><li>音视频传输</li><li>视频管理</li><li>音频管理</li><li>转推直播</li><li>公共流管理</li><li>多房间</li>|以下方法从 RTCVideo（原 RTCEngine）类下移除，使用 RTCRoom 类中的同名方法代替：<li>joinRoom</li><li>leaveRoom</li><li>pauseAllSubscribedStream</li><li>resumeAllSubscribedStream</li><li>updateToken</li><li>setUserVisibility</li><li>publishStream</li><li>unpublishStream</li><li>sendRoomMessage</li><li>sendRoomBinaryMessage</li><li>sendUserMessage</li><li>sendUserBinaryMessage</li><li>subscribeStream</li><li>unsubscribeStream</li><li>subscribeScreen</li><li>unsubscribeScreen</li><li>publishScreen</li><li>unpublishScreen</li><li>startForwardStreamToRooms</li><li>updateForwardStreamToRooms</li><li>stopForwardStreamToRooms</li><li>pauseForwardStreamToAllRooms</li><li>resumeForwardStreamToAllRooms</li><li>setRemoteVideoConfig</li><li>setMultiDeviceAVSync</li></span>||
|参数变更 |音频管理 |`public abstract void setRemoteAudioPlaybackVolume(String uid, int volume);` |[`public abstract void setRemoteAudioPlaybackVolume(String roomId, String uid, int volume);`](70080.md#RTCVideo-setremoteaudioplaybackvolume) | 新增 `roomId` 参数，且必填。 |


### 回调变更

以下表格中的回调发生了变化。你需要在工程文件中找到该回调，并进行相关修改：

| 变更详情 | <div style="width: 90pt">功能模块</div> | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
|基础类名变更 |所有模块 |public abstract class **IRTCEngineEventHandler** |public abstract class **IRTCVideoEventHandler** | |
|位置迁移，所属类型变更 |<li>引擎管理</li><li>房间管理</li><li>视频管理</li><li>音频管理</li><li>网络管理</li><li>数据统计</li><li>消息</li><li>音视频传输</li><li>公共流管理</li>|以下回调从 IRTCVideoEventHandler（原 IRTCEngineEventHandler）类下移除，使用 IRTCRoomEventHandler 类中的同名回调代替：<li>onroomstatechanged</li><li>onLeaveRoom</li><li>onRoomStats</li><li>onUserJoined</li><li>onUserLeave</li><li>onTokenWillExpire</li><li>onUserPublishStream</li><li>onUserUnPublishStream</li><li>onUserPublishScreen</li><li>onUserUnPublishScreen</li><li>onLocalStreamStats</li><li>onRemoteStreamStats</li><li>onRoomMessageReceived</li><li>onRoomBinaryMessageReceived</li><li>onUserMessageReceived</li><li>onUserBinaryMessageReceived</li><li>onUserMessageSendResult</li><li>onRoomMessageSendResult</li><li>onVideoStreamBanned</li><li>onAudioStreamBanned</li><li>onForwardStreamStateChanged</li><li>onForwardStreamEvent</li><li>onAVSyncStateChange</li>||
|参数变更 |音频管理 |`public void onUserStartAudioCapture(String uid)` |[`public void onUserStartAudioCapture(String roomId, String uid)`](70081.md#IRTCVideoEventHandler-onuserstartaudiocapture) |
|^^|^^|`public void onUserStopAudioCapture(String uid)` |[`public void onUserStopAudioCapture(String roomId, String uid)`](70081.md#IRTCVideoEventHandler-onuserstopaudiocapture) |
|^^|音视频传输 |`public void onUserStartVideoCapture(String uid)` |[`public void onUserStartVideoCapture(String roomId, String uid)`](70081.md#IRTCVideoEventHandler-onuserstartvideocapture) |
|^^|^^|`public void onUserStopVideoCapture(String uid)` |[`public void onUserStopVideoCapture(String roomId, String uid)`](70081.md#IRTCVideoEventHandler-onuserstopvideocapture) |
|^^|房间管理 |`public void onAudioFrameSendStateChanged(RtcUser user, FirstFrameSendState state)` |[`public void onAudioFrameSendStateChanged(String roomId, RtcUser user, FirstFrameSendState state)`](70081.md#IRTCVideoEventHandler-onaudioframesendstatechanged) |
|^^|^^|`public void onVideoFrameSendStateChanged(RtcUser user, FirstFrameSendState state)` |[`public void onVideoFrameSendStateChanged(String roomId, RtcUser user, FirstFrameSendState state)`](70081.md#IRTCVideoEventHandler-onvideoframesendstatechanged) |
|^^|^^|`public void onScreenVideoFrameSendStateChanged(RtcUser user, FirstFrameSendState state)` |[`public void onScreenVideoFrameSendStateChanged(String roomId, RtcUser user, FirstFrameSendState state)`](70081.md#IRTCVideoEventHandler-onscreenvideoframesendstatechanged) |
|^^|^^|`public void onAudioFramePlayStateChanged(RtcUser user, FirstFramePlayState state)` |[`public void onAudioFramePlayStateChanged(String roomId, RtcUser user, FirstFramePlayState state)`](70081.md#IRTCVideoEventHandler-onaudioframeplaystatechanged) |
|^^|^^|`public void onVideoFramePlayStateChanged(RtcUser user, FirstFramePlayState state)` |[`public void onVideoFramePlayStateChanged(String roomId, RtcUser user, FirstFramePlayState state)`](70081.md#IRTCVideoEventHandler-onvideoframeplaystatechanged) |
|^^|^^|`public void onScreenVideoFramePlayStateChanged(RtcUser user, FirstFramePlayState state)` |[`public void onScreenVideoFramePlayStateChanged(String roomId, RtcUser user, FirstFramePlayState state)`](70081.md#IRTCVideoEventHandler-onscreenvideoframeplaystatechanged)|
|^^|公共流管理 |`public void onPushPublicStreamResult(String publicStreamId, int errorCode)` |[`public void onPushPublicStreamResult(String roomId, String publicStreamId, int error)`](70081.md#IRTCVideoEventHandler-onpushpublicstreamresult) |


### 类型变更

以下表格中的类型发生了变化，你需要在工程文件中找到该类型，并根据变化调整相关处理逻辑：

| 变更详情 | 数据类型  | 备注 |
| --- | --- | --- |
|成员变量增删 |[`VideoEncoderConfig`](70083.md#videoencoderconfig) |删除成员变量：`ScaleMode` |
|枚举值增删 |[`ConnectionState`](70083.md#connectionstate) |增加枚举值：`CONNECTION_STATE_FAILED(7)` |


### 错误码变更

以下表格中的错误码发生了变化，你需要进行相应的处理：

| 变更详情 | 错误码 | 备注 |
| --- | --- | --- |
|枚举值增删 |[`ErrorCode`](70082.md#errorcode) |新增枚举值：`-1084` |


## 3.42

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法 | 变动后方法 | 备注 |
|---|---|---|---|---|
| 基础类名变更 | 所有模块 | public abstract class **IRTCRoom** | public abstract class **RTCRoom** |  |
|位置迁移，所属类型变更|多房间|以下方法从 RTCRoom（原 IRTCRoom）类下移除，使用 RTCEngine 类中的同名方法代替：<li>setRemoteVideoCanvas</li><li>startLiveTranscoding</li><li>stopLiveTranscoding</li><li>updateLiveTranscoding</li><li>setRemoteAudioPlaybackVolume</li><li>startPushPublicStream</li><li>stopPushPublicStream</li><li>updatePublicStreamParam</li>|| 由于新方法变更为从引擎类上调用，因此增加了 roomId 相关的字段，且均为必填字段。 |
|参数变更|音频路由|`public abstract int setAudioRoute(AudioRoute audioRouteDevice);`|[`public abstract int setAudioRoute(AudioRoute audioRoute);`](70080.md#RTCEngine-setaudioroute)| |
|^^|消息|`public abstract long sendUserMessage(String userId, String messageStr);`|[`public abstract long sendUserMessage(String userId, String messageStr, MessageConfig config);`](70080.md#RTCEngine-sendusermessage)| |
|^^|^^|`public abstract long sendUserBinaryMessage(String userId, byte[] buffer);`|[`public abstract long sendUserBinaryMessage(String userId, byte[] buffer, MessageConfig config);`](70080.md#RTCEngine-senduserbinarymessage)| |
|^^|^^|`public abstract void sendRoomMessage(String messageStr);`|[`public abstract long sendRoomMessage(String messageStr);`](70080.md#RTCEngine-sendroommessage)| |
|^^|^^|`public abstract void sendRoomBinaryMessage(byte[] buffer);`|[`public abstract long sendRoomBinaryMessage(byte[] buffer);`](70080.md#RTCEngine-sendroombinarymessage)| |
|^^|^^|`public abstract long sendUserMessageOutsideRoom(String uid, String message);`|[`public abstract long sendUserMessageOutsideRoom(String uid, String message, MessageConfig config);`](70080.md#RTCEngine-sendusermessageoutsideroom)| |
|^^|^^|`public abstract long sendUserBinaryMessageOutsideRoom(String uid, byte[] buffer);`|[`public abstract long sendUserBinaryMessageOutsideRoom(String uid, byte[] buffer, MessageConfig config);`](70080.md#RTCEngine-senduserbinarymessageoutsideroom)| |
|方法重构|自定义音频处理|`public abstract int registerLocalAudioProcessor(IAudioProcessor audioProcessor, AudioFormat audioFormat);`|<li>[`public abstract int registerAudioProcessor(IAudioFrameProcessor processor);`](70080.md#RTCEngine-registeraudioprocessor)</li><li>[`public abstract void enableAudioProcessor(AudioProcessorMethod method, AudioFormat format);`](70080.md#RTCEngine-enableaudioprocessor)</li><li>[`public abstract void disableAudioProcessor(AudioProcessorMethod method);`](70080.md#RTCEngine-disableaudioprocessor)</li>| |


### 回调变更

以下表格中的回调发生了变化。你需要在工程文件中找到该回调，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
|位置迁移，所属类型变更|多房间|以下回调从 IRTCRoomEventHandler 类下移除，使用 IRTCEngineEventHandler 类中的同名回调代替：<li>onUserStartVideoCapture</li><li>onUserStopVideoCapture</li><li>onUserStartAudioCapture</li><li>onUserStopAudioCapture</li><li>onSimulcastSubscribeFallback</li><li>onLocalAudioStateChanged</li><li>onRemoteAudioStateChanged</li><li>onLocalVideoStateChanged</li><li>onRemoteVideoStateChanged</li><li>onFirstRemoteVideoFrameRendered</li><li>onFirstRemoteVideoFrameDecoded</li><li>onFirstLocalVideoFrameCaptured</li><li>onLocalVideoSizeChanged</li><li>onRemoteVideoSizeChanged</li><li>onFirstLocalAudioFrame</li><li>onFirstRemoteAudioFrame</li><li>onAudioFrameSendStateChanged</li><li>onVideoFrameSendStateChanged</li><li>onScreenVideoFrameSendStateChanged</li><li>onAudioFramePlayStateChanged</li><li>onVideoFramePlayStateChanged</li><li>onScreenVideoFramePlayStateChanged</li><li>onPushPublicStreamResult</li>|| |
|名称和参数变更|多房间|`public abstract void onRtcStats(IRTCEngineEventHandler.RTCRoomStats stats);`|[`public void onRoomStats(RTCRoomStats stats) {}`](70081.md#IRTCEngineEventHandler-onroomstats)| |
|参数变更|音频路由|`public void onAudioRouteChanged(AudioRoute device) {}`|[`public void onAudioRouteChanged(AudioRoute route) {}`](70081.md#IRTCEngineEventHandler-onaudioroutechanged)| |
|回调重构|自定义音频处理|`public interface IAudioProcessor {int processAudioFrame(IAudioFrame audioFrame);}`|`public interface IAudioFrameProcessor{` <br> [`int onProcessRecordAudioFrame(IAudioFrame audioFrame);`](70081.md#IAudioFrameProcessor-onprocessrecordaudioframe) <br> [`int onProcesslaybackAudioFrame(IAudioFrame audioFrame);`](70081.md#IAudioFrameProcessor-onprocessplaybackaudioframe) <br> [`int onProcessRemoteUserAudioFrame(RemoteStreamKey stream_info, IAudioFrame audioFrame);} `](70081.md#IAudioFrameProcessor-onprocessremoteuseraudioframe)| |


### 类型变更

以下表格中的类型发生了变化，你需要在工程文件中找到该类型，并根据变化调整相关处理逻辑：

| 变更详情 | 数据类型  | 备注 |
| --- | --- | --- |
|位置迁移，所属类型变更 |以下数据类型从 RTCEngine 类下移出：<li>AudioProfileType</li><li>AudioScenarioType</li><li>ChannelProfile</li><li>ConnectionState</li><li>MediaStreamType</li><li>PauseResumeControlMediaType</li><li>ProblemFeedback</li><li>PublishFallbackOption</li><li>RangeAudioMode</li><li>RecordingType</li><li>RemoteUserPriority</li><li>RtcMode</li><li>SubscribeFallbackOptions</li><li>SubscribeMediaType</li><li>SubscribeMode</li><li>TorchState</li><li>VoiceChangerType</li><li>VoiceReverbType</li> <br>以下数据类型从 IRTCEngineEventHandler 类下移出<li>AudioVolumeInfo</li><li>ConnectionState</li><li>ErrorCode</li><li>FallbackOrRecoverReason</li><li>FirstFramePlayState</li><li>FirstFrameSendState</li><li>LocalAudioStats</li><li>LocalStreamStats</li><li>LocalVideoStats</li><li>LocalVideoStreamError</li><li>LocalVideoStreamState</li><li>LoginErrorCode</li><li>MediaDeviceError</li><li>MediaDeviceState</li><li>MediaDeviceType</li><li>MediaDeviceWarning</li><li>NetworkDetectionLinkType</li><li>NetworkDetectionStartReturn</li><li>NetworkDetectionStopReason</li><li>NetworkQuality</li><li>NetworkQualityStats</li><li>PerformanceAlarmMode</li><li>PerformanceAlarmReason</li><li>RecordingErrorCode</li><li>RecordingState</li><li>RemoteAudioStats</li><li>RemoteStreamStats</li><li>RemoteStreamSwitch</li><li>RemoteVideoState</li><li>RemoteVideoStateChangeReason</li><li>RemoteVideoStats</li><li>RoomMessageSendResult</li><li>RTCRoomStats</li><li>RtcUser</li><li>SourceWantedData</li><li>StreamRemoveReason</li><li>TranscodingError</li><li>USER\_ONLINE\_STATUS（改为 UserOnlineStatus）</li><li>WarningCode</li> | |

|枚举值增删 |`ChannelProfile` |增加以下枚举值：\
|||- `CHANNEL_PROFILE_CHAT(5)`\
|||- `CHANNEL_PROFILE_CHAT_ROOM(6)`\
|||- `CHANNEL_PROFILE_LW_TOGETHER(7)`\
|||- `CHANNEL_PROFILE_GAME_HD(8)`\
|||- `CHANNEL_PROFILE_CO_HOST(9)`\
|||- `CHANNEL_PROFILE_INTERACTIVE_PODCAST(10)`\
|||- `CHANNEL_PROFILE_KTV(11)`\
|||- `CHANNEL_PROFILE_CHORUS(12)`\
|||- `CHANNEL_PROFIEL_VR_CHAT(13)`\
|||- `CHANNEL_PROFILE_GAME_STREAMING(14)`\
|||- `CHANNEL_PROFILE_LAN_LIVE_STREAMING(15)`\
|||- `CHANNEL_PROFIEL_MEETING(16)`\
|||- `CHANNEL_PROFILE_MEETING_ROOM(17)`\
|||- `CHANNEL_PROFILE_CLASSROOM(18)`\
|||删除了 `CHANNEL_PROFILE_LIVE_BROADCASTING(1)`，建议根据实际业务情况，替换为以下模式：\
|||- `CHANNEL_PROFILE_CHAT_ROOM(6)`\
|||- `CHANNEL_PROFILE_CO_HOST(9)`\
|||- `CHANNEL_PROFILE_INTERACTIVE_PODCAST(10)`\
|||- `CHANNEL_PROFILE_KTV(11)`\

|||- `CHANNEL_PROFILE_CHORUS(12)` |
|枚举值增删 |[`AudioProfileType`](70083.md#audioprofiletype) |增加以下枚举值：<li>`AUDIO_PROFILE_STANDARD_STEREO(4)`</li><li>`AUDIO_PROFILE_HD_MONO(5)`</li> |
|成员变量增删 |[`LocalVideoStats`](70083.md#localvideostats) |删除以下成员变量：<li>`targetKBitrate`</li><li>`public int targetFrameRate`</li> |
|成员变量增删 |[`RTCRoomStats`](70083.md#rtcroomstats) |增加以下成员变量值：<li>`txScreenKBitRate`</li><li>`rxScreenKBitRate`</li> |
|枚举值增删 |[`MediaDeviceWarning`](70083.md#mediadevicewarning) |增加以下枚举值：<li>`MEDIA_DEVICE_WARNING_SET_AUDIO_ROUTE_INVALID_SCENARIO = 20`</li><li>`MEDIA_DEVICE_WARNING_SET_AUDIO_ROUTE_NOT_EXISTS = 21`</li><li>`MEDIA_DEVICE_WARNING_SET_AUDIO_ROUTE_FAILED_BY_PRIORITY = 22`</li><li>`MEDIA_DEVICE_WARNING_SET_AUDIO_ROUTE_NOT_VOIP_MODE = 23`</li><li>`MEDIA_DEVICE_WARNING_SET_AUDIO_ROUTE_DEVICE_NOT_START = 24`</li> |
|枚举值含义变更 |[`AudioScenarioType`](70083.md#audioscenariotype) |枚举值对应的语音模式决策逻辑发生变化，本地是否播放不再是决策因素，只取决于麦克风是否开启|


### 错误码变更

以下表格中的错误码发生了变化，你需要进行相应的处理：

| 变更详情 | 错误码 | 备注 |
| --- | --- | --- |
| 枚举值增删 | [`WarningCode`](70082.md#warningcode) | 新增枚举值：`-2014` |


## 3.41

### 回调变更

以下表格中的回调发生了变化。你需要在工程文件中找到该回调，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 合并或拆分 | 房间管理 | `public void onJoinRoomResult(String roomId, String uid, int errorCode, int joinType, int elapsed) {}` | <li>[`public void onRoomStateChanged(String roomId, String uid, int state, String extraInfo) {}`](70081.md#onroomstatechanged)</li><li>[`public void onStreamStateChanged(String roomId, String uid, int state, String extraInfo) {}`](70081.md#onstreamstatechanged) |
| 合并或拆分 | 多房间 | <li>`public abstract void onJoinRoomResult(String roomId, String uid, int errorCode, int joinType, int elapsed);`</li><li>`public abstract void onRoomWarning(int warn);`</li><li>`public abstract void onRoomError(int err);` | <li>[`public abstract void onRoomStateChanged(String roomId, String uid, int state, String extraInfo);`](70081.md#onroomstatechanged-2)</li><li>[`public abstract void onStreamStateChanged(String roomId, String uid, int state, String extraInfo);`](70081.md#onstreamstatechanged-2) |



## 3.40

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法 | 变动后方法 | 备注 |
|---|---|---|---|---|
|名称和参数变更 | 位置语音 |`public abstract IPositionAudioRender getPositionAudioRender();` |[`public abstract ISpatialAudio getSpatialAudio();`](70080.md#IRTCRoom-getspatialaudio) | 接口由 RTCEngine 类移动至 IRTCRoom 类 |
|名称变更 | 音频管理 | `void enableAudioSpatialRender(boolean enable);` |[`void enableSpatialAudio(boolean enable);`](70080.md#ISpatialAudio-enablespatialaudio) | |
| 原接口废弃，使用新接口代替 | 音频管理 | <li>`void enableExternalAudioDevice(AudioFormat recordingFormat, AudioFormat playbackFormat);`</li><li>`void disableExternalAudioDevice();` | <li>[`int setAudioSourceType (AudioSourceType type);`](70080.md#RTCEngine-setaudiosourcetype)</li><li>[`int setAudioRenderType (AudioRenderType type);`](70080.md#RTCEngine-setaudiorendertype) |
| 参数变更 | 转推直播 | `public int getMixType() { return mixType; }` | [`public ByteRTCStreamMixingType getMixType() { return mixType; }`](70083.md#LiveTranscoding-getmixtype) | 修改可预定义的参数为枚举类型 |
|^^|^^| `public void setMixType(int mixType) { this.mixType = mixType; }` |[`public void setMixType(ByteRTCStreamMixingType mixType) { this.mixType = mixType; }`](70083.md#LiveTranscoding-setmixtype) |^^|
|^^|^^|`public Region renderMode(int renderMode) { this.renderMode = renderMode; return this; }` |[`public Region renderMode(TranscoderRenderMode renderMode) { this.renderMode = renderMode; return this; }`](70083.md#Region-rendermode) |^^|
|^^|^^|`public Region contentControl(int contentControl) { this.contentControl = contentControl; return this; }` |[`public Region contentControl(TranscoderContentControlType contentControl) { this.contentControl = contentControl; return this; }`](70083.md#Region-contentcontrol) |^^|


### 类型变更

以下表格中的类型发生了变化，你需要在工程文件中找到该类型，并根据变化调整相关处理逻辑：

| 变更详情 | 数据类型  | 备注 |
| --- | --- | --- |
| 枚举值增删 | [`AACProfile`](70083.md#aacprofile) | 删除枚举值：`AAC_PROFILE_MAIN("MAIN")` |
| 类型增减 | [`TranscoderRenderMode`](70083.md#transcoderrendermode) | 新增 |
| 类型增减 | [`TranscoderContentControlType`](70083.md#transcodercontentcontroltype) | 新增 |
| 成员函数变更 | [`Region`](70083.md#region) | 成员函数`renderMode`的传入参数变更为枚举类型 |
| 成员函数变更 | [`Region`](70083.md#region) | 成员函数`contentControl`的传入参数变更为枚举类型 |
| 类型名称变化 | [`AudioRoute`](70083.md#audioroute) | 类型名由`AudioRouteDevice`修改为 [`AudioRoute`](70083.md#audioroute) |


### 错误码变更

以下表格中的错误码发生了变化，你需要进行相应的处理：

| 变更详情 | 错误码 | 备注 |
| --- | --- | --- |
| 枚举值增删 | [`ErrorCode`](70082.md#errorcode) | 新增枚举值：`-1083` |


## 3.39

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 返回值变更 | 实时消息 | `void login(String token, String uid)` | [`long login(String token, String uid)`](70080.md#RTCEngine-login) | --- |

|API 行为变更 |订阅媒体流|SDK 在每条远端流属性中维护订阅关系。如果该流被移除，订阅关系也将取消 |SDK 在房间属性中维护订阅关系列表。订阅关系将在用户退房后才会取消。 |\--- \
||[subscribeStream](70080.md#RTCRoom-subscribestream)\

||[unsubscribeStream](70080.md#RTCRoom-unsubscribestream) |\
||[subscribeScreen](70080.md#RTCRoom-subscribescreen) |\

||[unsubscribeScreen](70080.md#RTCRoom-unsubscribescreen)
    
### 回调变更

以下表格中的回调发生了变化。你需要在工程文件中找到该回调，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 参数变化 | 实时消息 | `public void onServerMessageSendResult(long msgid, int error) {}` | [`public void onServerMessageSendResult(long msgid, int error, ByteBuffer message) {}`](70081.md#IRTCEngineEventHandler-onservermessagesendresult) |  |
| 参数变化 | 转推直播 | `void onStreamMixingEvent(ByteRTCStreamMixingEvent eventType, String taskId, int error, ByteRTCStreamMixingType mixType);` | [`void onStreamMixingEvent(ByteRTCStreamMixingEvent eventType, String taskId,` `ByteRTCTranscoderErrorCode` `error, ByteRTCStreamMixingType mixType);`](70081.md#ILiveTranscodingObserver-onstreammixingevent) |
| 参数变化 | 转推直播 | `public void onRoomMessageSendResult(long msgid, int error)` | [`public void onRoomMessageSendResult(long msgid, RoomMessageSendResult error)`](70081.md#IRTCRoomEventHandler-onroommessagesendresult) |



### 错误码变更
以下表格中的错误码发生了变化，你需要进行相应的处理：

| 变更详情 | 错误码 | 备注 |
| --- | --- | --- |
| 枚举类新增 | [`TranscodingError`](70082.md#transcodingerror) | |



## 3.38

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 替换 | 音频路由设置 | `public abstract int setAudioPlaybackDevice(AudioPlaybackDevice audioPlaybackDevice)` | [`public abstract int setAudioRoute(AudioRouteDevice audioRouteDevice);`](70080.md#RTCEngine-setaudioroute) |  |

    
### 回调变更

以下表格中的回调发生了变化。你需要在工程文件中找到该回调，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 替换 | 音频路由设置 | `public void onAudioPlaybackDeviceChanged(AudioPlaybackDevice device){}` | [`public void onAudioRouteChanged(AudioRouteDevice device){}`](70081.md#IRTCEngineEventHandler-onaudioroutechanged) |  |


### 类型变更

以下表格中的类型发生了变化，你需要在工程文件中找到该类型，并根据变化调整相关处理逻辑：

| 变更详情 | 数据类型  | 备注 |
| --- | --- | --- |
| 成员变量增删 | [`SubscribeConfig`](70083.md#subscribeconfig) | 新增成员变量：`framerate` |
| 成员函数参数变更 | [`RemoteVideoConfig`](70083.md#remotevideoconfig) | 成员函数 `RemoteVideoConfig` 中参数 `ration` 变为 `framerate`，由输入与原始帧率的比例变为输入期望订阅的最大帧率 |
| 枚举值增删 | [`AudioMixingError`](70083.md#audiomixingerror) | 新增枚举值：`AUDIO_MIXING_ERROR_INVALID_PLAYBACK_SPEED` |
|枚举值增删|[`MediaDeviceState`](70083.md#mediadevicestate)|新增枚举值：`MEDIA_DEVICE_STATE_INTERRUPTION_BEGAN`，表示媒体设备采集暂停，等待自动恢复|
|枚举值增删|[`MediaDeviceState`](70083.md#mediadevicestate)|新增枚举值：`MEDIA_DEVICE_STATE_INTERRUPTION_ENDED`，表示媒体设备采集已自动恢复|


### 错误码变更
以下表格中的错误码发生了变化，你需要进行相应的处理：

| 变更详情 | 错误码 | 备注 |
| --- | --- | --- |
| 枚举值增删 | [`ErrorCode`](70082.md#errorcode) | 新增错误码：`ERROR_CODE_TOKEN_EXPIRED`，表示用户因 Token 过期被踢出房间 |
| 枚举值增删 | [`ErrorCode`](70082#errorcode) | 新增枚举值：`ERROR_CODE_UPDATE_TOKEN_WITH_INVALID_TOKEN`，表示调用 [updateToken](70080.md#updatetoken) 使用的 Token 无效 |


## 3.37

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 合并 | 音频数据回调 | <li>`public abstract boolean setRecordingAudioFrameParameters(int sampleRate, int channels);`</li><li>`public abstract boolean setPlaybackAudioFrameParameters(int sampleRate, int channels);`</li><li>`public abstract boolean setMixedAudioFrameParameters(int sampleRate, int channels);` | [`public abstract void enableAudioFrameCallback(AudioFrameCallbackMethod method, AudioFormat format);`](70080.md#RTCEngine-enableaudioframecallback) | 在`format`中设置回调的音频数据类型 |
| 参数增加 | 本地录制 | `public abstract int startFileRecording(StreamIndex type, RecordingConfig config)` | [`public abstract int startFileRecording(StreamIndex type, RecordingConfig config, RecordingType recordingType);`](70080.md#RTCEngine-startfilerecording) | |


    
### 回调变更

以下表格中的回调发生了变化。你需要在工程文件中找到该回调，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 拆分 | 引擎管理 | `public void onMediaDeviceStateChanged(String device_id, int device_type, int device_state, int device_error) {}` | <li>[`public void onAudioDeviceStateChanged(String device_id, AudioDeviceType device_type, int device_state, int device_error) {}`](70081.md#IRTCEngineEventHandler-onaudiodevicestatechanged)</li><li>[`public void onVideoDeviceStateChanged(String device_id, VideoDeviceType device_type, int device_state, int device_error) {}`](70081.md#IRTCEngineEventHandler-onvideodevicestatechanged)</li> | 媒体设备状态回调拆分成音频和视频设备状态回调 | |
| 拆分 | 引擎管理 | `public void onMediaDeviceWarning(String device_id, int device_type, int device_warning) {}` | <li>[`public void onAudioDeviceWarning(String device_id, AudioDeviceType device_type, int device_warning) {}`](70081.md#IRTCEngineEventHandler-onaudiodevicewarning)</li><li>[`public void onVideoDeviceWarning(String device_id, VideoDeviceType device_type, int device_warning) {}`](70081.md#IRTCEngineEventHandler-onvideodevicewarning)</li> | 媒体设备警告回调拆分成音频和视频设备警告回调 | |
| 参数变化 | 音频数据回调 | `void onRecordAudioFrame(AudioFrame audioFrame);` | [`void onRecordAudioFrame(IAudioFrame audioFrame);`](70081.md#IAudioFrameObserver-onrecordaudioframe) | `IAudioFrame`与`AudioFrame`之间的相互转换，参看示例代码[转换`buffer`与`getDataBuffer`](#1)、[转换`samples`与`data_size()`](#2)。 |
| 参数变化 | 音频数据回调 | `void onPlaybackAudioFrame(AudioFrame audioFrame);` | [`void onPlaybackAudioFrame(IAudioFrame audioFrame);`](70081.md#IAudioFrameObserver-onplaybackaudioframe) | ^^ |
| 参数变化 | 音频数据回调 | `void onMixedAudioFrame(AudioFrame audioFrame);` | [`void onMixedAudioFrame(IAudioFrame audioFrame);`](70081.md#IAudioFrameObserver-onmixedaudioframe) | ^^ |

<span id="1"></span>转换`buffer`与`getDataBuffer`，示例代码：
```
public byte[] toByteArray(ByteBuffer byteBuffer){
    if(byteBuffer == null){
        return null;
    }
    if(byteBuffer.isDirect()){
        // 如果 byteBuffer 是 Direct 的，则必须拷贝一次
        byte[] bytearray = new byte[byteBuffer.remaining()];
        byteBuffer.get(bytearray);
        return bytearray;
    }
    // 如果 byteBuffer 不是 Direct 的，则可以不拷贝直接返回引用
    return byteBuffer.array();
}

public ByteBuffer toByteBuffer(byte[] array){
    if(array == null){
        return null;
    }
    return ByteBuffer.wrap(array);
}
```

<span id="2"></span>转换`samples`与`data_size()`，示例代码：
```
samples = data_size() / (channel() * 2)
```

### 类型变更

以下表格中的类型发生了变化，你需要在工程文件中找到该类型，并根据变化调整相关处理逻辑：

| 变更详情 | 数据类型  | 备注 |
| --- | --- | --- |
| 类型增减 | [`AudioFrameCallbackMethod`](70083.md#audioframecallbackmethod) | 新增 |


## 3.36

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 名称变化 | 屏幕共享 | `public abstract int stopScreenVideoCapture();` | [`public abstract void stopScreenCapture();`](70080.md#RTCEngine-stopscreencapture) |
| 名称变化 | 音视频回退 | `public abstract int setRemoteSubscribeFallbackOption(SubscribeFallbackOptions option);` | [`public abstract int setSubscribeFallbackOption(SubscribeFallbackOptions option);`](70080.md#RTCEngine-setsubscribefallbackoption) |
| 参数变化 | 屏幕共享 | <li>`public abstract int publishScreen();`</li><li>`public abstract int unpublishScreen();`</li> | <li>[`public abstract int publishScreen(MediaStreamType type);`](70080.md#RTCEngine-publishscreen)</li><li>[`public abstract int unpublishScreen(MediaStreamType type);`](70080.md#RTCEngine-unpublishscreen)</li> | 新增参数，设置发布/取消发布的媒体类型 |
| 参数变化 | 转推直播/多房间 | <li>`public abstract void startLiveTranscoding(LiveTranscoding liveTranscode, ILiveTranscodingObserver observer);`</li><li>`public abstract void stopLiveTranscoding();`</li><li>`public abstract void updateLiveTranscoding(LiveTranscoding transcoding);`</li> | <li>[`public abstract void startLiveTranscoding(String taskId, LiveTranscoding liveTranscode, ILiveTranscodingObserver observer);`](70080.md#RTCEngine-startlivetranscoding)</li><li>[`public abstract void stopLiveTranscoding(String taskId);`](70080.md#RTCEngine-stoplivetranscoding)</li><li>[`public abstract void updateLiveTranscoding(String taskId, LiveTranscoding transcoding);`](70080.md#RTCEngine-updatelivetranscoding)</li> | 新增参数，设置转推直播任务 ID |
| 参数变化 | 多房间 | <li>`public abstract void publishScreen();`</li><li>`public abstract void unpublishScreen();`</li> | <li>[`public abstract void publishScreen(RTCEngine.MediaStreamType type);`](70080.md#IRTCRoom-publishscreen)</li><li>[`public abstract void unpublishScreen(RTCEngine.MediaStreamType type);`](70080.md#IRTCRoom-unpublishscreen)</li> | 新增参数，设置发布/取消发布的媒体类型 |
| 名称和参数均变化 | 多房间 | <li>`public abstract void publish();`</li><li>`public abstract void unpublish();`</li> | <li>[`public abstract void publishStream(RTCEngine.MediaStreamType type);`](70080.md#IRTCRoom-publishstream)</li><li>[`public abstract void unpublishStream(RTCEngine.MediaStreamType type);`](70080.md#IRTCRoom-unpublishstream)</li> | 
| 名称和参数均变化 | 屏幕共享 | `public abstract int startScreenVideoCapture(Intent mediaProjectionResultData);` | [`public abstract void startScreenCapture(ScreenMediaType type, Intent mediaProjectionResultData);`](70080.md#RTCEngine-startscreencapture) |
| 合并 | 房间管理/媒体流管理 | <li>`public abstract int publish();`</li><li>`public abstract int unpublish();`</li><li>`public abstract void muteLocalAudio(MuteState muteState);`</li><li>`public abstract void muteLocalVideo(MuteState muteState);`</li> | <li>[`public abstract int publishStream(MediaStreamType type);`](70080.md#RTCEngine-publishstream)</li><li>[`public abstract int unpublishStream(MediaStreamType type);`](70080.md#RTCEngine-unpublishstream)</li> | 新版本中新增独立的接口单独控制摄像头/麦克风采集的音频/视频的发布/取消发布 |
| 拆分 | 房间管理 |`public abstract void subscribeUserStream(String uid, StreamIndex streamType, SubscribeMediaType mediaType, SubscribeVideoConfig subscribeVideoConfig);` | <li>[`public abstract void subscribeStream(String uid, MediaStreamType type);`](70080.md#RTCEngine-subscribestream)</li><li>[`public abstract void unsubscribeStream(String uid, MediaStreamType type);`](70080.md#RTCEngine-unsubscribestream)</li><li>[`public abstract void subscribeScreen(String uid, MediaStreamType type);`](70080.md#RTCEngine-subscribescreen)</li><li>[`public abstract void unsubscribeScreen(String uid, MediaStreamType type);`](70080.md#RTCEngine-unsubscribescreen)</li> | 单房间模式下，解耦摄像头/麦克风采集的媒体流与屏幕共享媒体流的订阅/取消订阅 |
| 拆分 | 多房间 | `public abstract void subscribeUserStream(String uid, StreamIndex streamType, RTCEngine.SubscribeMediaType mediaType, SubscribeVideoConfig subscribeVideoConfig);` | <li>[`public abstract void subscribeStream(String uid, RTCEngine.MediaStreamType type);`](70080.md#IRTCRoom-subscribestream)</li><li>[`public abstract void unsubscribeStream(String uid, RTCEngine.MediaStreamType type);`](70080.md#IRTCRoom-unsubscribestream)</li><li>[`public abstract void subscribeScreen(String uid, RTCEngine.MediaStreamType type);`](70080.md#IRTCRoom-subscribescreen)</li><li>[`public abstract void unsubscribeScreen(String uid, RTCEngine.MediaStreamType type);`](70080.md#IRTCRoom-unsubscribescreen)</li> | 多房间模式下，解耦摄像头/麦克风采集的媒体流与屏幕共享媒体流的订阅/取消订阅 |
| 拆分 | 视频管理 | `public abstract int setVideoEncoderConfig(List<VideoStreamDescription> videoStreamDescriptions);` | <li>[`public abstract int setVideoEncoderConfig(VideoEncoderConfig[] channel_solutions);`](70080.md#RTCEngine-setvideoencoderconfig-2)</li><li>[`public abstract int setScreenVideoEncoderConfig(VideoEncoderConfig screen_solution);`](70080.md#RTCEngine-setscreenvideoencoderconfig) | 使用独立的接口分别设置摄像头视频流和屏幕视频流的发布参数 |


### 回调变更

以下表格中的回调发生了变化。你需要在工程文件中找到该回调，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 参数变化 | 房间管理 | <li>`public void IRTCEngineEventHandler.onUserLeave(String uid, int reason)`</li><li>`public abstract IRTCRoomEventHandler.onUserLeave(String uid, int reason)`</li> | <li>[`public void IRTCEngineEventHandler.onUserLeave(String uid, int reason)`](70081.md#IRTCEngineEventHandler-onuserleave)</li><li>[`public abstract IRTCRoomEventHandler.onUserLeave(String uid, int reason)`](70081.md#IRTCRoomEventHandler-onuserleave)</li> | `reason` 参数变化 |
| 合并或拆分 | 房间管理 | <li>`public void onStreamAdd(RTCStream stream) {}`</li><li>`public void onStreamRemove(RTCStream stream, StreamRemoveReason reason) {}`</li><li>`public void onUserMuteAudio(String uid, MuteState muteState) {}`</li><li>`public void onUserMuteVideo(String uid, MuteState muteState) {}`</li> | <li>[`public void onUserPublishStream(String uid, RTCEngine.MediaStreamType type) {}`](70081.md#IRTCEngineEventHandler-onuserpublishstream)</li><li>[`public void onUserUnPublishStream(String uid, RTCEngine.MediaStreamType type,StreamRemoveReason reason) {}`](70081.md#IRTCEngineEventHandler-onuserunpublishstream)</li><li>[`public void onUserPublishScreen(String uid, RTCEngine.MediaStreamType type) {}`](70081.md#IRTCEngineEventHandler-onuserpublishscreen)</li><li>[`public void onUserUnPublishScreen(String uid, RTCEngine.MediaStreamType type,StreamRemoveReason reason) {}`](70081.md#IRTCEngineEventHandler-onuserunpublishscreen)</li> | 单房间模式下，解耦新增或移除摄像头/麦克风采集的媒体流与新增屏幕共享媒体流的回调，同时去除旧版本回调在功能上的重合 |
| 合并或拆分 | 多房间 | <li>`public abstract void onStreamAdd(RTCStream stream);`</li><li>`public abstract void onStreamRemove(RTCStream stream, IRTCEngineEventHandler.StreamRemoveReason reason);`</li><li>`public abstract void onUserMuteAudio(String uid, MuteState muteState);`</li><li>`public abstract void onUserMuteVideo(String uid, MuteState muteState);`</li> | <li>[`public abstract void onUserPublishStream(String uid, RTCEngine.MediaStreamType type);`](70081.md#IRTCRoomEventHandler-onuserpublishstream)</li><li>[`public abstract void onUserPublishScreen(String uid, RTCEngine.MediaStreamType type);`](70081.md#IRTCRoomEventHandler-onuserpublishscreen)</li><li>[`public abstract void onUserUnPublishStream(String uid, RTCEngine.MediaStreamType type, IRTCEngineEventHandler.StreamRemoveReason reason) ;`](70081.md#IRTCRoomEventHandler-onuserunpublishstream)</li><li>[`public abstract void onUserUnPublishScreen(String uid, RTCEngine.MediaStreamType type, IRTCEngineEventHandler.StreamRemoveReason reason);`](70081.md#IRTCRoomEventHandler-onuserpublishscreen)</li> | 多房间模式下，解耦新增或移除摄像头/麦克风采集的媒体流与新增屏幕共享媒体流的回调，同时去除旧版本回调在功能上的重合 |
| 删除 | 转推直播 | `public void onLiveTranscodingResult(String url, int error) {}` | / |


### 类型变更

以下表格中的类型发生了变化，你需要在工程文件中找到该类型，并根据变化调整相关处理逻辑：

| 变更详情 | 数据类型  | 备注 |
| --- | --- | --- |
| 枚举类增减 | `ScreenMediaType` | 新增枚举类 |
| 成员变量变化 | [`MediaDeviceType`](70083.md#mediadevicetype) | 新增成员变量：`MEDIA_DEVICE_TYPE_SCREEN_VIDEO_CAPTURE_DEVICE` |
| 成员变量变化 | [LocalStreamStats](70083#localstreamstats) 和 [RemoteStreamStats](70083#remotestreamstats) | `txQuality` 和 `rxQuality` 成员变量移动到了新增类型 [NetworkQualityStats](70083#networkqualitystats) 中，通过 [onNetworkQuality](70081.md#onnetworkquality) 回调获取 |
| 成员变量变化 | [`RTCRoomConfig`](70083.md#rtcroomconfig) | 新增 `remoteVideoConfig` |
| 成员变量变化 | [`MultiRoomConfig`](70083.md#multiroomconfig)| 新增 `remoteVideoConfig` |
| 成员变量变化 | [`AudioPropertiesInfo`](70083.md#audiopropertiesinfo) | 成员变量 `volume` 拆分为 `linearVolume` 和 `nonlinearVolume` |


## 3.35

### 行为变更

自此版本起，本地视频采集参数默认由系统自动设置，而不是和编码参数保持一致。你可以通过 VideoCaptureConfig 进行相关设置。如果你的代码逻辑中对采集到的视频帧进行了自定义处理，应对处理逻辑进行相应修改。

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 参数变化 | 视频管理 | `public abstract int setVideoCaptureConfig(VideoCaptureConfig videoCaptureConfig);` | [`public abstract int setVideoCaptureConfig(VideoCaptureConfig videoCaptureConfig);`](70080.md#setvideocaptureconfig) |增加摄像头采集参数中的模式设置 |


### 回调变更

以下表格中的回调发生了变化。你需要在工程文件中找到该回调，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 名称变化 | 视频管理 | `public void onFirstRemoteVideoFrameRendered(RemoteStreamKey remoteStreamKey, VideoFrameInfo frameInfo) {}` | [`public void onFirstRemoteVideoFrameDecoded(RemoteStreamKey remoteStreamKey, VideoFrameInfo frameInfo) {}`](70081.md#onfirstremotevideoframedecoded) |
| 名称变化 | 多房间 | `public abstract void onFirstRemoteVideoFrameRendered(RemoteStreamKey remoteStreamKey, VideoFrameInfo frameInfo);` | [`public abstract void onFirstRemoteVideoFrameDecoded(RemoteStreamKey remoteStreamKey, VideoFrameInfo frameInfo);`](70081.md#onfirstremotevideoframedecoded) |


## 3.34

### 类型变更

以下表格中的类型发生了变化，你需要在工程文件中找到该类型，并根据变化调整相关处理逻辑：

| 变更详情 | 数据类型  | 备注 |
| --- | --- | --- |
| 枚举值增删 | [`NetworkDetectionStopReason`](70083.md#networkdetectionstopreason) | 新增了枚举值：`NetworkDetectionStopReasonInnerErr` |
| 枚举值增删 | [`AudioMixingError`](70083.md#audiomixingerror) | 新增了枚举值：`AUDIO_MIXING_ERROR_ID_TYPE_INVALID_PITCH` |
| 成员变量变化 | [`AudioMixingConfig`](70083.md#audiomixingconfig) | 新增成员变量：`position` 和 `callbackOnProgressInterval` |


### 错误码变更

以下表格中的错误码发生了变化，你需要进行相应的处理：

| 变更详情 | 错误码  | 备注 |
| --- | --- | --- |
| 枚举值增删 | [`WarningCode`](70082.md#warningcode) | 新增了枚举值：`-5011` |


## 3.33

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 参数变化 | 屏幕共享 | `public abstract boolean pushScreenFrame(RTCVideoFrame videoFrame);` | [`public abstract boolean pushScreenFrame(VideoFrame videoFrame);`](70080.md#pushscreenframe) |
| 参数变化 | 自定义视频采集渲染 | <li>`public abstract boolean pushExternalVideoFrame(RTCVideoFrame frame);`</li><li>`public abstract boolean pushExternalVideoFrame(RTCVideoFrame frame, boolean isDirectEncode);`</li> | <li>[`public abstract boolean pushExternalVideoFrame(VideoFrame frame);`](70080.md#RTCEngine-pushexternalvideoframe)</li><li>[`public abstract boolean pushExternalVideoFrame(VideoFrame frame, boolean isDirectEncode);`](70080.md#pushexternalvideoframe-2)</li> |
| 参数变化 | 音频管理 | <li>`public abstract void enableAudioMixingFrame(AudioMixingType type);`</li><li>`public abstract void disableAudioMixingFrame()`</li><li>`public abstract int pushAudioMixingFrame(AudioFrame audioFrame)`</li> | <li>[`public  abstract  void  enableAudioMixingFrame(int id,  AudioMixingType type);`](70080.md#enableaudiomixingframe)</li><li>[`public abstract void disableAudioMixingFrame(int id);`](70080.md#disableaudiomixingframe)</li><li>[`public abstract int pushAudioMixingFrame(int id, AudioFrame audioFrame);`](70080.md#pushaudiomixingframe)</li> |


### 错误码变更

以下表格中的错误码发生了变化，你需要进行相应的处理：

| 变更详情 | 错误码  | 备注 |
| --- | --- | --- |
| 枚举值增删 | [`WarningCode`](70082#warningcode) | 废弃了枚举值 `-5002` ~ `-5008`。<br>使用 [`public void onMediaDeviceStateChanged(String device_id, int device_type, int device_state, int device_error) {}`](70081.md#onmediadevicestatechanged) 代替。 |
| 枚举值增删 | [`LocalVideoStreamError`](70083.md#localvideostreamerror) | 新增了枚举值 `7`。 |


## 3.29

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 参数变化 | 房间管理 | `public abstract void joinRoom(String token, String roomId, UserInfo userInfo, RTCRoomConfig roomConfig);` | [`public abstract int joinRoom(String token, String roomId, UserInfo userInfo, RTCRoomConfig roomConfig);`](70080.md#joinroom) |
| 参数变化 | 多房间 | `public abstract void joinRoom(String token, UserInfo userInfo, MultiRoomConfig roomConfig);` | [`public abstract int joinRoom(String token, UserInfo userInfo, MultiRoomConfig roomConfig);`](70080.md#joinroom-2) |
| 参数变化 | 视频管理 | `public abstract void setVideoSourceType(VideoSourceType type);` | [`public abstract void setVideoSourceType(StreamIndex index, VideoSourceType type);`](70080.md#setvideosourcetype) |
| 名称和参数均变化 | 房间管理 | `public abstract void setAudioVolumeIndicationInterval(int interval);` | [`public abstract void enableAudioPropertiesReport(AudioPropertiesConfig config);`](70080.md#enableaudiopropertiesreport) |
| 名称和参数均变化 | 视频管理 | `public abstract int setLocalVideoMirrorMode(MirrorMode mirrorMode);` | [`public abstract int setLocalVideoMirrorType(MirrorType mirrorType);`](70080.md#setlocalvideomirrortype) |


### 回调变更

以下表格中的回调发生了变化。你需要在工程文件中找到该回调，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 拆分 | 音频管理 | `public void onAudioVolumeIndication(IRTCEngineEventHandler.AudioVolumeInfo[] speakers, int totalRemoteVolume)` | <li>[`public void onLocalAudioPropertiesReport(LocalAudioPropertiesInfo[] audioPropertiesInfos){}`](70081.md#onlocalaudiopropertiesreport)</li><li>[`public void onRemoteAudioPropertiesReport(RemoteAudioPropertiesInfo[] audioPropertiesInfos, int totalRemoteVolume)`](70081.md#onremoteaudiopropertiesreport)</li> | 旧版回调拆分为 `onLocalAudioPropertiesReport` 和 `onRemoteAudioPropertiesReport` |
| 删除 | 视频管理 | `public void onMirrorStateChanged(boolean mirrored){}` | / |


## 3.28

### 错误码变更

以下表格中的错误码发生了变化，你需要进行相应的处理：

| 变更详情 | 错误码  | 备注 |
| --- | --- | --- |
| 枚举值增删 | [`AudioSampleRate`](70083.md#audiosamplerate) | 新增了枚举值：`AUDIO_SAMPLE_RATE_AUTO` |
| 枚举值增删 | [`AudioChannel`](70083.md#audiochannel) | 新增了枚举值：`AUDIO_CHANNEL_AUTO` |


## 3.27

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 参数变化 | 引擎管理 | `public static int feedback(Context context, int grade, int type, String problemDesc){return RTCEngineImpl.feedback(context, grade, type, problemDesc);}` | [`public abstract int feedback(List<ProblemFeedback> types, String problemDesc);`](70080.md#feedback) |
| 名称和参数均变化 | 音频管理 | `public abstract void setRecordingVolume(int volume);` | [`public abstract void setCaptureVolume(StreamIndex index, int volume);`](70080.md#setcapturevolume) |
| 名称和参数均变化 | 视频管理 |  `public abstract void registerMetadataObserver(IMetadataObserver observer);` | [`public abstract int sendSEIMessage(StreamIndex streamIndex, byte[] message, int repeatCount);`](70080.md#sendseimessage) |
| 拆分 | 屏幕共享 | `public abstract int startScreenSharing(Intent mediaProjectionResultData, ScreenSharingParameters parameters);` | <li>[`public abstract int startScreenVideoCapture(Intent mediaProjectionResultData);`](70080.md#startscreenvideocapture)</li><li>[`public abstract int publishScreen();`](70080.md#publishscreen)</li> | 解耦屏幕共享流的采集与发布 |
| 拆分 | 屏幕共享 | `public abstract int stopScreenSharing();` | <li>[`public abstract int stopScreenVideoCapture();`](70080.md#stopscreenvideocapture)</li><li>[`public abstract int unpublishScreen();`](70080.md#unpublishscreen)</li> | 解耦屏幕共享流的停止采集与停止发布 |


### 回调变更

以下表格中的回调发生了变化。你需要在工程文件中找到该回调，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 名称变化 | 视频数据回调 | `public void onMetadataReceived(byte[] buffer, String uid, long timeStampMs);` | [`public void onSEIMessageReceived(RemoteStreamKey remoteStreamKey,ByteBuffer message)`](70081.md#onseimessagereceived) |


### 类型变更

以下表格中的类型发生了变化，你需要在工程文件中找到该类型，并根据变化调整相关处理逻辑：

| 变更详情 | 数据类型  | 备注 |
| --- | --- | --- |
| 枚举值增删 | [`ProblemFeedback`](70083.md#problemfeedback) | 删除了枚举值： <li>`PROBLEM_CONNECT_FAILED`</li><li>`PROBLEM_VIDEO_LAGGING`</li><li>`PROBLEM_AUDIO_DELAY`</li> 增加了枚举值：<li>`PROBLEM_EAR_BACK_DELAY`</li> |


### 错误码变更

以下表格中的错误码发生了变化，你需要进行相应的处理：

| 变更详情 | 错误码  | 备注 |
| --- | --- | --- |
| 枚举值增删 | [`WarningCode`](70082.md#warningcode) | 新增了枚举值：<li>`WARNING_CODE_SET_SCREEN_AUDIO_SOURCE_TYPE_FAILED`</li><li>`WARNING_CODE_SET_SCREEN_STREAM_INDEX_FAILED` |


## 3.26

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 参数变化 | 房间管理 | `public abstract int joinRoom(String token, String roomId, UserInfo userInfo, ChannelProfile profile_type);` | [`public abstract int joinRoom(String token, String roomId, UserInfo userInfo, RTCRoomConfig roomConfig);`](70080.md#joinroom) |
| 名称和参数均变化 | 房间管理 | `public abstract int setUserRole(ClientRole clientRole);` | [`public abstract int setUserVisibility(boolean enable);`](70080.md#setuservisibility) |
| 合并 | 房间管理 | <li>`public abstract void subscribeStream(String userId, SubscribeConfig info);`</li><li>`public abstract void unSubscribe(String userId, boolean isScreen);`</li><li>`public abstract void muteRemoteAudio(String uid, MuteState muteState);`</li><li>`public abstract int muteRemoteVideo(String uid, MuteState muteState);`</li> | [`public abstract void subscribeUserStream(String uid, StreamIndex streamType, SubscribeMediaType mediaType, SubscribeVideoConfig subscribeVideoConfig);`](70080.md#subscribeuserstream) |
| 合并 | 音频管理/视频管理 | <li>`public abstract int muteAllRemoteVideo(MuteState muteState);`</li><li>`public abstract void muteAllRemoteAudio(MuteState muteState);`</li> | `public abstract void pauseAllSubscribedStream(PauseResumeControlMediaType mediaType);` | 通过 [`pauseAllSubscribedStream`](70080.md#pauseallsubscribedstream) 和 [`resumeAllSubscribedStream`](70080.md#resumeallsubscribedstream) 来暂停或接收所有远端媒体流 |
| 删除 | 房间管理 | `public abstract void enableAutoSubscribe(SubscribeMode audioMode, SubscribeMode videoMode);` | / | 使用 [`joinRoom`](70080.md#joinroom) 中的 roomConfig 设置 |


### 类型变更

以下表格中的类型发生了变化，你需要在工程文件中找到该类型，并根据变化调整相关处理逻辑：

| 变更详情 | 数据类型  | 备注 |
| --- | --- | --- |
| 枚举值增删 | [`AudioScenarioType`](70083.md#audioscenariotype) | 新增了枚举值：`AUDIO_SCENARIO_GAME_STREAMING` |


### 错误码变更

以下表格中的错误码发生了变化，你需要进行相应的处理：

| 变更详情 | 错误码  | 备注 |
| --- | --- | --- |
| 枚举值增删 | [`WarningCode`](70082.md#warningcode) | 新增了枚举值：<li>`WARNING_CODE_PUBLISH_STREAM_FORBIDEN` </li><li>`WARNING_CODE_RECEIVE_USER_NOTIFY_STOP`</li> |
| 枚举值增删 | [`UserMessageSendResult`](70082.md#usermessagesendresult) | 新增了枚举值：<li>`USER_MESSAGE_SEND_RESULT_NOT_LOGIN`</li><li>`USER_MESSAGE_SEND_RESULT_SERVER_PARAMS_NOT_SET`</li> |


## 3.25

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 参数变化 | 混音 | `public abstract int getAudioMixingDuration();` | [`public abstract int getAudioMixingDuration(int id);`](70080.md#getaudiomixingduration) |
| 参数变化 | 混音 | `public abstract int getAudioMixingCurrentPosition();` | [`public abstract int getAudioMixingCurrentPosition(int id);`](70080.md#getaudiomixingcurrentposition) |
| 参数变化 | 混音 | `public abstract int setAudioMixingPosition(int pos);` | [`public abstract void setAudioMixingPosition(int id, int position);`](70080.md#setaudiomixingposition) |
| 名称和参数均变化 | 混音 | `public abstract int preloadEffect(int soundId, String filePath);` | [`public abstract void preloadAudioMixing(int id, String filePath);`](70080.md#preloadaudiomixing) |
| 名称和参数均变化 | 混音 | `public abstract boolean pushAudioMixingStreamData(byte[] audioFrame, int frameNum);` | [`public abstract int pushAudioMixingFrame(AudioFrame audioFrame);`](70080.md#pushaudiomixingframe) |
| 合并 | 自定义视频采集渲染 | <li>`int setupRemoteVideoRender(IVideoSink videoSink, String roomid, String uid)`</li><li>`int setupRemoteVideoRender(IVideoSink videoSink, String uid)`</li><li>`int setupRemoteVideoRender(IVideoSink videoSink, String roomid, String uid, boolean isInitialized)`</li><li>`int setupRemoteVideoRender(IVideoSink videoSink, String uid, boolean isInitialized)`</li><li>`int setupRemoteScreenRender(IVideoSink videoSink, String roomid, String uid)`</li><li>`int setupRemoteScreenRender(IVideoSink videoSink, String uid)`</li> | `public abstract void setRemoteVideoSink(RemoteStreamKey streamKey, IVideoSink videoSink, @IVideoSink.PixelFormat int requiredFormat);` | 多个旧版接口合并为 [`setRemoteVideoSink`](70080.md#setremotevideosink) |
| 合并 | 自定义视频采集渲染 | <li>`int setupLocalVideoRender(IVideoSink videoSink, String uid)`</li><li>`int setupLocalVideoRender(IVideoSink videoSink, String uid, boolean isInitialized)`</li><li>`int setupLocalScreenRender(IVideoSink videoSink, String uid)`</li> | `public abstract void setLocalVideoSink(StreamIndex index, IVideoSink videoSink, @IVideoSink.PixelFormat int requiredFormat);` | 多个旧版接口合并为 [`setLocalVideoSink`](70080.md#setlocalvideosink) |
| 合并 | 混音 | <li>`public abstract int startAudioMixing(String file, boolean loopback, boolean replace, int cycle);`</li><li>`public abstract int playEffect(int soundId, String filePath, boolean loopback, int cycle, int volume);`</li> | `public abstract void startAudioMixing(int id, String filePath, AudioMixingConfig config);` | 多个旧版接口合并为 [`startAudioMixing`](70080.md#startaudiomixing)|
| 合并 | 混音 | <li>`public abstract int stopAudioMixing();`</li><li>`public abstract int stopEffect(int soundId);`</li><li>`public abstract int stopAllEffects();`</li>  | `public abstract void stopAudioMixing(int id);` | 多个旧版接口合并为 [`stopAudioMixing`](70080.md#stopaudiomixing)|
| 合并 | 混音 | <li>`public abstract int pauseAudioMixing();`</li><li>`public abstract int pauseEffect(int soundId);`</li><li>`public abstract int pauseAllEffects();`</li> | `public abstract void pauseAudioMixing(int id);` | 多个旧版接口合并为 [`pauseAudioMixing`](70080.md#pauseaudiomixing)|
| 合并 | 混音 | <li>`public abstract int resumeAudioMixing();`</li><li>` public abstract int resumeEffect(int soundId);`</li><li>` public abstract int resumeAllEffects();`</li> | `public abstract void resumeAudioMixing(int id);` | 多个旧版接口合并为 [`resumeAudioMixing`](70080.md#resumeaudiomixing)|
| 合并 | 混音 | <li>`public abstract int unloadEffect(int soundId);`</li><li>`public abstract int unloadAllEffects();`</li> | `public abstract void unloadAudioMixing(int id);` | 多个旧版接口合并为 [`unloadAudioMixing`](70080.md#unloadaudiomixing)|
| 合并 | 混音 | <li>`public abstract int adjustAudioMixingVolume(int volume);`</li><li>`public abstract int setVolumeOfEffect(int soundId, int volume);`</li><li>`public abstract int adjustAudioMixingPlayoutVolume(int volume);`</li><li>`public abstract int adjustAudioMixingPublishVolume(int volume);`</li><li>`public abstract int setEffectsVolume(int volume);`</li> | ` public abstract void setAudioMixingVolume(int id, int volume, AudioMixingType type);` | 多个旧版接口合并为 [`setAudioMixingVolume`](70080.md#setaudiomixingvolume)|

| 拆分 | 混音 | `public abstract void setAudioPlayoutMixStream(boolean enable, int sampleRate, int channelNum);` | <li>`public abstract void enableAudioMixingFrame(AudioMixingType type);`</li><li>`public abstract void disableAudioMixingFrame();`</li> | 旧接口拆分为 [`enableAudioMixingFrame`](70080.md#enableaudiomixingframe) 和 [`disableAudioMixingFrame`](70080.md#disableaudiomixingframe)

| 删除 | 混音 | `public abstract int getEffectVolume(int soundId);` | / |
| 删除 | 混音 | `public abstract int getAudioMixingStreamCachedFrameNum();` | / |


### 回调变更

以下表格中的回调发生了变化。你需要在工程文件中找到该回调，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 参数变化 | 引擎管理 | `public void onMediaDeviceStateChanged(int device_type, int device_state, int device_error) {}` | [`public void onMediaDeviceStateChanged(String device_id, int device_type, int device_state, int device_error) {}`](70081.md#onmediadevicestatechanged) |


## 3.24

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 参数变化 | 视频特效 | `public abstract void setVideoEffectColorFilter(String resFile);` | [`public abstract int setVideoEffectColorFilter(String resFile);`](70080.md#setvideoeffectcolorfilter) |
| 参数变化 | 视频特效 | `public abstract void setVideoEffectColorFilterIntensity(float intensity);` | [`public abstract int setVideoEffectColorFilterIntensity(float intensity);`](70080.md#setvideoeffectcolorfilterintensity) |
| 参数变化 | 视频管理 | `public abstract int muteLocalVideo(MuteState muteState);` | [`public abstract void muteLocalVideo(MuteState muteState);`](70080.md#mutelocalvideo) |
| 名称和参数均变化 | 视频特效 | `public abstract void setVideoEffectPath(List<String> effectPaths);` | [`public abstract int setVideoEffectNodes(List<String> effectNodes);`](70080.md#setvideoeffectnodes) |
| 名称和参数均变化 | 视频特效 | `public abstract void updateVideoEffect(String effectPath, String key, float value);` | [`public abstract int updateVideoEffectNode(String effectNode, String key, float value);`](70080.md#updatevideoeffectnode) |
| 名称和参数均变化 | 视频管理 | `public abstract void setVideoInputType(MediaInputType type);` | [`public abstract void setVideoSourceType(VideoSourceType type);`](70080.md#setvideosourcetype) |
| 删除 | 视频特效 | `public abstract void addVideoEffectPath(List<String> effectPaths);` | / |
| 删除 | 视频特效 | `   public abstract void removeVideoEffectPath(List<String> effectPaths);` | / |
| 删除 | 音频管理 | `public abstract void setAudioPerformanceProfile(AudioPerformanceProfile profile);` | / |
| 删除 | 视频管理 | `public abstract boolean isLocalVideoMirrorOn();` | / |
| 删除 | 屏幕共享 | `public abstract int updateScreenSharingParameters(ScreenSharingParameters parameters);` | / |


## 3.23

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 拆分 | 音频管理 | `public abstract int enableLocalAudio(boolean enabled);` | <li>[`public abstract void startAudioCapture();`](70080.md#startaudiocapture)</li><li>[`public abstract void stopAudioCapture();`](70080.md#stopaudiocapture)</li> | <li>拆分后的接口解除了音频采集与发布的绑定关系。无论是否发布音频，你都可以开启音频采集，并且停止发布后不再自动关闭采集</li><li>新接口解除了对外部源的推送控制，仅控制是否进行内部音频采集</li> |
| 方法行为变化 | 视频管理 | [`public abstract void startVideoCapture();`](70080.md#startvideocapture) | [`public abstract void startVideoCapture();`](70080.md#startvideocapture) | <li>无论是否发布视频，你都可以开启视频采集</li><li>解除了对外部源的推送控制，仅控制内部视频采集</li> |
| 方法行为变化 | 视频管理 | [`public abstract void stopVideoCapture();`](70080.md#stopvideocapture) | [`public abstract void stopVideoCapture();`](70080.md#stopvideocapture)  | <li>停止视频发布后不再自动关闭采集，可手动关闭</li><li>解除了对外部源的推送控制，仅控制内部视频采集</li> |
| 方法行为变化 | 视频管理 | [`public abstract void setVideoInputType(MediaInputType type);`](70080.md#setvideoinputtype) | [`public abstract void setVideoInputType(MediaInputType type);`](70080.md#setvideoinputtype) | <li>由自定义采集切换至内部采集后，须手动开启内部采集方可开始采集</li><li>无切换场景时，内部采集、自定义采集互不影响</li><li>进房前后均可切换</li> |
| 方法行为变化 | 音频管理 | [`public abstract void enableExternalAudioDevice(AudioFormat recordingFormat, AudioFormat playbackFormat);`](70080.md#enableexternalaudiodevice) || [`public abstract void enableExternalAudioDevice(AudioFormat recordingFormat, AudioFormat playbackFormat);`](70080.md#enableexternalaudiodevice) | <li>由自定义采集切换至内部采集时，必须先关闭自定义采集，后手动开启内部采集</li><li>无切换场景时，内部采集、自定义采集互不影响</li><li>仅支持进房前切换</li> |


### 错误码变更

以下表格中的错误码发生了变化，你需要进行相应的处理：

| 变更详情 | 错误码  | 备注 |
| --- | --- | --- |
| 枚举值增删 | [`WarningCode`](70082.md#warningcode) | 新增了枚举值：[`WARNING_CODE_MEDIA_DEVICE_OPERATION_DENIED`](70082.md#warning-code-media-device-operation-denied) |


## 3.22

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 参数变化 | CDN 推流 | `public abstract void startLiveTranscoding(LiveTranscoding liveTranscode);` | [`public abstract void startLiveTranscoding(LiveTranscoding liveTranscode, ILiveTranscodingObserver observer);`](70080.md#startlivetranscoding) |
| 参数变化 | 视频管理 | `public abstract int switchCamera();` | [`public abstract int switchCamera(CameraId cameraId);`](70080.md#switchcamera) |
| 名称和参数均变化 | CDN 推流 | `public abstract void updateLiveTranscodingLayout(``LiveTranscoding.Layout layout``);` | [`public abstract void updateLiveTranscoding(``LiveTranscoding transcoding``);`](70080.md#updatelivetranscoding) |


### 回调变更

以下表格中的回调发生了变化。你需要在工程文件中找到该回调，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 参数变化 | 引擎管理 | `void onMediaDeviceStateChanged(int device_type, int device_state)` | [`void onMediaDeviceStateChanged(int device_type, int device_state, int device_error)`](70081.md#onmediadevicestatechanged) | 新增了回调参数 `device_error` | 


### 类型变更

以下表格中的类型发生了变化，你需要在工程文件中找到该类型，并根据变化调整相关处理逻辑：

| 变更详情 | 数据类型  | 备注 |
| --- | --- | --- |
| 枚举值增删 | [`MediaDeviceState`](70083.md#mediadevicestate) | 删除了枚举值：<li>`MEDIA_DEVICE_STATE_START_FAILED`</li><li>`MEDIA_DEVICE_STATE_STOP_FAILED`</li>，新增了枚举值：<li>[`MEDIA_DEVICE_STATE_RUNTIMEERROR`](70083.md#media-device-state-runtimeerror)</li><li>[`MEDIA_DEVICE_STATE_ADDED`](70083.md#media-device-state-added)</li><li>[`MEDIA_DEVICE_STATE_REMOVED`](70083.md#media-device-state-removed)</li> |


### 错误码变更

以下表格中的错误码发生了变化，你需要进行相应的处理：

| 变更详情 | 错误码  | 备注 |
| --- | --- | --- |
| 枚举值增删 | [`WarningCode`](70082.md#warningcode) | 新增了枚举值：[`WARNING_CODE_RECORDING_SILENCE`](70082.md#warning-code-recording-silence) |


## 3.21

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 名称变化 | 房间管理 | `public abstract int renewToken(String token)` | [`public abstract int updateToken(String token)`](70080.md#updatetoken) |
| 名称变化 | 房间管理 | `public abstract int leaveChannel()` | [`public abstract int leaveRoom()`](70080.md#leaveroom) |
| 名称变化 | 视频管理 | `int setVideoProfiles(VideoStreamDescription[] videoStreamDescriptions)` | [`int setVideoEncoderConfig(List<VideoStreamDescription> videoStreamDescriptions)`](70080.md#setvideoencoderconfig) |
| 名称变化 | 引擎管理 | `public abstract void SetRuntimeParameters(JSONObject params);` | [`public abstract void setRuntimeParameters(JSONObject params);`](70080.md#setruntimeparameters) |
| 名称变化 | 音频管理 | `int adjustRecordingSignalVolume(int volume)` | [`void setRecordingVolume(int volume)`](70080.md#setrecordingvolume) |
| 名称变化 | 音频管理 | `int adjustPlaybackSignalVolume(int volume)` | [`void setPlaybackVolume(int volume)`](70080.md#setplaybackvolume) |
| 名称变化 | 音频管理 | `void AdjustRemoteAudioVolume(String uid, int volume)` | [`void setRemoteAudioPlaybackVolume(String uid, int volume)`](70080.md#setremoteaudioplaybackvolume) |
| 名称变化 | 音频管理 | `void SetAudioPerfProfile(AudioPerfProfile profile)` | [`void setAudioPerformanceProfile(AudioPerformanceProfile profile)`](70080.md#setaudioperformanceprofile) |
| 名称变化 | CDN 推流 | `public abstract void disableLiveTranscoding()` | [`public abstract void stopLiveTranscoding()`](70080.md#stoplivetranscoding) |
| 参数变化 | 视频管理 | `int setLocalVideoMirrorMode(int mode)` | [`int setLocalVideoMirrorMode(MirrorMode mirrorMode)`](70080.md#setlocalvideomirrormode) |
| 参数变化 | 性能回退 | `public abstract int setPublishFallbackOption(int option)` | [`public abstract int setPublishFallbackOption(PublishFallbackOption option)`](70080.md#setpublishfallbackoption) |
| 参数变化 | 音频管理 | `boolean pushExternalAudioFrame(byte[] audioFrame, int frameNum)` | [`int pushExternalAudioFrame(AudioFrame audioFrame)`](70080.md#pushexternalaudioframe)|
| 参数变化 | 音频管理 | `boolean pullExternalAudioFrame(byte[] audioFrame, int frameNum)` | [`int pullExternalAudioFrame(AudioFrame audioFrame)`](70080.md#pullexternalaudioframe)|
| 名称和参数均变化 | 房间管理 | `public abstract int setClientRole(CLIENT_ROLE_TYPE clientRole)` | [`public abstract int setUserRole(ClientRole clientRole);`](70080.md#setuserrole) |
| 名称和参数均变化 | 房间管理 | `public abstract int joinChannel(String token, String channelName, PublisherConfiguration publisherConfiguration, String uid, String traceId)` | [`public abstract int joinRoom(String token, String roomId, UserInfo userInfo, ChannelProfile profile_type)`](70080.md#joinroom) |
| 名称和参数均变化 | 视频管理 | `int muteRemoteVideoStream(String uid, boolean muted)` | [`int muteRemoteVideo(String uid, MuteState mute_state)`](70080.md#muteremotevideo) |
| 名称和参数均变化 | 视频管理 | `int muteLocalVideoStream(boolean muted)` | [`int muteLocalVideo(MuteState state)`](70080.md#mutelocalvideo) |
| 名称和参数均变化 | 视频管理 | `int setVideoProfiles(VideoStreamDescription[] videoStreamDescriptions, VideoEncoderConfiguration.ORIENTATION_MODE orientationMode)` | [`int setVideoEncoderConfig(List<VideoStreamDescription> videoStreamDescriptions, VideoEncoderConfiguration.OrientationMode orientationMode)`](70080.md#setvideoencoderconfig-2) |
| 名称和参数均变化 | 音频管理 | `int setEnableSpeakerphone(boolean enable)` | [`int setAudioPlaybackDevice(AudioPlaybackDevice audioPlaybackDevice)`](70080.md#setaudioplaybackdevice) |
| 名称和参数均变化 | 音频管理 | `int enableAudioVolumeIndication(int interval, int smooth)` | [`void setAudioVolumeIndicationInterval(int interval)`](70080.md#setaudiovolumeindicationinterval) |
| 名称和参数均变化 | 音频管理 | `int muteLocalAudioStream(boolean muted)` | [`void muteLocalAudio(MuteState muteState)`](70080.md#mutelocalaudio) |
| 名称和参数均变化 | 音频管理 | `int muteRemoteAudioStream(String uid, boolean muted)` | [`void muteRemoteAudio(String uid, MuteState muteState)`](70080.md#muteremoteaudio) |
| 名称和参数均变化 | CDN 推流 | `public abstract void enableLiveTranscoding(LiveTranscoding liveTranscode)` | [`public abstract void startLiveTranscoding(LiveTranscoding liveTranscode)`](70080.md#startlivetranscoding) |
| 名称和参数均变化 | CDN 推流 | `public abstract void setVideoCompositingLayout(LiveTranscoding.Layout layout)` | [`public abstract void updateLiveTranscodingLayout(LiveTranscoding.Layout layout)`](70080.md#updatelivetranscodinglayout) |
| 合并 | 视频管理 | <li>`void setExternalVideoSource(boolean enable, boolean useTexture, boolean push)`</li><li>`void setExternalVideoSource(boolean enable, boolean useTexture, boolean push, boolean needRender)`</li> | `void setVideoInputType(MediaInputType type)` | 多个旧版接口合并为 [`setVideoInputType`](70080.md#setvideoinputtype)|
| 合并 | 视频管理 | <li>`int muteAllRemoteVideoStreams(boolean muted)`</li><li>`int setDefaultMuteAllRemoteVideoStreams(boolean muted)`</li> | `int muteAllRemoteVideo(MuteState mute_state)` | 多个旧版接口合并为 [`muteAllRemoteVideo`](70080.md#muteallremotevideo)|
| 合并 | 视频管理 | <li>`int setupRemoteVideo(VideoCanvas videoCanvas)`</li><li>`void setupRemoteScreen(VideoCanvas videoCanvas)`</li> | `int setRemoteVideoCanvas(String user_id, StreamIndex index, VideoCanvas canvas)` | 多个旧版接口合并为 [`setRemoteVideoCanvas`](70080.md#setremotevideocanvas)|
| 合并 | 视频管理 | <li>`int setupLocalVideo(VideoCanvas local)`</li><li>`int setupLocalScreen(VideoCanvas videoCanvas)`</li> | `int setLocalVideoCanvas(StreamIndex index, VideoCanvas canvas)` | 多个旧版接口合并为 [`setLocalVideoCanvas`](70080.md#setlocalvideocanvas)|
| 合并 | 音频管理 | <li>`int muteAllRemoteAudioStreams(boolean muted)`</li><li>`int setDefaultMuteAllRemoteAudioStreams(boolean muted)`</li> | `void muteAllRemoteAudio(MuteState muteState)` | 多个旧版接口合并为 [`muteAllRemoteAudio`](70080.md#muteallremoteaudio) |
| 拆分 | 视频管理 | `int enableLocalVideo(boolean enabled)` | <li>`void startVideoCapture()`</li><li>`void stopVideoCapture()`</li> | 旧版接口拆分为 [`startVideoCapture()`](70080.md#startvideocapture) 和 [`stopVideoCapture()`](70080.md#stopvideocapture) |
| 拆分 | 音频管理 | `boolean setExternalAudioDevice(boolean enable, int sampleRate, int recordChannelNum, int playoutChannelNum)` | <li>`void enableExternalAudioDevice(AudioFormat recordingFormat, AudioFormat playbackFormat)`</li><li>`void disableExternalAudioDevice()`</li> | 旧版接口拆分为 [`enableExternalAudioDevice`](70080.md#enableexternalaudiodevice) 和 [`disableExternalAudioDevice`](70080.md#disableexternalaudiodevice)|
| 删除 | 房间管理 | `public abstract int setChannelProfile(CHANNEL_PROFILE_TYPE channelProfile)` | / | 删除旧版接口，设置房间模式请使用 `joinRoom` |
| 删除 | 引擎管理 | `public static void enablePerformanceCollect(boolean enable)` | / | 删除旧版接口，且无替代接口 |
| 删除 | 引擎管理 | `public abstract void setLogFilter(IRtcEngineEventHandler.RtcLogLevel level)` | / | 删除旧版接口，且无替代接口 |
| 删除 | 引擎管理 | `public static void setLoggerMessageLevel(IRtcEngineEventHandler.RtcLogLevel level)` | / | 删除旧版接口，且无替代接口 |
| 删除 | 引擎管理 | `public static RtcNativeLibraryLoader getRtcNativeLibraryLoader()` | / | 删除旧版接口，且无替代接口 |
| 删除 | 引擎管理 | `public static void setEnableLog(boolean enableLog)` | / | 删除旧版接口，且无替代接口 |
| 删除 | 音频管理 | `boolean setAudioDeviceEventHandler(IRtcEngineAudioDeviceEventHandler handler)` | / | 删除旧版接口，且无替代接口 |


### 回调变更

以下表格中的回调发生了变化。你需要在工程文件中找到该回调，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 名称变化 | 房间管理 | `public abstract void onWarning(int warn)` | `public abstract void onRoomWarning(int warn)` |
| 名称变化 | 房间管理 | `public abstract void onError(int err)` | `public abstract void onRoomError(int err)` |
| 名称变化 | 房间管理 | `public void onUserOffline(String uid, int reason)` | [`public void onUserLeave(String uid, int reason)`](70081.md#onuserleave) |
| 名称变化 | 房间管理 | `public void onStreamPublishSucceed(String userId, boolean isScreen)` | `public void onStreamPublishSuccess(String userId, boolean isScreen)`|
| 名称变化 | 数据统计 | `void onRtcStats(IRtcEngineEventHandler.RtcStats stats)` | [`void onRoomStats(RTCRoomStats stats)`](70081.md#onroomstats) |
| 参数变化 | 引擎管理 | `void onMediaDeviceStateChanged(int device_type, int device_state)` | `void onMediaDeviceStateChanged(int device_type, int device_state)` | [`MediaDeviceType`](70083.md#mediadevicetype) 和 [`MediaDeviceState`](70083.md#mediadevicestate) 枚举值名称变化 |
| 参数变化 | 房间管理 | `public void onUserJoined(String uid, int elapsed)` | [`public void onUserJoined(UserInfo userInfo, int elapsed)`](70081.md#onuserjoined) |
| 参数变化 | 视频管理 | `void onMuteAllRemoteVideo(String uid, boolean muted)` |[`void onMuteAllRemoteVideo(String uid, MuteState muteState)`](70081.md#onmuteallremotevideo) |
| 参数变化 | 视频管理 | `void onUserMuteVideo(String uid, boolean muted)` | [`void onUserMuteVideo(String uid, MuteState muteState)`](70081.md#onusermutevideo) |
| 参数变化 | 视频管理 | `void onRemoteVideoStateChanged(String uid, int state, int reason, int elapsed)` | [`void onRemoteVideoStateChanged(RemoteStreamKey streamKey, RemoteVideoState videoState, RemoteVideoStateChangeReason videoStateReason)`](70081.md#onremotevideostatechanged) |
| 参数变化 | 视频管理 | `void onLocalVideoStateChanged(int state, int error)` | [`void onLocalVideoStateChanged(StreamIndex streamIndex, LocalVideoStreamState state, LocalVideoStreamError error)`](70081.md#onlocalvideostatechanged) |
| 参数变化 | 性能回退 | `public void onPerformanceAlarms(int level, SourceWantedData data)` | [`public void onPerformanceAlarms(PerformanceAlarmMode mode, String roomId, PerformanceAlarmReason reason, SourceWantedData data)`](70081.md#onperformancealarms) |
| 参数变化 | 音频管理 | `void onAudioVolumeIndication(IRtcEngineEventHandler.AudioVolumeInfo[] speakers, int totalVolume)` | [`void onAudioVolumeIndication(IRtcEngineEventHandler.AudioVolumeInfo[] speakers, int totalRemoteVolume)`](70087.md#rtcengine-onaudiovolumeindication-totalremotevolume) |
| 参数变化 | 音频管理 | `void onUserMuteAudio(String uid, boolean muted)` | [`void onUserMuteAudio(String uid, MuteState muteState)`](70081.md#onusermuteaudio) |
| 参数变化 | 音频管理 | `void onLocalAudioStateChanged(int state, int error)` | [`void onLocalAudioStateChanged(LocalAudioStreamState state, LocalAudioStreamError error)`](70081.md#onlocalaudiostatechanged) |
| 参数变化 | 音频管理 | `void onRemoteAudioStateChanged(String uid, int state, int reason,int elapsed)` | [`void onRemoteAudioStateChanged(RemoteStreamKey key, RemoteAudioState state, RemoteAudioStateChangeReason reason)`](70081.md#onremoteaudiostatechanged) |
| 参数变化 | 音频管理 | `void onFirstLocalAudioFrame(int elapsed)` | [`void onFirstLocalAudioFrame(StreamIndex streamIndex)`](70081.md#onfirstlocalaudioframe) |
| 参数变化 | 音频管理 | `void onFirstRemoteAudioFrame(String uid, long elapsed)` | [`void onFirstRemoteAudioFrame(RemoteStreamKey remoteStreamKey)`](70081.md#onfirstremoteaudioframe) |

| 参数变化 | 流消息 | `public void onUserMessageSendResult(long msgid, int error)` | [`public void onUserMessageSendResult(long msgid, int error)`](70081#onusermessagesendresult) | [`UserMessageSendResult`](70082.md#usermessagesendresult) 枚举值名称变更 & 新增枚举值 ｜

| 名称和参数均变化 | 房间管理 | `public void onLeaveChannel(IRtcEngineEventHandler.RtcStats stats)` | [`public void onLeaveRoom(IRtcEngineEventHandler.RtcRoomStats stats)`](70081.md#onleaveroom) | 
| 名称和参数均变化 | 性能回退 | `public void onRemoteStreamSwitch(RemoteStreamSwitch event)` | [`public void onSimulcastSubscribeFallback(RemoteStreamSwitch event)`](70081#onsimulcastsubscribefallback) | [`FallbackOrRecoverReason`](70083.md#fallbackorrecoverreason) 枚举值名称变更 |
| 名称和参数均变化 | 音频管理 | `void onAudioRouteChanged(int routing)` | [`void onAudioPlaybackDeviceChanged(AudioPlaybackDevice device)`](70081.md#onaudioplaybackdevicechanged) |
| 名称和参数均变化 | CDN 推流 | `public void onStreamPublished(String url, int error)` | [`public void onLiveTranscodingResult(String url, int error)`](70081#onlivetranscodingresult) | [`TranscodingError`](70082.md#transcodingerror) 错误码名称变更 |
| 合并 | 房间管理 |  <li>`public void onJoinChannelSuccess(String channel, String uid, int elapsed)`</li><li>`public void onRejoinChannelSuccess(String channel, String uid, int elapsed)`</li> | `public void onJoinRoomResult(String roomId, String uid, int errorCode, int joinType, int elapsed)` | 旧版回调合并为[`onJoinRoomResult`](70081.md#onjoinroomresult) |
| 合并 | 视频管理 | <li>`void onFirstRemoteVideoFrame(String uid, int width, int height, int elapsed)`</li><li>`void onFirstRemoteScreenFrame(String uid, int width, int height, int elapsed)`</li> | `void onFirstRemoteVideoFrameRendered(RemoteStreamKey remoteStreamKey, VideoFrameInfo frameInfo)` | 旧版回调合并为 [`onFirstRemoteVideoFrameRendered`](70081.md#onfirstremotevideoframerendered) |
| 合并 | 视频管理 | <li>`void OnFirstLocalVideoFrame(int width, int height, int elapsed)`</li><li>`void OnFirstLocalScreenFrame(String uid, int width, int height, int elapsed)`</li> | `void OnFirstLocalVideoFrameCaptured(Streamindex stream_index, VideoFrameInfo frame_info)` | 旧版回调合并为 [`OnFirstLocalVideoFrameCaptured`](70081.md#onfirstlocalvideoframecaptured) |
| 合并 | 数据统计 | <li>`void onLocalAudioStats(LocalAudioStats stats)`</li><li>`void onLocalVideoStats(IRtcEngineEventHandler.LocalVideoStats stats)`</li><li>`void onNetworkQuality(String uid, int txQuality, int rxQuality)`</li> | `void onLocalStreamStats(LocalStreamStats stats)` | 多个旧版回调合并为 [`onLocalStreamStats`](70081.md#onlocalstreamstats) 中的多个状态 | 
| 合并 | 数据统计 | <li>`void onRemoteVideoStats(IRtcEngineEventHandler.RemoteVideoStats stats)`</li><li>`void onRemoteAudioStats(IRtcEngineEventHandler.RemoteAudioStats stats)`</li><li>`void onNetworkQuality(String uid, int txQuality, int rxQuality)`</li> | `void onRemoteStreamStats(RemoteStreamStats stats)` | 多个旧版回调合并为 [`onRemoteStreamStats`](70081.md#onremotestreamstats) 中的多个状态 |
| 拆分 | 视频管理 | `void onUserEnableLocalVideo(String uid, boolean enabled)int enableLocalVideo(boolean enabled)` | <li>`void onUserStartVideoCapture(String uid)`</li><li>`void onUserStopVideoCapture(String uid)`</li> | 旧版回调拆分为 [`onUserStartVideoCapture`](70081.md#onuserstartvideocapture) 和 [`onUserStopVideoCapture`](70081.md#onuserstopvideocapture) |
| 拆分 | 视频管理 | `void onVideoSizeChanged(String uid, int width, int height, int rotation)` | <li>`void onLocalVideoSizeChanged(StreamIndex streamIndex, VideoFrameInfo frameInfo)`</li><li>`void onRemoteVideoSizeChanged(RemoteStreamKey remoteStreamKey, VideoFrameInfo frameInfo) int setRemoteVideoCanvas(String user_id, StreamIndex index, VideoCanvas canvas)`</li> | 旧版回调拆分为 [`onLocalVideoSizeChanged`](70081.md#onlocalvideosizechanged) 和 [`onRemoteVideoSizeChanged`](70081.md#onremotevideosizechanged) |
| 删除 | 房间管理 | `public void onLoginCompletion(int errorCode, ByteStream[] listStream)` | / |
| 删除 | 数据统计 | `void onAudioQuality(String uid, int quality, short delay, short lost)` | / |


### 类型变更

以下表格中的类型发生了变化，你需要在工程文件中找到该类型，并根据变化调整相关处理逻辑：

| 变更详情 | 数据类型  | 备注 |
| --- | --- | --- |
| 枚举值增删 | `UserMessageSendResult` | 新增了枚举值：[`USER_MESSAGE_SEND_RESULT_INIT`](70082.md#usermessagesendresult) |
| 枚举值增删 | `RemoteVideoStats` | 删除了枚举值：`uid`，此变量请参考`RemoteStreamStats`中的[`uid`](70083.md#uid) | 
| 枚举值增删 | `RemoteAudioStats` | 删除了枚举值：`uid`，此变量请参考`RemoteStreamStats`中的[`uid`](70083.md#uid) |


## 3.20

### 回调变更

以下表格中的回调发生了变化。你需要在工程文件中找到该回调，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 合并 | 引擎管理 | <li>`void onConnectionLost()`</li><li>`void onConnectionInterrupted()`</li> | `void onConnectionStateChanged(int state, int reason)` | 多个旧版回调合并为 [`onConnectionStateChanged`](70081.md#onconnectionstatechanged) 中的多个状态 |


## 3.19.2

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 参数变化 | 房间管理 | `void enableAutoSubscribe(boolean enable)` | [`void enableAutoSubscribe(SubscribeMode audioMode, SubscribeMode videoMode)`](70080.md#enableautosubscribe) |


### 类型变更

以下表格中的类型发生了变化，你需要在工程文件中找到该类型，并根据变化调整相关处理逻辑：

| 变更详情 | 数据类型  | 备注 |
| --- | --- | --- |
| 枚举值增删 | [`CLIENT_ROLE_TYPE`](70083.md#client-role-type) | 删除了枚举值：`CLIENT_ROLE_AUDIENCE`，建议使用 `CLIENT_ROLE_SILENT_AUDIENCE` 代替。 |


### 错误码变更

以下表格中的错误码发生了变化，你需要进行相应的处理：

| 变更详情 | 错误码  | 备注 |
| --- | --- | --- |
| 枚举值增删 | [`RtcErrorCode`](70082.md#rtcerrorcode) | 新增了枚举值：<li>`BRERR_OVER_STREAM_PUBLISH_LIMIT`</li><li>`BRERR_OVER_SCREEN_PUBLISH_LIMIT`</li><li>`BRERR_OVER_VIDEO_PUBLISH_LIMIT`</li> |


## 3.19.1

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 名称和参数均变化 | 房间管理 | `create(Context context, String appId, IRtcEngineEventHandler handler, boolean useOffline, Object eglContext)` | [`createEngine(Context context, String appId, IRtcEngineEventHandler handler, Object eglContext, JSONObject parameters)`](70080.md#createengine) | 


## 3.18.3

### 方法变更

以下表格中的方法发生了变化。你需要在工程文件中找到该方法，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 参数变化 | 房间管理 | `void unSubscribe(String streamId)` | [`void unSubscribe(String userId, boolean isScreen)`](70080.md#unsubscribe) |
| 参数变化 | 房间管理 | `void subscribeStream(String streamId, SubscribeConfig info)` | [`void subscribeStream(String userId, SubscribeConfig info)`](70080.md#subscribestream) |


### 回调变更

以下表格中的回调发生了变化。你需要在工程文件中找到该回调，并进行相关修改：

| 变更详情 | 功能模块 | 变动前方法  | 变动后方法  | 备注 |
| --- | --- | --- | --- | --- |
| 参数变化 | 房间管理 | `void onStreamRemove(ByteStream stream)` | [`void onStreamRemove(ByteStream stream, IRtcEngineEventHandler.RtcStreamRemoveReason reason)`](70081.md#onstreamremove) |